<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Why Everyone Should Stop Regressing on Residuals</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Chen" />
    <script src="Residual-Regression_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="Residual-Regression_files/plotly-binding-4.9.1/plotly.js"></script>
    <script src="Residual-Regression_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="Residual-Regression_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="Residual-Regression_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="Residual-Regression_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="Residual-Regression_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="Residual-Regression_files/plotly-main-1.49.4/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="PennSIVE-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Why Everyone Should Stop Regressing on Residuals
### Andrew Chen

---




&lt;style type="text/css"&gt;
.remark-slide-content.img-caption {
  background-image: none;
  text-align: center;
  padding-top: 61.5%;
}
.remark-slide-content.img-caption &gt; p:first-of-type {
  padding: 0px;
  margin: 0px;
}
.remark-slide-content.img-caption &gt; p:first-of-type &gt; img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 95%;
  height: 75%;
  margin: 2.5% 2.5% 2.5% 2.5%;
  object-fit: contain;
}

.remark-slide-content.just-img {
  background-image: none;
  text-align: center;
  padding-top: 0px;
}
&lt;/style&gt;

### Reason 1: It can reintroduce unwanted effects
- Recent paper by Lindquist et al. showed that motion artifacts removed from one preprocessing step can be reintroduced by another preprocessing step&lt;sup&gt;1&lt;/sup&gt;
- Let's dive into why this happens
.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]


---
class: img-caption
![](hbm24528-fig-0003-mr.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](https://onlinelibrary.wiley.com/cms/asset/0f891eac-2a43-4632-990f-5db53f241434/hbm24528-fig-0006-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Reason 2: You are not properly controlling for confounders
- Suppose we have `\(n\)` observations indexed by `\(i\)` with
    - Dependent variable `\(y_i\)`
    - Covariate of interest `\(x_i\)`
    - Confounder `\(z_i\)` that is correlated with `\(x_i\)`

`$$y_i=\beta_0+\beta_1x_i+\beta_2z_i+\epsilon_i$$`
- How can we get an estimate of `\(\beta_1\)`?
- What if we first regress out the confounder, then regress the residuals on the covariate of interest?
---
class: img-caption
![](jane_618_f1.gif)
Answer: We get very poor estimates, even with larger samples
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
class: just-img


<div id="htmlwidget-4b7a63538b46d2c0329b" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4b7a63538b46d2c0329b">{"x":{"visdat":{"1492e4d2f65de":["function () ","plotlyVisDat"]},"cur_data":"1492e4d2f65de","attrs":{"1492e4d2f65de":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"1492e4d2f65de.1":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Covariate"},"yaxis":{"title":"Confounder"},"zaxis":{"title":"Outcome"},"camera":{"eye":{"x":1.5,"y":-1.5,"z":1.5}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.317052292962122,0.193878561480544,-0.41326105893388,-0.85707527185096,-1.43099897529948,-0.518468557421583,-0.622042474749213,0.0479696340088377,-2.08477867719365,-1.50423992259961,-0.367262413193018,-0.485482504567705,0.0551774441889881,-2.11765046798312,1.63354144825784,1.40702884720877,-1.02582026286947,1.06263073963947,-0.374218365425488,-0.611197604508904,0.997807032485996,-0.406177635017449,-1.6866233649608,1.29541148675775,1.92725221990273,-0.741310920788456,-0.450383973596516,-0.600531644543834,0.243265709037368,0.680809174200518,0.466811445929138,0.161180018630898,-0.428839536634502,0.956660905453743,1.54450216869938,1.07495053475075,-1.88633857185987,0.767993695744729,-0.594874438321016,0.485290764165845,-0.846704652779134,0.259790791226862,0.360359308358688,0.857720936040034,0.235110543117216,-1.21096954307536,-1.81596045125106,-0.38122444612604,-0.314836204051219,0.66104143087758,0.756558608242975,0.946469888173595,-0.567684897782197,-0.0363011889947873,1.00382998206919,0.46897828297227,-1.8211926729861,0.189206680849289,-0.745485835920375,-0.817239702872552,0.767821216677725,1.27029786851042,-0.13978491481588,-3.08215759070948,-0.581329887456603,0.388790827695731,0.368848900663656,-1.18424982823155,-0.283252849965585,-1.00030886934614,1.06153127380224,-0.838861464635544,-0.605407182068984,0.565154918625396,-0.847931695077746,-1.10013169357777,1.26281543714394,-1.3599804951762,0.16063478272363,-0.289440991332393,0.0679856857886031,0.863692961802963,-0.222213489597535,-0.663367141662263,-1.09503183147401,0.621388796036476,-0.248639390779658,1.21640031507197,-0.737372341911145,-0.568299253754283,-0.103007993349866,0.419142010292751,2.1007931691853,-0.194217075695423,-2.2646923997042,3.05410929396104,0.232762915246086,-0.368182581345207,-0.359966328547906,-1.97046426168591,0.479829942347323,1.4257391469096,-0.476769075577661,-0.258459054787821,0.758193465179814,-0.864038149756047,0.226686364932439,-0.176007025472543,0.0227737411282469,-1.51084687165066,0.988919551248682,-0.906585616826377,1.76856356967217,0.201728870324118,1.34344490875609,-1.11831939165033,-1.18287472681337,0.521258263556013,1.15442180533544,-0.267209269449337,0.208345308118329,-1.00400256316,-0.317891151446007,-0.198954422824362,0.370090086587824,0.348628503846837,-1.72261959032138,-0.901004646076047,-0.253302120237086,2.23782012812667,0.0758175051903877,0.0572975066383884,-1.03003670996251,-0.811352972745464,-1.73732063966332,-0.599034471119768,-0.416101563163754,0.708890327411589,0.272321359452584,-1.32169561047523,-1.68659585335419,-0.261037376772084,1.6317887145274,1.36022210906108,2.09136722635921,0.00520891433571047,-0.743320474796112,-2.01005159173193,0.160841867828946,-0.259823816429873,1.89485309486255,1.20877803547917,-0.515641623770317,-0.374823419010277,-0.329520657261482,-0.158454750089348,0.0051692606212329,-0.0686778143728987,0.272444649473428,-0.273673200888474,-0.719771524798066,0.799134475970601,1.01082246638124,-1.18688250594286,1.24974170615773,-1.17731201949229,0.799076778723253,0.516303061706412,1.12332281852848,-0.891591469828551,1.00326205365107,0.340498548392204,-0.465823931335237,0.445596811845822,0.801698422955217,-1.17780105549409,0.409202385237175,0.00524949663176892,0.818633931446687,0.311414489478059,1.72453566267509,0.725290545554841,-1.28425666062026,0.850421147421599,0.74136207341625,1.17050883500152,-0.524250785880244,1.43405833024776,1.57188550737765,0.84875523629905,2.0556726045952,1.32900171522957,-0.97673054633043,-0.65259217253736,-0.584991253770117,-0.084637519204853,-0.839718983656907,1.23439336025896,0.43737368457076,1.07996836152042],"y":[-0.133678326712886,1.118602097512,0.452893815250991,-1.33270460472605,-1.71311890570985,-0.682388097030343,-1.18018216359539,0.390455558311866,-0.51694509013258,-0.0512437287803496,-0.662460519387469,-0.4935545983751,-0.143342944175777,-2.30022360577877,2.6160755822098,2.43163799758438,-0.661787788273001,1.45559225871354,0.253129010259298,-0.0902850379973015,0.745239557617234,-0.773105874716035,-1.65316116586485,0.63808737182526,1.48830443311591,-0.617723940752404,-0.516627240111068,-0.7638860340554,0.808946079366584,0.831293306880795,0.478288256877318,0.106385141085347,-0.0737475627395064,0.604786921249595,1.28014282788381,1.21402961033866,-0.778477838483199,1.08899894616793,0.237708493646504,0.566994132622828,-0.826297224345205,-0.469382727009138,-0.339106117033236,1.33804864402034,0.0812816344547579,0.0219384711301617,-1.69018846708624,0.838465448756508,-0.304004065377843,0.600949419581231,0.810135782670259,1.45839588034001,-0.0981811128301963,0.443475668661864,1.45235460584623,0.25730917451818,-1.06879301864604,-1.15774445439153,-0.627272677001086,-0.818911503599195,0.278474418848021,0.834743088662653,0.427284088016193,-3.27747726300946,-0.852455424145213,0.0854862501802494,0.663429265167187,-0.176307161607208,-0.356135729432435,-1.32966469937137,0.193216995770443,0.121005238383025,-0.637651553681944,1.23386834603261,-0.526800055911864,-0.740653592716836,0.427677997186832,-1.07720723806413,0.0847005321805541,0.375826789957775,-0.614597030754108,-0.51468528464873,0.653892790089569,-0.436547615082191,-1.88542659789144,-0.0244320396348092,0.862239694692544,0.454010488010287,-1.24576902787699,-0.268696972617789,-1.18369882387955,-0.551576998331396,1.56167934992478,0.0845336032126479,-2.58228789117554,1.90441909312521,0.22244500619028,-0.266523600440961,-0.50408753844878,-1.53388722119478,-0.420196080209161,1.12157275160756,-0.694638755840835,-0.564990086016996,0.602105997846773,-1.27054357823242,0.0795964300549679,-0.749547789483793,0.151005432021408,-1.71972356012711,1.65126272940516,-0.837932365273056,1.24712149421576,0.256476029332415,1.07602625647997,-1.13927412674757,-0.741088399416525,-1.68099267680216,1.0521475275731,-0.00413451658960476,1.11275805362839,-0.929544067500761,0.292965565034619,0.0369371171536961,0.274413181026781,0.674383378508948,-1.20702795896132,-0.470487789424677,-0.817949732946083,3.18585046746508,-0.985698379485454,0.481728459678258,-0.660968684620042,-0.736038174017785,-0.867463270370173,0.270926409929586,-0.0329705852133537,1.01616992255897,-0.347574345655668,-1.22360928307916,-1.5042298790969,-0.860412665607683,1.42921841655119,0.309017355753553,0.995115160061235,0.326706350294903,-0.873132046116565,-1.51839361255774,0.0689856528170797,-0.89756008232764,1.50241994632548,1.15098196803296,-0.359683632816189,-0.541269283297765,0.21514131592509,-0.443215078325865,0.103740383071241,-1.35888842982352,0.0980726588245423,0.101714097980645,-1.00611976989365,0.855728122257003,1.44479729649064,-1.10004880081859,1.7544482638769,-0.440449423379669,0.512910488291572,0.0552881062234557,1.38210439035062,-1.39139437294459,-0.551144811016045,0.782435803853236,0.137392483157609,0.854654598607221,0.124173080471083,-1.44996069300434,-0.023707226497058,0.0525389702484553,-0.216140291201551,1.20097202454725,1.60542229586258,1.6768107203515,0.0353869644163614,1.38570189553879,1.6147117374032,0.69824288254759,-0.46186395890578,0.741978981779661,1.27864893490086,1.52385207598597,1.81014742592776,0.319130549837079,-0.400339978785786,-0.408312400444637,-0.3984972203258,-0.452853812289681,-0.392943076061232,1.69069152803094,-0.0820425244111517,0.550734472041052],"z":[0.154942932255685,1.38919082732297,0.498197295450169,-1.06239154757572,-1.73042815067833,-0.370145292088158,-0.791102880813031,0.777352000652684,-1.35075227110017,-0.618384189937781,-0.25035168677815,-0.214871606031772,0.408738516037439,-2.62205748560513,3.44518628735554,3.15752115738339,-0.71087126977154,2.2332104648753,0.385691817411858,-0.0205834837261532,1.69058697910045,-0.355044090785248,-1.86739480554976,1.8239035670363,2.86134402314124,-0.480870037050411,-0.206453483567118,-0.484638008991273,1.20700261791096,1.52892610278511,1.13202415799271,0.657749977829562,0.118643396466385,1.56346784472053,2.44770586363642,2.07274046759078,-1.39491712121196,1.77034921536705,0.220438204756033,1.20705379378026,-0.700646947958846,0.323740010980597,0.485331599956007,2.00749307207045,0.691928890328573,-0.361867384333448,-1.98384987680791,0.790523067869518,0.0372661774278475,1.35384796134936,1.56714043966745,2.15386040398772,0.00434815859951515,0.755476501795144,2.18978357756898,0.978855586271506,-1.55253561811431,-0.207522075451379,-0.490476593016832,-0.674851478502032,1.20286131089621,1.94398303604934,0.67170378726841,-3.98129003157507,-0.53319535209308,0.802448320541377,1.19304908210978,-0.481935526858939,0.0228823604495763,-1.16052713207407,1.34877815472907,-0.0320449923485727,-0.399686748997459,1.72977065128879,-0.491857859664536,-0.818095334378031,1.65379977005973,-1.23557704724004,0.642189086461119,0.530924425065958,0.0878264245523377,0.714759740036154,0.772629876372614,-0.299485963692927,-1.61586653452763,0.888324095509357,0.899974578767211,1.63974192818577,-0.917744592823502,-0.11544299243226,-0.430240406032403,0.377749874401139,3.03418512940525,0.393675935290248,-2.92243183758763,3.94142423698857,0.789099911033647,0.0261600387778737,-0.134383340869489,-1.98259167198829,0.512198069524904,2.2535726949902,-0.349531115964756,-0.105960032535181,1.4226639901468,-1.02375284356374,0.684852322519376,-0.177434004441245,0.592099787232949,-1.79094493621625,2.31858196248588,-0.750708221441412,2.58143391074974,0.791197795787764,2.16408418169343,-1.10986109685034,-0.876319822332738,-0.341359723244114,2.01505289906417,0.280513715800932,1.3952267192509,-0.883028275434339,0.453006455540219,0.357042252058724,0.921606653358414,1.18656268367724,-1.5802989184697,-0.489590338822316,-0.279421931200027,4.26702378294242,-0.166462245978356,0.847772542449843,-0.713249410179599,-0.612719436706083,-1.35289437099525,0.240778723195063,0.156103862164216,1.67799654100758,0.417777275686032,-1.31125905945988,-1.76312364668757,-0.314560663637646,2.61315935778321,1.63892199139843,2.63099203652251,0.702795051269621,-0.661062398610683,-1.99945727697458,0.631333630480409,-0.339714363102068,2.84854549485981,2.12228636848668,-0.142273313582363,-0.170810525587438,0.390388827092717,0.0492854861375413,0.546691116612922,-0.528842004909305,0.72981648183677,0.350082993992711,-0.737669540256013,1.62885818478751,2.18938820003851,-1.13039754870483,2.57338734505243,-0.661978643982181,1.38884545293857,0.870568183579098,2.22425341224356,-1.12763572391301,0.78693643587271,1.2565084126,0.240552352303851,1.38063035334532,1.1185644184266,-1.3689788579207,0.740300977146272,0.510906292844348,0.892199914199786,1.52912492584591,2.80142493700456,2.15192525216263,-0.403754421314536,2.03574049610046,2.1197060336018,1.77858056831257,-0.219825955322026,1.99368048444739,2.46582847562315,2.1312794846277,3.17652838739426,1.62414695157485,-0.493495001553161,-0.272178835059207,-0.217987565838951,0.0942104339820168,-0.392409075774506,2.51801378783112,0.719186178139917,1.61194634952122],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[-0.317052292962122,0.193878561480544,-0.41326105893388,-0.85707527185096,-1.43099897529948,-0.518468557421583,-0.622042474749213,0.0479696340088377,-2.08477867719365,-1.50423992259961,-0.367262413193018,-0.485482504567705,0.0551774441889881,-2.11765046798312,1.63354144825784,1.40702884720877,-1.02582026286947,1.06263073963947,-0.374218365425488,-0.611197604508904,0.997807032485996,-0.406177635017449,-1.6866233649608,1.29541148675775,1.92725221990273,-0.741310920788456,-0.450383973596516,-0.600531644543834,0.243265709037368,0.680809174200518,0.466811445929138,0.161180018630898,-0.428839536634502,0.956660905453743,1.54450216869938,1.07495053475075,-1.88633857185987,0.767993695744729,-0.594874438321016,0.485290764165845,-0.846704652779134,0.259790791226862,0.360359308358688,0.857720936040034,0.235110543117216,-1.21096954307536,-1.81596045125106,-0.38122444612604,-0.314836204051219,0.66104143087758,0.756558608242975,0.946469888173595,-0.567684897782197,-0.0363011889947873,1.00382998206919,0.46897828297227,-1.8211926729861,0.189206680849289,-0.745485835920375,-0.817239702872552,0.767821216677725,1.27029786851042,-0.13978491481588,-3.08215759070948,-0.581329887456603,0.388790827695731,0.368848900663656,-1.18424982823155,-0.283252849965585,-1.00030886934614,1.06153127380224,-0.838861464635544,-0.605407182068984,0.565154918625396,-0.847931695077746,-1.10013169357777,1.26281543714394,-1.3599804951762,0.16063478272363,-0.289440991332393,0.0679856857886031,0.863692961802963,-0.222213489597535,-0.663367141662263,-1.09503183147401,0.621388796036476,-0.248639390779658,1.21640031507197,-0.737372341911145,-0.568299253754283,-0.103007993349866,0.419142010292751,2.1007931691853,-0.194217075695423,-2.2646923997042,3.05410929396104,0.232762915246086,-0.368182581345207,-0.359966328547906,-1.97046426168591,0.479829942347323,1.4257391469096,-0.476769075577661,-0.258459054787821,0.758193465179814,-0.864038149756047,0.226686364932439,-0.176007025472543,0.0227737411282469,-1.51084687165066,0.988919551248682,-0.906585616826377,1.76856356967217,0.201728870324118,1.34344490875609,-1.11831939165033,-1.18287472681337,0.521258263556013,1.15442180533544,-0.267209269449337,0.208345308118329,-1.00400256316,-0.317891151446007,-0.198954422824362,0.370090086587824,0.348628503846837,-1.72261959032138,-0.901004646076047,-0.253302120237086,2.23782012812667,0.0758175051903877,0.0572975066383884,-1.03003670996251,-0.811352972745464,-1.73732063966332,-0.599034471119768,-0.416101563163754,0.708890327411589,0.272321359452584,-1.32169561047523,-1.68659585335419,-0.261037376772084,1.6317887145274,1.36022210906108,2.09136722635921,0.00520891433571047,-0.743320474796112,-2.01005159173193,0.160841867828946,-0.259823816429873,1.89485309486255,1.20877803547917,-0.515641623770317,-0.374823419010277,-0.329520657261482,-0.158454750089348,0.0051692606212329,-0.0686778143728987,0.272444649473428,-0.273673200888474,-0.719771524798066,0.799134475970601,1.01082246638124,-1.18688250594286,1.24974170615773,-1.17731201949229,0.799076778723253,0.516303061706412,1.12332281852848,-0.891591469828551,1.00326205365107,0.340498548392204,-0.465823931335237,0.445596811845822,0.801698422955217,-1.17780105549409,0.409202385237175,0.00524949663176892,0.818633931446687,0.311414489478059,1.72453566267509,0.725290545554841,-1.28425666062026,0.850421147421599,0.74136207341625,1.17050883500152,-0.524250785880244,1.43405833024776,1.57188550737765,0.84875523629905,2.0556726045952,1.32900171522957,-0.97673054633043,-0.65259217253736,-0.584991253770117,-0.084637519204853,-0.839718983656907,1.23439336025896,0.43737368457076,1.07996836152042],"y":[-0.133678326712886,1.118602097512,0.452893815250991,-1.33270460472605,-1.71311890570985,-0.682388097030343,-1.18018216359539,0.390455558311866,-0.51694509013258,-0.0512437287803496,-0.662460519387469,-0.4935545983751,-0.143342944175777,-2.30022360577877,2.6160755822098,2.43163799758438,-0.661787788273001,1.45559225871354,0.253129010259298,-0.0902850379973015,0.745239557617234,-0.773105874716035,-1.65316116586485,0.63808737182526,1.48830443311591,-0.617723940752404,-0.516627240111068,-0.7638860340554,0.808946079366584,0.831293306880795,0.478288256877318,0.106385141085347,-0.0737475627395064,0.604786921249595,1.28014282788381,1.21402961033866,-0.778477838483199,1.08899894616793,0.237708493646504,0.566994132622828,-0.826297224345205,-0.469382727009138,-0.339106117033236,1.33804864402034,0.0812816344547579,0.0219384711301617,-1.69018846708624,0.838465448756508,-0.304004065377843,0.600949419581231,0.810135782670259,1.45839588034001,-0.0981811128301963,0.443475668661864,1.45235460584623,0.25730917451818,-1.06879301864604,-1.15774445439153,-0.627272677001086,-0.818911503599195,0.278474418848021,0.834743088662653,0.427284088016193,-3.27747726300946,-0.852455424145213,0.0854862501802494,0.663429265167187,-0.176307161607208,-0.356135729432435,-1.32966469937137,0.193216995770443,0.121005238383025,-0.637651553681944,1.23386834603261,-0.526800055911864,-0.740653592716836,0.427677997186832,-1.07720723806413,0.0847005321805541,0.375826789957775,-0.614597030754108,-0.51468528464873,0.653892790089569,-0.436547615082191,-1.88542659789144,-0.0244320396348092,0.862239694692544,0.454010488010287,-1.24576902787699,-0.268696972617789,-1.18369882387955,-0.551576998331396,1.56167934992478,0.0845336032126479,-2.58228789117554,1.90441909312521,0.22244500619028,-0.266523600440961,-0.50408753844878,-1.53388722119478,-0.420196080209161,1.12157275160756,-0.694638755840835,-0.564990086016996,0.602105997846773,-1.27054357823242,0.0795964300549679,-0.749547789483793,0.151005432021408,-1.71972356012711,1.65126272940516,-0.837932365273056,1.24712149421576,0.256476029332415,1.07602625647997,-1.13927412674757,-0.741088399416525,-1.68099267680216,1.0521475275731,-0.00413451658960476,1.11275805362839,-0.929544067500761,0.292965565034619,0.0369371171536961,0.274413181026781,0.674383378508948,-1.20702795896132,-0.470487789424677,-0.817949732946083,3.18585046746508,-0.985698379485454,0.481728459678258,-0.660968684620042,-0.736038174017785,-0.867463270370173,0.270926409929586,-0.0329705852133537,1.01616992255897,-0.347574345655668,-1.22360928307916,-1.5042298790969,-0.860412665607683,1.42921841655119,0.309017355753553,0.995115160061235,0.326706350294903,-0.873132046116565,-1.51839361255774,0.0689856528170797,-0.89756008232764,1.50241994632548,1.15098196803296,-0.359683632816189,-0.541269283297765,0.21514131592509,-0.443215078325865,0.103740383071241,-1.35888842982352,0.0980726588245423,0.101714097980645,-1.00611976989365,0.855728122257003,1.44479729649064,-1.10004880081859,1.7544482638769,-0.440449423379669,0.512910488291572,0.0552881062234557,1.38210439035062,-1.39139437294459,-0.551144811016045,0.782435803853236,0.137392483157609,0.854654598607221,0.124173080471083,-1.44996069300434,-0.023707226497058,0.0525389702484553,-0.216140291201551,1.20097202454725,1.60542229586258,1.6768107203515,0.0353869644163614,1.38570189553879,1.6147117374032,0.69824288254759,-0.46186395890578,0.741978981779661,1.27864893490086,1.52385207598597,1.81014742592776,0.319130549837079,-0.400339978785786,-0.408312400444637,-0.3984972203258,-0.452853812289681,-0.392943076061232,1.69069152803094,-0.0820425244111517,0.550734472041052],"z":[0.154942932255685,1.38919082732297,0.498197295450169,-1.06239154757572,-1.73042815067833,-0.370145292088158,-0.791102880813031,0.777352000652684,-1.35075227110017,-0.618384189937781,-0.25035168677815,-0.214871606031772,0.408738516037439,-2.62205748560513,3.44518628735554,3.15752115738339,-0.71087126977154,2.2332104648753,0.385691817411858,-0.0205834837261532,1.69058697910045,-0.355044090785248,-1.86739480554976,1.8239035670363,2.86134402314124,-0.480870037050411,-0.206453483567118,-0.484638008991273,1.20700261791096,1.52892610278511,1.13202415799271,0.657749977829562,0.118643396466385,1.56346784472053,2.44770586363642,2.07274046759078,-1.39491712121196,1.77034921536705,0.220438204756033,1.20705379378026,-0.700646947958846,0.323740010980597,0.485331599956007,2.00749307207045,0.691928890328573,-0.361867384333448,-1.98384987680791,0.790523067869518,0.0372661774278475,1.35384796134936,1.56714043966745,2.15386040398772,0.00434815859951515,0.755476501795144,2.18978357756898,0.978855586271506,-1.55253561811431,-0.207522075451379,-0.490476593016832,-0.674851478502032,1.20286131089621,1.94398303604934,0.67170378726841,-3.98129003157507,-0.53319535209308,0.802448320541377,1.19304908210978,-0.481935526858939,0.0228823604495763,-1.16052713207407,1.34877815472907,-0.0320449923485727,-0.399686748997459,1.72977065128879,-0.491857859664536,-0.818095334378031,1.65379977005973,-1.23557704724004,0.642189086461119,0.530924425065958,0.0878264245523377,0.714759740036154,0.772629876372614,-0.299485963692927,-1.61586653452763,0.888324095509357,0.899974578767211,1.63974192818577,-0.917744592823502,-0.11544299243226,-0.430240406032403,0.377749874401139,3.03418512940525,0.393675935290248,-2.92243183758763,3.94142423698857,0.789099911033647,0.0261600387778737,-0.134383340869489,-1.98259167198829,0.512198069524904,2.2535726949902,-0.349531115964756,-0.105960032535181,1.4226639901468,-1.02375284356374,0.684852322519376,-0.177434004441245,0.592099787232949,-1.79094493621625,2.31858196248588,-0.750708221441412,2.58143391074974,0.791197795787764,2.16408418169343,-1.10986109685034,-0.876319822332738,-0.341359723244114,2.01505289906417,0.280513715800932,1.3952267192509,-0.883028275434339,0.453006455540219,0.357042252058724,0.921606653358414,1.18656268367724,-1.5802989184697,-0.489590338822316,-0.279421931200027,4.26702378294242,-0.166462245978356,0.847772542449843,-0.713249410179599,-0.612719436706083,-1.35289437099525,0.240778723195063,0.156103862164216,1.67799654100758,0.417777275686032,-1.31125905945988,-1.76312364668757,-0.314560663637646,2.61315935778321,1.63892199139843,2.63099203652251,0.702795051269621,-0.661062398610683,-1.99945727697458,0.631333630480409,-0.339714363102068,2.84854549485981,2.12228636848668,-0.142273313582363,-0.170810525587438,0.390388827092717,0.0492854861375413,0.546691116612922,-0.528842004909305,0.72981648183677,0.350082993992711,-0.737669540256013,1.62885818478751,2.18938820003851,-1.13039754870483,2.57338734505243,-0.661978643982181,1.38884545293857,0.870568183579098,2.22425341224356,-1.12763572391301,0.78693643587271,1.2565084126,0.240552352303851,1.38063035334532,1.1185644184266,-1.3689788579207,0.740300977146272,0.510906292844348,0.892199914199786,1.52912492584591,2.80142493700456,2.15192525216263,-0.403754421314536,2.03574049610046,2.1197060336018,1.77858056831257,-0.219825955322026,1.99368048444739,2.46582847562315,2.1312794846277,3.17652838739426,1.62414695157485,-0.493495001553161,-0.272178835059207,-0.217987565838951,0.0942104339820168,-0.392409075774506,2.51801378783112,0.719186178139917,1.61194634952122],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
class: just-img
<div id="htmlwidget-49bd1c4d82ecb7af2f87" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-49bd1c4d82ecb7af2f87">{"x":{"visdat":{"1492e786e4d82":["function () ","plotlyVisDat"]},"cur_data":"1492e786e4d82","attrs":{"1492e786e4d82":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1492e786e4d82.1":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Covariates"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.317052292962122,0.193878561480544,-0.41326105893388,-0.85707527185096,-1.43099897529948,-0.518468557421583,-0.622042474749213,0.0479696340088377,-2.08477867719365,-1.50423992259961,-0.367262413193018,-0.485482504567705,0.0551774441889881,-2.11765046798312,1.63354144825784,1.40702884720877,-1.02582026286947,1.06263073963947,-0.374218365425488,-0.611197604508904,0.997807032485996,-0.406177635017449,-1.6866233649608,1.29541148675775,1.92725221990273,-0.741310920788456,-0.450383973596516,-0.600531644543834,0.243265709037368,0.680809174200518,0.466811445929138,0.161180018630898,-0.428839536634502,0.956660905453743,1.54450216869938,1.07495053475075,-1.88633857185987,0.767993695744729,-0.594874438321016,0.485290764165845,-0.846704652779134,0.259790791226862,0.360359308358688,0.857720936040034,0.235110543117216,-1.21096954307536,-1.81596045125106,-0.38122444612604,-0.314836204051219,0.66104143087758,0.756558608242975,0.946469888173595,-0.567684897782197,-0.0363011889947873,1.00382998206919,0.46897828297227,-1.8211926729861,0.189206680849289,-0.745485835920375,-0.817239702872552,0.767821216677725,1.27029786851042,-0.13978491481588,-3.08215759070948,-0.581329887456603,0.388790827695731,0.368848900663656,-1.18424982823155,-0.283252849965585,-1.00030886934614,1.06153127380224,-0.838861464635544,-0.605407182068984,0.565154918625396,-0.847931695077746,-1.10013169357777,1.26281543714394,-1.3599804951762,0.16063478272363,-0.289440991332393,0.0679856857886031,0.863692961802963,-0.222213489597535,-0.663367141662263,-1.09503183147401,0.621388796036476,-0.248639390779658,1.21640031507197,-0.737372341911145,-0.568299253754283,-0.103007993349866,0.419142010292751,2.1007931691853,-0.194217075695423,-2.2646923997042,3.05410929396104,0.232762915246086,-0.368182581345207,-0.359966328547906,-1.97046426168591,0.479829942347323,1.4257391469096,-0.476769075577661,-0.258459054787821,0.758193465179814,-0.864038149756047,0.226686364932439,-0.176007025472543,0.0227737411282469,-1.51084687165066,0.988919551248682,-0.906585616826377,1.76856356967217,0.201728870324118,1.34344490875609,-1.11831939165033,-1.18287472681337,0.521258263556013,1.15442180533544,-0.267209269449337,0.208345308118329,-1.00400256316,-0.317891151446007,-0.198954422824362,0.370090086587824,0.348628503846837,-1.72261959032138,-0.901004646076047,-0.253302120237086,2.23782012812667,0.0758175051903877,0.0572975066383884,-1.03003670996251,-0.811352972745464,-1.73732063966332,-0.599034471119768,-0.416101563163754,0.708890327411589,0.272321359452584,-1.32169561047523,-1.68659585335419,-0.261037376772084,1.6317887145274,1.36022210906108,2.09136722635921,0.00520891433571047,-0.743320474796112,-2.01005159173193,0.160841867828946,-0.259823816429873,1.89485309486255,1.20877803547917,-0.515641623770317,-0.374823419010277,-0.329520657261482,-0.158454750089348,0.0051692606212329,-0.0686778143728987,0.272444649473428,-0.273673200888474,-0.719771524798066,0.799134475970601,1.01082246638124,-1.18688250594286,1.24974170615773,-1.17731201949229,0.799076778723253,0.516303061706412,1.12332281852848,-0.891591469828551,1.00326205365107,0.340498548392204,-0.465823931335237,0.445596811845822,0.801698422955217,-1.17780105549409,0.409202385237175,0.00524949663176892,0.818633931446687,0.311414489478059,1.72453566267509,0.725290545554841,-1.28425666062026,0.850421147421599,0.74136207341625,1.17050883500152,-0.524250785880244,1.43405833024776,1.57188550737765,0.84875523629905,2.0556726045952,1.32900171522957,-0.97673054633043,-0.65259217253736,-0.584991253770117,-0.084637519204853,-0.839718983656907,1.23439336025896,0.43737368457076,1.07996836152042],"y":[-0.132490449277613,-0.502559492621546,-0.540703253299509,0.186267251368334,0.0055856327213159,0.0453823898615211,0.262156923576578,-0.181557875660897,-1.14717633188579,-1.01142588348805,0.139646449443976,-0.0412616084694191,0.133686634046132,-0.133894266088224,-0.365001812057898,-0.416380935022172,-0.32173498038584,-0.0902634636437241,-0.397286771569936,-0.36360871733433,0.277157517115647,0.176703620273537,-0.208193863556399,0.547748523247603,0.495961992833864,-0.148184663594839,-0.00328474721523243,0.0352980133633103,-0.288042311306762,0.00525177480491382,0.0605903746300029,0.0627673603327409,-0.245568267242749,0.329974552949825,0.349003071254077,0.0587363997981831,-0.856287299487322,-0.0834760230917996,-0.542784908118028,0.0219774617981354,-0.10075492869541,0.466383028691363,0.461075121339902,-0.165393808686397,0.129106785862131,-0.848663991428179,-0.277212653464152,-0.74233960840177,-0.0319601138231471,0.125270955746387,0.0705713620842038,-0.173205290063396,-0.328561284362795,-0.271358305281115,-0.129542540894684,0.190521720471409,-0.641978269612722,0.816992412602893,-0.145558177338578,-0.0844214269145126,0.38741230432803,0.415889136191003,-0.334387720953219,-0.241151164199622,0.100208364874545,0.23423961408274,-0.115571875825122,-0.714756410614009,0.0204427968774989,0.0842371943881513,0.642553827651754,-0.645757655673909,-0.0414717846080093,-0.309649145357161,-0.275656562565998,-0.32792277269814,0.64720361835536,-0.314240104587801,0.0749869761860061,-0.409244296786879,0.416505862453771,0.915440605475422,-0.523773747326445,-0.198908545044477,0.34089345222866,0.460933508363449,-0.663345672912352,0.599410791695722,0.21953961637893,-0.229901777831736,0.627524649378769,0.625693317776777,0.574801292782123,-0.173312319553172,-0.0729114475607845,1.04295090823071,0.0454311016458878,-0.0910830892730632,0.0527205785370344,-0.476194531798156,0.59182726934125,0.358016621484835,0.0816910854041921,0.159167136908619,0.192605273206566,0.145270447403346,0.124189160978949,0.324133058223221,-0.0600466149567996,-0.0464698219924557,-0.255568607147103,-0.135910232787848,0.525035289148771,0.00393128591515928,0.326878468223188,-0.109009247709835,-0.385590222676565,1.35349662272632,0.208438615845445,-0.172880360179652,-0.489036700467517,-0.150865036316555,-0.381007395478473,-0.148969365830162,0.11136056500367,-0.136091768065842,-0.49264652644754,-0.34553160757251,0.309775980269507,-0.273112243319878,0.637641200890926,-0.228068541001847,-0.325162487883998,-0.128459763428428,-0.700263856704914,-0.565000405664523,-0.260347854552944,-0.0825262438445855,0.404369583295835,-0.202364061844804,-0.294721012644356,0.329037205545662,0.323473389926613,0.784343928687173,0.897442852355865,-0.174444671735272,-0.00116952297214898,-0.512909252280198,0.084264109248613,0.351473669361909,0.465079849654041,0.189053666692663,-0.140167600086866,0.0639275354274502,-0.343923105210099,0.158404701025186,-0.0449032581245694,0.753361320726738,0.145483121354013,-0.238915473765795,0.09259608395311,0.0738800150825173,-0.120256125774371,-0.179797906326649,-0.132955900877076,-0.556402554891403,0.273056562501612,0.341046813376198,-0.00507400587596615,0.196211497243031,1.0343261970082,-0.204573768957316,-0.394154278392674,-0.172972507649411,0.500793380777295,0.029898633991521,0.311981820031862,-0.0150931142859291,0.710409904426229,-0.468150855171081,0.286001296718886,-0.454955266629274,-0.907780113171584,-0.198195744769746,-0.407618462214064,0.425359315611163,-0.0868153544332913,0.584428199510151,0.369039533980907,-0.279643212509412,0.39882803373961,0.756612710474323,-0.439303778110237,-0.207774011802673,-0.166157130406098,0.215677988637538,-0.347694145423146,-0.106649660764818,0.365601325531443,0.44770053471364],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.317052292962122,0.193878561480544,-0.41326105893388,-0.85707527185096,-1.43099897529948,-0.518468557421583,-0.622042474749213,0.0479696340088377,-2.08477867719365,-1.50423992259961,-0.367262413193018,-0.485482504567705,0.0551774441889881,-2.11765046798312,1.63354144825784,1.40702884720877,-1.02582026286947,1.06263073963947,-0.374218365425488,-0.611197604508904,0.997807032485996,-0.406177635017449,-1.6866233649608,1.29541148675775,1.92725221990273,-0.741310920788456,-0.450383973596516,-0.600531644543834,0.243265709037368,0.680809174200518,0.466811445929138,0.161180018630898,-0.428839536634502,0.956660905453743,1.54450216869938,1.07495053475075,-1.88633857185987,0.767993695744729,-0.594874438321016,0.485290764165845,-0.846704652779134,0.259790791226862,0.360359308358688,0.857720936040034,0.235110543117216,-1.21096954307536,-1.81596045125106,-0.38122444612604,-0.314836204051219,0.66104143087758,0.756558608242975,0.946469888173595,-0.567684897782197,-0.0363011889947873,1.00382998206919,0.46897828297227,-1.8211926729861,0.189206680849289,-0.745485835920375,-0.817239702872552,0.767821216677725,1.27029786851042,-0.13978491481588,-3.08215759070948,-0.581329887456603,0.388790827695731,0.368848900663656,-1.18424982823155,-0.283252849965585,-1.00030886934614,1.06153127380224,-0.838861464635544,-0.605407182068984,0.565154918625396,-0.847931695077746,-1.10013169357777,1.26281543714394,-1.3599804951762,0.16063478272363,-0.289440991332393,0.0679856857886031,0.863692961802963,-0.222213489597535,-0.663367141662263,-1.09503183147401,0.621388796036476,-0.248639390779658,1.21640031507197,-0.737372341911145,-0.568299253754283,-0.103007993349866,0.419142010292751,2.1007931691853,-0.194217075695423,-2.2646923997042,3.05410929396104,0.232762915246086,-0.368182581345207,-0.359966328547906,-1.97046426168591,0.479829942347323,1.4257391469096,-0.476769075577661,-0.258459054787821,0.758193465179814,-0.864038149756047,0.226686364932439,-0.176007025472543,0.0227737411282469,-1.51084687165066,0.988919551248682,-0.906585616826377,1.76856356967217,0.201728870324118,1.34344490875609,-1.11831939165033,-1.18287472681337,0.521258263556013,1.15442180533544,-0.267209269449337,0.208345308118329,-1.00400256316,-0.317891151446007,-0.198954422824362,0.370090086587824,0.348628503846837,-1.72261959032138,-0.901004646076047,-0.253302120237086,2.23782012812667,0.0758175051903877,0.0572975066383884,-1.03003670996251,-0.811352972745464,-1.73732063966332,-0.599034471119768,-0.416101563163754,0.708890327411589,0.272321359452584,-1.32169561047523,-1.68659585335419,-0.261037376772084,1.6317887145274,1.36022210906108,2.09136722635921,0.00520891433571047,-0.743320474796112,-2.01005159173193,0.160841867828946,-0.259823816429873,1.89485309486255,1.20877803547917,-0.515641623770317,-0.374823419010277,-0.329520657261482,-0.158454750089348,0.0051692606212329,-0.0686778143728987,0.272444649473428,-0.273673200888474,-0.719771524798066,0.799134475970601,1.01082246638124,-1.18688250594286,1.24974170615773,-1.17731201949229,0.799076778723253,0.516303061706412,1.12332281852848,-0.891591469828551,1.00326205365107,0.340498548392204,-0.465823931335237,0.445596811845822,0.801698422955217,-1.17780105549409,0.409202385237175,0.00524949663176892,0.818633931446687,0.311414489478059,1.72453566267509,0.725290545554841,-1.28425666062026,0.850421147421599,0.74136207341625,1.17050883500152,-0.524250785880244,1.43405833024776,1.57188550737765,0.84875523629905,2.0556726045952,1.32900171522957,-0.97673054633043,-0.65259217253736,-0.584991253770117,-0.084637519204853,-0.839718983656907,1.23439336025896,0.43737368457076,1.07996836152042],"y":[-0.132490449277613,-0.502559492621546,-0.540703253299509,0.186267251368334,0.0055856327213159,0.0453823898615211,0.262156923576578,-0.181557875660897,-1.14717633188579,-1.01142588348805,0.139646449443976,-0.0412616084694191,0.133686634046132,-0.133894266088224,-0.365001812057898,-0.416380935022172,-0.32173498038584,-0.0902634636437241,-0.397286771569936,-0.36360871733433,0.277157517115647,0.176703620273537,-0.208193863556399,0.547748523247603,0.495961992833864,-0.148184663594839,-0.00328474721523243,0.0352980133633103,-0.288042311306762,0.00525177480491382,0.0605903746300029,0.0627673603327409,-0.245568267242749,0.329974552949825,0.349003071254077,0.0587363997981831,-0.856287299487322,-0.0834760230917996,-0.542784908118028,0.0219774617981354,-0.10075492869541,0.466383028691363,0.461075121339902,-0.165393808686397,0.129106785862131,-0.848663991428179,-0.277212653464152,-0.74233960840177,-0.0319601138231471,0.125270955746387,0.0705713620842038,-0.173205290063396,-0.328561284362795,-0.271358305281115,-0.129542540894684,0.190521720471409,-0.641978269612722,0.816992412602893,-0.145558177338578,-0.0844214269145126,0.38741230432803,0.415889136191003,-0.334387720953219,-0.241151164199622,0.100208364874545,0.23423961408274,-0.115571875825122,-0.714756410614009,0.0204427968774989,0.0842371943881513,0.642553827651754,-0.645757655673909,-0.0414717846080093,-0.309649145357161,-0.275656562565998,-0.32792277269814,0.64720361835536,-0.314240104587801,0.0749869761860061,-0.409244296786879,0.416505862453771,0.915440605475422,-0.523773747326445,-0.198908545044477,0.34089345222866,0.460933508363449,-0.663345672912352,0.599410791695722,0.21953961637893,-0.229901777831736,0.627524649378769,0.625693317776777,0.574801292782123,-0.173312319553172,-0.0729114475607845,1.04295090823071,0.0454311016458878,-0.0910830892730632,0.0527205785370344,-0.476194531798156,0.59182726934125,0.358016621484835,0.0816910854041921,0.159167136908619,0.192605273206566,0.145270447403346,0.124189160978949,0.324133058223221,-0.0600466149567996,-0.0464698219924557,-0.255568607147103,-0.135910232787848,0.525035289148771,0.00393128591515928,0.326878468223188,-0.109009247709835,-0.385590222676565,1.35349662272632,0.208438615845445,-0.172880360179652,-0.489036700467517,-0.150865036316555,-0.381007395478473,-0.148969365830162,0.11136056500367,-0.136091768065842,-0.49264652644754,-0.34553160757251,0.309775980269507,-0.273112243319878,0.637641200890926,-0.228068541001847,-0.325162487883998,-0.128459763428428,-0.700263856704914,-0.565000405664523,-0.260347854552944,-0.0825262438445855,0.404369583295835,-0.202364061844804,-0.294721012644356,0.329037205545662,0.323473389926613,0.784343928687173,0.897442852355865,-0.174444671735272,-0.00116952297214898,-0.512909252280198,0.084264109248613,0.351473669361909,0.465079849654041,0.189053666692663,-0.140167600086866,0.0639275354274502,-0.343923105210099,0.158404701025186,-0.0449032581245694,0.753361320726738,0.145483121354013,-0.238915473765795,0.09259608395311,0.0738800150825173,-0.120256125774371,-0.179797906326649,-0.132955900877076,-0.556402554891403,0.273056562501612,0.341046813376198,-0.00507400587596615,0.196211497243031,1.0343261970082,-0.204573768957316,-0.394154278392674,-0.172972507649411,0.500793380777295,0.029898633991521,0.311981820031862,-0.0150931142859291,0.710409904426229,-0.468150855171081,0.286001296718886,-0.454955266629274,-0.907780113171584,-0.198195744769746,-0.407618462214064,0.425359315611163,-0.0868153544332913,0.584428199510151,0.369039533980907,-0.279643212509412,0.39882803373961,0.756612710474323,-0.439303778110237,-0.207774011802673,-0.166157130406098,0.215677988637538,-0.347694145423146,-0.106649660764818,0.365601325531443,0.44770053471364],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
### Reason 3: Multiple regression exists
- Regressing out the confounder beforehand can remove the effect of your covariate of interest
- Ordinary least-squares regression yields estimates for each covariate controlling for all other variables in the model
- So what if we just fit a model with both the confounder and the independent variable?
---
class: img-caption
![](jane_618_f2.gif)
Answer: Looks great, let's do this instead
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
### Reason 4: Even if you really like two-step &lt;br&gt; regression, there's a better way
- Lindquist et al. (2019) suggest that there is a correct way to use modular preprocessing pipelines
- In our earlier model, let's say you regress out the confounder `\(z_i\)` out of the outcome `\(y_i\)`, but also out of the covariate of interest `\(x_i\)`
    - Now you are isolating the effect of `\(x_i\)` independent of `\(z_i\)`
---
class: img-caption
![](hbm24528-fig-0003-ml.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Key Takeaways
- Avoid "residual" or "two-step" regression
    - Just use multiple regression instead
- When dealing with modular pipelines, do one of the following
    - Regress out all confounders simultaneously
    - For each new step, regress the confounders on all confounders from previous steps
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
