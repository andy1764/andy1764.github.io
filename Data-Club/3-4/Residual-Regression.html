<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Why Everyone Should Stop Regressing on Residuals</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Chen" />
    <script src="Residual-Regression_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="Residual-Regression_files/plotly-binding-4.9.1/plotly.js"></script>
    <script src="Residual-Regression_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="Residual-Regression_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="Residual-Regression_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="Residual-Regression_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="Residual-Regression_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="Residual-Regression_files/plotly-main-1.49.4/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="PennSIVE-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Why Everyone Should Stop Regressing on Residuals
### Andrew Chen

---




&lt;style type="text/css"&gt;
.remark-slide-content.img-caption {
  background-image: none;
  text-align: center;
  padding-top: 61.5%;
}
.remark-slide-content.img-caption &gt; p:first-of-type {
  padding: 0px;
  margin: 0px;
}
.remark-slide-content.img-caption &gt; p:first-of-type &gt; img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 95%;
  height: 75%;
  margin: 2.5% 2.5% 2.5% 2.5%;
  object-fit: contain;
}

.remark-slide-content.just-img {
  background-image: none;
  text-align: center;
  padding-top: 0px;
}
&lt;/style&gt;

### Reason 1: It can reintroduce unwanted effects
- Recent paper by Lindquist et al. showed that motion artifacts removed from one preprocessing step can be reintroduced by another preprocessing step&lt;sup&gt;1&lt;/sup&gt;
- Let's dive into why this happens
.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0001-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0003-mr.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](https://onlinelibrary.wiley.com/cms/asset/0f891eac-2a43-4632-990f-5db53f241434/hbm24528-fig-0006-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Reason 2: You are not properly controlling for confounders
- Suppose we have `\(n\)` observations indexed by `\(i\)` with
    - Dependent variable `\(y_i\)`
    - Covariate of interest `\(x_i\)`
    - Confounder `\(z_i\)` that is correlated with `\(x_i\)`

`$$y_i=\beta_0+\beta_1x_i+\beta_2z_i+\epsilon_i$$`
- How can we get an estimate of `\(\beta_1\)`?
- What if we first regress out the confounder, then regress the residuals on the covariate of interest?
---
class: img-caption
![](jane_618_f1.gif)
Answer: We get very poor estimates, even with larger samples
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
class: just-img


<div id="htmlwidget-4f6578c97efd67e275d0" style="width:100%;height:600px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-4f6578c97efd67e275d0">{"x":{"visdat":{"1492e548db232":["function () ","plotlyVisDat"]},"cur_data":"1492e548db232","attrs":{"1492e548db232":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"1492e548db232.1":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Covariate"},"yaxis":{"title":"Confounder"},"zaxis":{"title":"Outcome"},"camera":{"eye":{"x":1.25,"y":-1.25,"z":1.25}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.277037301524795,-1.13623468545725,-1.03449106402495,0.560989441466795,-1.16799323322959,-0.713302227262696,0.939806761685801,-0.669915979360391,-0.68312531688732,-0.789789250232991,-0.0320943226787068,0.245642215366923,-0.768117508569175,0.21346537491462,-0.0352082250690141,0.0988607610677575,0.271343231895484,-0.594168650854105,-0.528834963913898,2.0506206543788,1.83014863496335,-0.921290414127358,0.650795746419886,0.729783465167536,0.642844295840603,-0.705718359549489,0.485572474723293,0.485082909518829,1.40254186599411,0.397456338697494,0.200545514196939,-1.16219972510714,1.05098881134432,1.18431506345729,-1.86471319835091,-1.26441893798301,-0.0261322984296533,-0.961770017554434,-0.996232976598193,1.0535490307617,0.554785005768539,-0.341965313948001,0.00183476895242607,-0.620505567741601,-0.399719188023296,0.0667024151651932,-0.550468652675476,0.509315819551463,-0.173228609642317,-2.03835507000181,0.527591059933296,-1.31399482111647,1.23581833574263,0.825589160091718,0.752207694936728,0.103472846258211,-0.850623653472541,-2.35788571332219,-1.76190060881081,-2.46912203946108,-0.154649037475556,-0.824195526376615,0.830752280406131,0.849778482870749,-1.76450359934974,-1.15232163105202,-1.00075615982224,1.0697778441413,-0.0111046888274658,0.544366828138026,-0.187411701028564,-0.366820435389721,-0.485694728463829,1.33538190247195,0.279403537800201,-0.881986214464378,-0.073676416464578,-1.65314275220487,-0.816163411362838,-0.128221933754023,1.48094948202821,1.36032703008328,0.575268776652842,-0.360281432922508,0.621143526733465,0.62325715385309,-0.810791546671016,0.378403095632898,0.649441615286133,0.261800201453276,-1.7145306845314,-0.327495636004607,-0.640165734470201,1.24133157662866,1.17950006327864,0.677859090794255,-0.531967027462883,-0.53302578152361,-1.5421433723539,1.95615829189583,-0.228257406243808,2.37357672383863,-0.50140462998565,-0.162658167346596,1.74641422646401,0.462887252937715,1.48358780596247,-1.8982763230902,0.0794383150737591,0.0919091415943565,0.197519021382913,-1.39929667345157,0.177010007939686,0.412655300666573,-0.533429640403342,-0.813201934281576,1.52590640597088,1.19757774630867,-0.12940621549215,-0.664570362272431,-1.37761376801719,0.0935260879201031,-0.20389672913018,-2.56459185379854,-0.166274645320781,-0.077898163225382,-0.0870252817885665,-0.603376727738161,-0.927317760094837,2.15829776356654,0.0256746888735048,1.04851310679204,-0.648893809888331,0.149812061458794,-1.13855524950359,-1.09001674989746,-0.405092933931611,-1.66497476505379,-0.301520250097053,-2.63574852425115,-1.15336530597486,1.27013624398315,0.441413493985595,1.87768727114069,1.09808174408076,-1.13448926614537,0.498331370840119,-1.89535379144676,0.670236307321914,0.402534328330823,1.2088163854673,-1.65314883060404,0.240000085230562,-0.39950316525742,1.7498688503183,-0.0419410960314162,1.14588774851286,0.41313844938154,0.34141915659159,-1.4431662563276,-0.30581393353947,1.06887071489982,-0.776578515909263,1.38156788345547,-0.383147557115673,0.25185279880414,2.17637386923626,0.0219937026919849,0.0998675127995444,0.853706748781346,-0.854824832523988,-0.535508330855992,1.01091169503977,-0.127955362133747,-0.835793871332103,0.0149970231209662,-0.26152176754173,1.87688915188861,1.14988696707171,-0.861837902313154,0.207237713384607,-1.48442209686398,0.901465380887287,-1.18758309205305,1.44207727789441,-0.528727449028552,-0.237787674634482,-0.407006340106512,-0.414421366142048,0.112104050837051,-0.629490159763469,-0.606120031562667,-0.589955286484335,1.10467090222098,3.39311165727345,0.924902913709569,0.766611033488658,-1.88468795191209,-0.526193585286267,-0.561483166026704],"y":[-0.538624151992046,-1.15595338578144,0.142926766237355,0.604648452704287,0.127420555867571,-1.11185875019837,0.329577373496214,-0.6911337560473,-0.298368670424587,-1.1650355497616,-0.659241846507769,-0.073877833767028,-0.667123194573735,-0.776353427495805,1.39941115488421,1.25961188301978,0.4174634364048,-0.977154344676528,-0.894306247709988,-0.320258860431964,0.547190948016364,1.11782423893974,-0.100683935610821,1.23746109127262,1.39190046137058,1.50041199654029,0.391904534035313,-0.596519203386248,0.262632754138526,-0.668191133137464,0.19676656950563,-0.409491976898873,-0.17083627641945,-0.0155780370425873,-0.266424333466849,-0.696887744389456,1.56966768095348,-1.12966013052278,0.549206504770002,0.229214844050454,-2.12264186702164,-0.285057176511816,-0.611688108589035,-0.494155708684652,-1.29796945079577,-0.167296175455321,-0.145362735186038,-0.122365283043118,-1.30464036372896,-0.749525459292794,0.0690002840311804,-1.24673058314689,1.3698941355329,-0.0918923799138253,1.43772651993005,-0.673796819654893,-1.06410796673539,-0.187209071595929,-0.673357919780543,-1.78343263728065,-1.37234896802316,-0.953644203367151,-0.767154893001635,1.46515826627894,-0.660550531718091,-0.2379769945913,0.71374809883155,1.00248406957931,0.680392014625873,0.0689482507546703,0.036244760151253,-0.0108023703055312,-0.775291519449757,0.332924340942793,0.290293112196858,-1.22441780921875,1.09423742170015,-0.930118354645682,-0.546379733792539,0.0599831926798756,0.436040179999539,0.478994591224394,0.340733767838791,-0.056454176510948,1.59355218365336,0.972423604405095,-1.50545847202601,-0.226955758699305,-0.881897039169371,-0.851819212264097,-0.917402167052447,0.141904754784504,-0.0288395563530697,0.889352015369182,0.462359238788037,0.284730307401663,2.21999889225793,1.3605312387963,-0.45360580898814,2.67707827074309,0.969523141047722,1.77548945231444,0.404435399511068,1.1826086443222,0.810430732777166,0.264469794279913,2.32194509675901,-1.16215177461098,1.19865841562135,0.0240607518024351,0.209031789500403,-1.96262104148473,-0.614669895839308,1.31974046714411,-1.20485504755072,0.995680402535894,0.315509738420915,-0.04787685677017,0.897222359427002,0.71433989295985,-2.35364261674965,1.30146794904743,-0.7272943244261,-1.51362242226763,0.927060896345842,1.11162925585951,-1.10065809519498,-0.165704756616676,-2.20152049567328,0.061909488180362,-1.77585498287007,0.935406691727302,-0.415151454223687,-0.453933973796043,-0.243824227362548,1.16529522360366,-0.519899863351304,-1.13327876179112,0.652272691112736,-1.04062169962571,-0.0871345967155205,1.58293132641886,1.38470610836254,2.70779209212126,-0.0754440227067174,-0.0728252903118851,-0.299055402128263,0.0616571051735297,0.355525971333514,-0.972151856006577,1.2418493667428,-1.69718928292967,0.518178889494848,-0.17114368746656,0.0915924154240318,0.352584374703001,-0.792769687307149,0.948296885613431,1.14879625203932,-1.02542418750785,0.306608343507557,1.98088487426386,-0.389897070518661,1.67224216231486,-1.27530219690648,-0.235617640793661,1.71684183139262,0.432955138461749,-0.219548692448186,1.67366851946875,-0.484232239893232,0.337452077180804,0.309282643013534,-1.41919075464548,0.0756867444057664,0.0278047701805524,0.124030513758087,0.623137465750851,0.978668033210416,-0.775705503355883,-0.220105238315259,-1.90371255088835,1.51803961024986,-1.12729720331485,0.803901337148152,-0.542682158312044,0.174855015292629,-0.356538848900892,0.281592152159743,1.51859619174123,-0.489121690242973,-0.618135365601842,0.241074233063067,0.992309578275685,0.262726998464484,0.390443042108367,-0.135304808387241,-0.159002131054129,-0.537214070871333,-2.32165611222511],"z":[0.443805741062895,-0.589762891342399,0.390673750073364,1.83071528444444,0.286367884371273,-0.262843925698059,1.90333765315209,0.0620339437393002,0.327722967406349,-0.353608601471531,0.530833440094151,1.13500382564461,0.0101002663246468,0.620747121717855,1.96971080939532,1.96569960938596,1.49693342633488,-0.0851573383467594,0.0185699103879641,2.22602201428747,2.67890646661049,1.15234243589335,1.39984702609103,2.39183994803279,2.43909008857251,1.57105430441824,1.62900266465571,0.936763352817491,2.18039099261753,0.825254402416705,1.29288721711648,-0.0854154328795236,1.63087553297209,1.83288467701498,-0.477027513747745,-0.358145919136039,2.09524352629136,-0.449232345129364,0.70185022824495,1.91270347089319,-0.0827310443524873,0.575853015202812,0.587871420779058,0.234505865026307,-0.173613288648664,0.944353126321595,0.527686787021624,1.28563413408053,-0.0197395228352086,-0.936747611981542,1.43238269929982,-0.777739024459671,2.83876748841756,1.52835650464921,2.54772270893143,0.615541977147007,-0.32554337562087,-0.766797590918001,-0.689912211489262,-1.96201951519453,-0.0541298453244174,-0.229719052295952,1.05928692970783,2.63522448292946,-0.682769133222801,0.0415597205743607,0.813863115831198,2.46535209812911,1.48326988658357,1.44408931374957,0.908951899910566,0.750432794538007,0.132078384985174,2.182583128915,1.41355641352263,-0.459714058053508,1.72916146218959,-0.793514016270703,0.0609885569159205,0.967001639772781,2.35666152194411,2.30229389344006,1.65597053966883,0.723053831921265,2.56505575579546,2.13174528930541,-0.606606254563236,1.1207818943782,0.852049961806417,0.60175545095711,-0.827584237584007,0.884855141670612,0.546465054948394,2.50624727292318,2.16407026997136,1.68858133726183,2.19639106388122,1.59402257861557,-0.382255668414746,4.25803435237193,1.53365477288742,3.91911508183183,0.946890297192477,1.7287340924076,2.80456022999351,1.52391869157702,3.67864179042972,-1.12753090986614,1.90943647001126,1.09594768390244,1.29935432614301,-1.33857364193073,0.708406836994949,2.22744579599216,-0.202030523043162,1.14250368630271,2.30376005959894,1.81955938120164,1.55224005927908,1.04960743000588,-1.5971107108121,1.99126458440195,0.362935021035288,-1.83998123472163,1.54731913424223,1.73838052336857,0.183390394636199,0.476411719476298,-1.175418020513,2.56891383474752,-0.210357447272914,2.40351261748823,0.269937073646271,0.80188341988861,0.0471031247183881,1.06746369011902,0.367273800426643,-0.944008710266754,1.26029546723566,-1.55869039818911,0.146418826641414,3.01191605780609,2.29305248016838,4.22460431280805,1.73061516348652,0.169648569004604,1.15426193662298,-0.268818921866576,1.73280235358348,0.616036489151656,2.73023478507175,-1.33046792094891,1.54549404083247,0.615315961617899,2.30379164454432,1.23221905359479,1.26195140136868,1.96777349302116,2.05791954456632,-0.713244552160131,1.01532484550235,3.14959767093926,0.198235848025138,3.15243579056391,-0.146146069290825,1.02613336913202,3.7400197489649,1.3332329473323,0.930991932770635,2.78393144629975,0.0774288078326306,0.876129380952053,1.938904795162,-0.0682335232207754,0.482693769676249,1.04473001383575,0.918524880876134,2.7647873908723,2.50475725872217,-0.131511625443642,1.00576149107323,-1.35692549490195,2.70842225232068,-0.605647448232843,2.58695378905448,0.264782033386267,0.970715896985387,0.480287126219501,0.92178830873707,2.15625892832948,0.231740463520175,0.157789980509527,0.770552021129797,2.48265509487235,3.57385581754124,1.93551092759724,1.45668311609568,-0.415814299551667,0.270383399214364,-1.00342873625158],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[-0.277037301524795,-1.13623468545725,-1.03449106402495,0.560989441466795,-1.16799323322959,-0.713302227262696,0.939806761685801,-0.669915979360391,-0.68312531688732,-0.789789250232991,-0.0320943226787068,0.245642215366923,-0.768117508569175,0.21346537491462,-0.0352082250690141,0.0988607610677575,0.271343231895484,-0.594168650854105,-0.528834963913898,2.0506206543788,1.83014863496335,-0.921290414127358,0.650795746419886,0.729783465167536,0.642844295840603,-0.705718359549489,0.485572474723293,0.485082909518829,1.40254186599411,0.397456338697494,0.200545514196939,-1.16219972510714,1.05098881134432,1.18431506345729,-1.86471319835091,-1.26441893798301,-0.0261322984296533,-0.961770017554434,-0.996232976598193,1.0535490307617,0.554785005768539,-0.341965313948001,0.00183476895242607,-0.620505567741601,-0.399719188023296,0.0667024151651932,-0.550468652675476,0.509315819551463,-0.173228609642317,-2.03835507000181,0.527591059933296,-1.31399482111647,1.23581833574263,0.825589160091718,0.752207694936728,0.103472846258211,-0.850623653472541,-2.35788571332219,-1.76190060881081,-2.46912203946108,-0.154649037475556,-0.824195526376615,0.830752280406131,0.849778482870749,-1.76450359934974,-1.15232163105202,-1.00075615982224,1.0697778441413,-0.0111046888274658,0.544366828138026,-0.187411701028564,-0.366820435389721,-0.485694728463829,1.33538190247195,0.279403537800201,-0.881986214464378,-0.073676416464578,-1.65314275220487,-0.816163411362838,-0.128221933754023,1.48094948202821,1.36032703008328,0.575268776652842,-0.360281432922508,0.621143526733465,0.62325715385309,-0.810791546671016,0.378403095632898,0.649441615286133,0.261800201453276,-1.7145306845314,-0.327495636004607,-0.640165734470201,1.24133157662866,1.17950006327864,0.677859090794255,-0.531967027462883,-0.53302578152361,-1.5421433723539,1.95615829189583,-0.228257406243808,2.37357672383863,-0.50140462998565,-0.162658167346596,1.74641422646401,0.462887252937715,1.48358780596247,-1.8982763230902,0.0794383150737591,0.0919091415943565,0.197519021382913,-1.39929667345157,0.177010007939686,0.412655300666573,-0.533429640403342,-0.813201934281576,1.52590640597088,1.19757774630867,-0.12940621549215,-0.664570362272431,-1.37761376801719,0.0935260879201031,-0.20389672913018,-2.56459185379854,-0.166274645320781,-0.077898163225382,-0.0870252817885665,-0.603376727738161,-0.927317760094837,2.15829776356654,0.0256746888735048,1.04851310679204,-0.648893809888331,0.149812061458794,-1.13855524950359,-1.09001674989746,-0.405092933931611,-1.66497476505379,-0.301520250097053,-2.63574852425115,-1.15336530597486,1.27013624398315,0.441413493985595,1.87768727114069,1.09808174408076,-1.13448926614537,0.498331370840119,-1.89535379144676,0.670236307321914,0.402534328330823,1.2088163854673,-1.65314883060404,0.240000085230562,-0.39950316525742,1.7498688503183,-0.0419410960314162,1.14588774851286,0.41313844938154,0.34141915659159,-1.4431662563276,-0.30581393353947,1.06887071489982,-0.776578515909263,1.38156788345547,-0.383147557115673,0.25185279880414,2.17637386923626,0.0219937026919849,0.0998675127995444,0.853706748781346,-0.854824832523988,-0.535508330855992,1.01091169503977,-0.127955362133747,-0.835793871332103,0.0149970231209662,-0.26152176754173,1.87688915188861,1.14988696707171,-0.861837902313154,0.207237713384607,-1.48442209686398,0.901465380887287,-1.18758309205305,1.44207727789441,-0.528727449028552,-0.237787674634482,-0.407006340106512,-0.414421366142048,0.112104050837051,-0.629490159763469,-0.606120031562667,-0.589955286484335,1.10467090222098,3.39311165727345,0.924902913709569,0.766611033488658,-1.88468795191209,-0.526193585286267,-0.561483166026704],"y":[-0.538624151992046,-1.15595338578144,0.142926766237355,0.604648452704287,0.127420555867571,-1.11185875019837,0.329577373496214,-0.6911337560473,-0.298368670424587,-1.1650355497616,-0.659241846507769,-0.073877833767028,-0.667123194573735,-0.776353427495805,1.39941115488421,1.25961188301978,0.4174634364048,-0.977154344676528,-0.894306247709988,-0.320258860431964,0.547190948016364,1.11782423893974,-0.100683935610821,1.23746109127262,1.39190046137058,1.50041199654029,0.391904534035313,-0.596519203386248,0.262632754138526,-0.668191133137464,0.19676656950563,-0.409491976898873,-0.17083627641945,-0.0155780370425873,-0.266424333466849,-0.696887744389456,1.56966768095348,-1.12966013052278,0.549206504770002,0.229214844050454,-2.12264186702164,-0.285057176511816,-0.611688108589035,-0.494155708684652,-1.29796945079577,-0.167296175455321,-0.145362735186038,-0.122365283043118,-1.30464036372896,-0.749525459292794,0.0690002840311804,-1.24673058314689,1.3698941355329,-0.0918923799138253,1.43772651993005,-0.673796819654893,-1.06410796673539,-0.187209071595929,-0.673357919780543,-1.78343263728065,-1.37234896802316,-0.953644203367151,-0.767154893001635,1.46515826627894,-0.660550531718091,-0.2379769945913,0.71374809883155,1.00248406957931,0.680392014625873,0.0689482507546703,0.036244760151253,-0.0108023703055312,-0.775291519449757,0.332924340942793,0.290293112196858,-1.22441780921875,1.09423742170015,-0.930118354645682,-0.546379733792539,0.0599831926798756,0.436040179999539,0.478994591224394,0.340733767838791,-0.056454176510948,1.59355218365336,0.972423604405095,-1.50545847202601,-0.226955758699305,-0.881897039169371,-0.851819212264097,-0.917402167052447,0.141904754784504,-0.0288395563530697,0.889352015369182,0.462359238788037,0.284730307401663,2.21999889225793,1.3605312387963,-0.45360580898814,2.67707827074309,0.969523141047722,1.77548945231444,0.404435399511068,1.1826086443222,0.810430732777166,0.264469794279913,2.32194509675901,-1.16215177461098,1.19865841562135,0.0240607518024351,0.209031789500403,-1.96262104148473,-0.614669895839308,1.31974046714411,-1.20485504755072,0.995680402535894,0.315509738420915,-0.04787685677017,0.897222359427002,0.71433989295985,-2.35364261674965,1.30146794904743,-0.7272943244261,-1.51362242226763,0.927060896345842,1.11162925585951,-1.10065809519498,-0.165704756616676,-2.20152049567328,0.061909488180362,-1.77585498287007,0.935406691727302,-0.415151454223687,-0.453933973796043,-0.243824227362548,1.16529522360366,-0.519899863351304,-1.13327876179112,0.652272691112736,-1.04062169962571,-0.0871345967155205,1.58293132641886,1.38470610836254,2.70779209212126,-0.0754440227067174,-0.0728252903118851,-0.299055402128263,0.0616571051735297,0.355525971333514,-0.972151856006577,1.2418493667428,-1.69718928292967,0.518178889494848,-0.17114368746656,0.0915924154240318,0.352584374703001,-0.792769687307149,0.948296885613431,1.14879625203932,-1.02542418750785,0.306608343507557,1.98088487426386,-0.389897070518661,1.67224216231486,-1.27530219690648,-0.235617640793661,1.71684183139262,0.432955138461749,-0.219548692448186,1.67366851946875,-0.484232239893232,0.337452077180804,0.309282643013534,-1.41919075464548,0.0756867444057664,0.0278047701805524,0.124030513758087,0.623137465750851,0.978668033210416,-0.775705503355883,-0.220105238315259,-1.90371255088835,1.51803961024986,-1.12729720331485,0.803901337148152,-0.542682158312044,0.174855015292629,-0.356538848900892,0.281592152159743,1.51859619174123,-0.489121690242973,-0.618135365601842,0.241074233063067,0.992309578275685,0.262726998464484,0.390443042108367,-0.135304808387241,-0.159002131054129,-0.537214070871333,-2.32165611222511],"z":[0.443805741062895,-0.589762891342399,0.390673750073364,1.83071528444444,0.286367884371273,-0.262843925698059,1.90333765315209,0.0620339437393002,0.327722967406349,-0.353608601471531,0.530833440094151,1.13500382564461,0.0101002663246468,0.620747121717855,1.96971080939532,1.96569960938596,1.49693342633488,-0.0851573383467594,0.0185699103879641,2.22602201428747,2.67890646661049,1.15234243589335,1.39984702609103,2.39183994803279,2.43909008857251,1.57105430441824,1.62900266465571,0.936763352817491,2.18039099261753,0.825254402416705,1.29288721711648,-0.0854154328795236,1.63087553297209,1.83288467701498,-0.477027513747745,-0.358145919136039,2.09524352629136,-0.449232345129364,0.70185022824495,1.91270347089319,-0.0827310443524873,0.575853015202812,0.587871420779058,0.234505865026307,-0.173613288648664,0.944353126321595,0.527686787021624,1.28563413408053,-0.0197395228352086,-0.936747611981542,1.43238269929982,-0.777739024459671,2.83876748841756,1.52835650464921,2.54772270893143,0.615541977147007,-0.32554337562087,-0.766797590918001,-0.689912211489262,-1.96201951519453,-0.0541298453244174,-0.229719052295952,1.05928692970783,2.63522448292946,-0.682769133222801,0.0415597205743607,0.813863115831198,2.46535209812911,1.48326988658357,1.44408931374957,0.908951899910566,0.750432794538007,0.132078384985174,2.182583128915,1.41355641352263,-0.459714058053508,1.72916146218959,-0.793514016270703,0.0609885569159205,0.967001639772781,2.35666152194411,2.30229389344006,1.65597053966883,0.723053831921265,2.56505575579546,2.13174528930541,-0.606606254563236,1.1207818943782,0.852049961806417,0.60175545095711,-0.827584237584007,0.884855141670612,0.546465054948394,2.50624727292318,2.16407026997136,1.68858133726183,2.19639106388122,1.59402257861557,-0.382255668414746,4.25803435237193,1.53365477288742,3.91911508183183,0.946890297192477,1.7287340924076,2.80456022999351,1.52391869157702,3.67864179042972,-1.12753090986614,1.90943647001126,1.09594768390244,1.29935432614301,-1.33857364193073,0.708406836994949,2.22744579599216,-0.202030523043162,1.14250368630271,2.30376005959894,1.81955938120164,1.55224005927908,1.04960743000588,-1.5971107108121,1.99126458440195,0.362935021035288,-1.83998123472163,1.54731913424223,1.73838052336857,0.183390394636199,0.476411719476298,-1.175418020513,2.56891383474752,-0.210357447272914,2.40351261748823,0.269937073646271,0.80188341988861,0.0471031247183881,1.06746369011902,0.367273800426643,-0.944008710266754,1.26029546723566,-1.55869039818911,0.146418826641414,3.01191605780609,2.29305248016838,4.22460431280805,1.73061516348652,0.169648569004604,1.15426193662298,-0.268818921866576,1.73280235358348,0.616036489151656,2.73023478507175,-1.33046792094891,1.54549404083247,0.615315961617899,2.30379164454432,1.23221905359479,1.26195140136868,1.96777349302116,2.05791954456632,-0.713244552160131,1.01532484550235,3.14959767093926,0.198235848025138,3.15243579056391,-0.146146069290825,1.02613336913202,3.7400197489649,1.3332329473323,0.930991932770635,2.78393144629975,0.0774288078326306,0.876129380952053,1.938904795162,-0.0682335232207754,0.482693769676249,1.04473001383575,0.918524880876134,2.7647873908723,2.50475725872217,-0.131511625443642,1.00576149107323,-1.35692549490195,2.70842225232068,-0.605647448232843,2.58695378905448,0.264782033386267,0.970715896985387,0.480287126219501,0.92178830873707,2.15625892832948,0.231740463520175,0.157789980509527,0.770552021129797,2.48265509487235,3.57385581754124,1.93551092759724,1.45668311609568,-0.415814299551667,0.270383399214364,-1.00342873625158],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
class: just-img
<div id="htmlwidget-d822445119ce95165778" style="width:100%;height:600px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-d822445119ce95165778">{"x":{"visdat":{"1492e54af4f2d":["function () ","plotlyVisDat"]},"cur_data":"1492e54af4f2d","attrs":{"1492e54af4f2d":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1492e54af4f2d.1":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Covariates"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.277037301524795,-1.13623468545725,-1.03449106402495,0.560989441466795,-1.16799323322959,-0.713302227262696,0.939806761685801,-0.669915979360391,-0.68312531688732,-0.789789250232991,-0.0320943226787068,0.245642215366923,-0.768117508569175,0.21346537491462,-0.0352082250690141,0.0988607610677575,0.271343231895484,-0.594168650854105,-0.528834963913898,2.0506206543788,1.83014863496335,-0.921290414127358,0.650795746419886,0.729783465167536,0.642844295840603,-0.705718359549489,0.485572474723293,0.485082909518829,1.40254186599411,0.397456338697494,0.200545514196939,-1.16219972510714,1.05098881134432,1.18431506345729,-1.86471319835091,-1.26441893798301,-0.0261322984296533,-0.961770017554434,-0.996232976598193,1.0535490307617,0.554785005768539,-0.341965313948001,0.00183476895242607,-0.620505567741601,-0.399719188023296,0.0667024151651932,-0.550468652675476,0.509315819551463,-0.173228609642317,-2.03835507000181,0.527591059933296,-1.31399482111647,1.23581833574263,0.825589160091718,0.752207694936728,0.103472846258211,-0.850623653472541,-2.35788571332219,-1.76190060881081,-2.46912203946108,-0.154649037475556,-0.824195526376615,0.830752280406131,0.849778482870749,-1.76450359934974,-1.15232163105202,-1.00075615982224,1.0697778441413,-0.0111046888274658,0.544366828138026,-0.187411701028564,-0.366820435389721,-0.485694728463829,1.33538190247195,0.279403537800201,-0.881986214464378,-0.073676416464578,-1.65314275220487,-0.816163411362838,-0.128221933754023,1.48094948202821,1.36032703008328,0.575268776652842,-0.360281432922508,0.621143526733465,0.62325715385309,-0.810791546671016,0.378403095632898,0.649441615286133,0.261800201453276,-1.7145306845314,-0.327495636004607,-0.640165734470201,1.24133157662866,1.17950006327864,0.677859090794255,-0.531967027462883,-0.53302578152361,-1.5421433723539,1.95615829189583,-0.228257406243808,2.37357672383863,-0.50140462998565,-0.162658167346596,1.74641422646401,0.462887252937715,1.48358780596247,-1.8982763230902,0.0794383150737591,0.0919091415943565,0.197519021382913,-1.39929667345157,0.177010007939686,0.412655300666573,-0.533429640403342,-0.813201934281576,1.52590640597088,1.19757774630867,-0.12940621549215,-0.664570362272431,-1.37761376801719,0.0935260879201031,-0.20389672913018,-2.56459185379854,-0.166274645320781,-0.077898163225382,-0.0870252817885665,-0.603376727738161,-0.927317760094837,2.15829776356654,0.0256746888735048,1.04851310679204,-0.648893809888331,0.149812061458794,-1.13855524950359,-1.09001674989746,-0.405092933931611,-1.66497476505379,-0.301520250097053,-2.63574852425115,-1.15336530597486,1.27013624398315,0.441413493985595,1.87768727114069,1.09808174408076,-1.13448926614537,0.498331370840119,-1.89535379144676,0.670236307321914,0.402534328330823,1.2088163854673,-1.65314883060404,0.240000085230562,-0.39950316525742,1.7498688503183,-0.0419410960314162,1.14588774851286,0.41313844938154,0.34141915659159,-1.4431662563276,-0.30581393353947,1.06887071489982,-0.776578515909263,1.38156788345547,-0.383147557115673,0.25185279880414,2.17637386923626,0.0219937026919849,0.0998675127995444,0.853706748781346,-0.854824832523988,-0.535508330855992,1.01091169503977,-0.127955362133747,-0.835793871332103,0.0149970231209662,-0.26152176754173,1.87688915188861,1.14988696707171,-0.861837902313154,0.207237713384607,-1.48442209686398,0.901465380887287,-1.18758309205305,1.44207727789441,-0.528727449028552,-0.237787674634482,-0.407006340106512,-0.414421366142048,0.112104050837051,-0.629490159763469,-0.606120031562667,-0.589955286484335,1.10467090222098,3.39311165727345,0.924902913709569,0.766611033488658,-1.88468795191209,-0.526193585286267,-0.561483166026704],"y":[0.58876680110532,0.127729253100084,-0.80642095533543,0.763665757569479,0.361669478578399,-1.31940368154735,-0.0941862597040794,0.0407606318722277,-0.577786808860876,-0.413910207369277,-0.286017532762951,-0.196849579715657,0.262949676924878,0.83028122118384,-0.838910995095798,-1.09400900612705,0.524974012783875,-1.40361099064292,0.0600435609574228,0.523834537191937,0.181424283065749,-0.141166120947554,-0.747587823428109,-0.104816183410252,0.0066158539393418,-0.202297053861147,-0.551023184904611,1.14105358043168,0.0233880847751753,-0.283030077209751,0.0809133117298874,0.629277721811079,-0.123054257406478,0.806250254547554,-0.0490075689426372,1.09954647462553,-0.21355052154721,-0.45306082840452,0.363668902104996,0.532541758314135,-0.860781045907881,-0.246706041086182,0.185768152383677,0.0537709122245877,0.58938591595215,-0.0204481259833312,-0.553370390087235,0.21799440483302,-0.630384564241986,-0.692915893384758,-0.300809518687197,0.610029406339364,0.6381240746181,0.126167240560068,1.31376185616088,-0.526308571978833,-0.169512775708284,0.362479366435908,-0.522325988591962,0.836345523380054,-0.158716218467106,0.324131552164269,-0.580617019155558,1.33118423361285,-0.61109511215704,1.04724156211061,-0.170679192658359,0.823546517996395,-0.0149065966553754,-0.139385240233863,-0.10883184507656,-0.504368801816544,0.154588791130646,-0.0848906879548852,0.233914858282707,0.342893845781728,0.299682952292117,-1.03462341806543,0.17613810158758,-0.914352876780659,-0.156595949292073,-0.00796893888132577,-1.04887768174003,-1.35112026892419,0.457305634493949,0.528776026758182,1.14271300315428,-0.352356975672507,-0.0728874509885781,0.0744163410638718,0.435754288885324,-1.42394102931153,-0.477642277255922,-0.318262976324027,0.388827358103457,0.234056579481463,-0.699866831919211,-0.0068372987705979,0.469244032816907,-0.614383288634157,0.838047561369077,0.478552131948185,0.306439242715546,-0.267261972813017,0.616386277187856,-0.0728917378518128,0.164702704341185,-0.624270001458862,0.282092290513304,-0.473238756627237,0.602810620542433,-0.358230614519573,0.25653625239065,1.03617905691045,1.10220560865172,-0.493138209414439,-0.619181250503,-0.125996734243256,-0.944807758711526,0.779072495341166,0.0880169250819711,0.406318560990549,-0.85729367628054,-1.26240531176431,0.444511334908336,-0.102699224590749,0.334209446964533,-0.275948844021778,-0.871235210963306,0.272259475457454,-0.477246041409341,-0.126934964118237,0.4025455364051,-0.368328799223442,0.556891072363082,1.33434550598253,-0.781765932167048,-1.36267844312155,-0.275395643003389,0.0731968890737959,-0.049952464370746,0.254116503378847,-1.14419722822365,-0.957656339016821,0.127605854695364,0.794073735667204,-0.274679414279239,0.465157577871151,-0.207830137700158,0.322854007181932,0.152516547765229,0.0648964540286484,-0.591869768677583,1.20399872024306,-0.922927286350814,-0.48894916457724,0.346179037623447,0.0491007599701983,-0.459314761185703,-0.226902816001875,-0.239447507235474,0.688877106246044,0.101549541406344,0.878589860587764,0.171208269550725,0.0405130655719615,-0.469188141166828,0.32603348269946,-0.191873079646129,0.204745129013301,-0.383797014632612,0.328087797678722,-0.188064406797349,0.908993173416639,0.442921951187949,0.00527670301971203,-0.248598562737767,-0.593717534928789,0.206697414491774,-0.26718054211045,-0.125072206839241,0.0604778441854737,-0.0556808844874333,0.518984745544311,0.235502596790869,-0.515687822720374,0.844109065864328,-0.407196102687779,0.368366505439696,0.56921387797443,0.315654865736025,-0.617798115962637,0.00990377007759225,0.181779690589486,0.926322728381682,-0.327474286838656,0.36248846382745,-0.219320231201925,-0.240298463932618,1.23238041467065],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.277037301524795,-1.13623468545725,-1.03449106402495,0.560989441466795,-1.16799323322959,-0.713302227262696,0.939806761685801,-0.669915979360391,-0.68312531688732,-0.789789250232991,-0.0320943226787068,0.245642215366923,-0.768117508569175,0.21346537491462,-0.0352082250690141,0.0988607610677575,0.271343231895484,-0.594168650854105,-0.528834963913898,2.0506206543788,1.83014863496335,-0.921290414127358,0.650795746419886,0.729783465167536,0.642844295840603,-0.705718359549489,0.485572474723293,0.485082909518829,1.40254186599411,0.397456338697494,0.200545514196939,-1.16219972510714,1.05098881134432,1.18431506345729,-1.86471319835091,-1.26441893798301,-0.0261322984296533,-0.961770017554434,-0.996232976598193,1.0535490307617,0.554785005768539,-0.341965313948001,0.00183476895242607,-0.620505567741601,-0.399719188023296,0.0667024151651932,-0.550468652675476,0.509315819551463,-0.173228609642317,-2.03835507000181,0.527591059933296,-1.31399482111647,1.23581833574263,0.825589160091718,0.752207694936728,0.103472846258211,-0.850623653472541,-2.35788571332219,-1.76190060881081,-2.46912203946108,-0.154649037475556,-0.824195526376615,0.830752280406131,0.849778482870749,-1.76450359934974,-1.15232163105202,-1.00075615982224,1.0697778441413,-0.0111046888274658,0.544366828138026,-0.187411701028564,-0.366820435389721,-0.485694728463829,1.33538190247195,0.279403537800201,-0.881986214464378,-0.073676416464578,-1.65314275220487,-0.816163411362838,-0.128221933754023,1.48094948202821,1.36032703008328,0.575268776652842,-0.360281432922508,0.621143526733465,0.62325715385309,-0.810791546671016,0.378403095632898,0.649441615286133,0.261800201453276,-1.7145306845314,-0.327495636004607,-0.640165734470201,1.24133157662866,1.17950006327864,0.677859090794255,-0.531967027462883,-0.53302578152361,-1.5421433723539,1.95615829189583,-0.228257406243808,2.37357672383863,-0.50140462998565,-0.162658167346596,1.74641422646401,0.462887252937715,1.48358780596247,-1.8982763230902,0.0794383150737591,0.0919091415943565,0.197519021382913,-1.39929667345157,0.177010007939686,0.412655300666573,-0.533429640403342,-0.813201934281576,1.52590640597088,1.19757774630867,-0.12940621549215,-0.664570362272431,-1.37761376801719,0.0935260879201031,-0.20389672913018,-2.56459185379854,-0.166274645320781,-0.077898163225382,-0.0870252817885665,-0.603376727738161,-0.927317760094837,2.15829776356654,0.0256746888735048,1.04851310679204,-0.648893809888331,0.149812061458794,-1.13855524950359,-1.09001674989746,-0.405092933931611,-1.66497476505379,-0.301520250097053,-2.63574852425115,-1.15336530597486,1.27013624398315,0.441413493985595,1.87768727114069,1.09808174408076,-1.13448926614537,0.498331370840119,-1.89535379144676,0.670236307321914,0.402534328330823,1.2088163854673,-1.65314883060404,0.240000085230562,-0.39950316525742,1.7498688503183,-0.0419410960314162,1.14588774851286,0.41313844938154,0.34141915659159,-1.4431662563276,-0.30581393353947,1.06887071489982,-0.776578515909263,1.38156788345547,-0.383147557115673,0.25185279880414,2.17637386923626,0.0219937026919849,0.0998675127995444,0.853706748781346,-0.854824832523988,-0.535508330855992,1.01091169503977,-0.127955362133747,-0.835793871332103,0.0149970231209662,-0.26152176754173,1.87688915188861,1.14988696707171,-0.861837902313154,0.207237713384607,-1.48442209686398,0.901465380887287,-1.18758309205305,1.44207727789441,-0.528727449028552,-0.237787674634482,-0.407006340106512,-0.414421366142048,0.112104050837051,-0.629490159763469,-0.606120031562667,-0.589955286484335,1.10467090222098,3.39311165727345,0.924902913709569,0.766611033488658,-1.88468795191209,-0.526193585286267,-0.561483166026704],"y":[0.58876680110532,0.127729253100084,-0.80642095533543,0.763665757569479,0.361669478578399,-1.31940368154735,-0.0941862597040794,0.0407606318722277,-0.577786808860876,-0.413910207369277,-0.286017532762951,-0.196849579715657,0.262949676924878,0.83028122118384,-0.838910995095798,-1.09400900612705,0.524974012783875,-1.40361099064292,0.0600435609574228,0.523834537191937,0.181424283065749,-0.141166120947554,-0.747587823428109,-0.104816183410252,0.0066158539393418,-0.202297053861147,-0.551023184904611,1.14105358043168,0.0233880847751753,-0.283030077209751,0.0809133117298874,0.629277721811079,-0.123054257406478,0.806250254547554,-0.0490075689426372,1.09954647462553,-0.21355052154721,-0.45306082840452,0.363668902104996,0.532541758314135,-0.860781045907881,-0.246706041086182,0.185768152383677,0.0537709122245877,0.58938591595215,-0.0204481259833312,-0.553370390087235,0.21799440483302,-0.630384564241986,-0.692915893384758,-0.300809518687197,0.610029406339364,0.6381240746181,0.126167240560068,1.31376185616088,-0.526308571978833,-0.169512775708284,0.362479366435908,-0.522325988591962,0.836345523380054,-0.158716218467106,0.324131552164269,-0.580617019155558,1.33118423361285,-0.61109511215704,1.04724156211061,-0.170679192658359,0.823546517996395,-0.0149065966553754,-0.139385240233863,-0.10883184507656,-0.504368801816544,0.154588791130646,-0.0848906879548852,0.233914858282707,0.342893845781728,0.299682952292117,-1.03462341806543,0.17613810158758,-0.914352876780659,-0.156595949292073,-0.00796893888132577,-1.04887768174003,-1.35112026892419,0.457305634493949,0.528776026758182,1.14271300315428,-0.352356975672507,-0.0728874509885781,0.0744163410638718,0.435754288885324,-1.42394102931153,-0.477642277255922,-0.318262976324027,0.388827358103457,0.234056579481463,-0.699866831919211,-0.0068372987705979,0.469244032816907,-0.614383288634157,0.838047561369077,0.478552131948185,0.306439242715546,-0.267261972813017,0.616386277187856,-0.0728917378518128,0.164702704341185,-0.624270001458862,0.282092290513304,-0.473238756627237,0.602810620542433,-0.358230614519573,0.25653625239065,1.03617905691045,1.10220560865172,-0.493138209414439,-0.619181250503,-0.125996734243256,-0.944807758711526,0.779072495341166,0.0880169250819711,0.406318560990549,-0.85729367628054,-1.26240531176431,0.444511334908336,-0.102699224590749,0.334209446964533,-0.275948844021778,-0.871235210963306,0.272259475457454,-0.477246041409341,-0.126934964118237,0.4025455364051,-0.368328799223442,0.556891072363082,1.33434550598253,-0.781765932167048,-1.36267844312155,-0.275395643003389,0.0731968890737959,-0.049952464370746,0.254116503378847,-1.14419722822365,-0.957656339016821,0.127605854695364,0.794073735667204,-0.274679414279239,0.465157577871151,-0.207830137700158,0.322854007181932,0.152516547765229,0.0648964540286484,-0.591869768677583,1.20399872024306,-0.922927286350814,-0.48894916457724,0.346179037623447,0.0491007599701983,-0.459314761185703,-0.226902816001875,-0.239447507235474,0.688877106246044,0.101549541406344,0.878589860587764,0.171208269550725,0.0405130655719615,-0.469188141166828,0.32603348269946,-0.191873079646129,0.204745129013301,-0.383797014632612,0.328087797678722,-0.188064406797349,0.908993173416639,0.442921951187949,0.00527670301971203,-0.248598562737767,-0.593717534928789,0.206697414491774,-0.26718054211045,-0.125072206839241,0.0604778441854737,-0.0556808844874333,0.518984745544311,0.235502596790869,-0.515687822720374,0.844109065864328,-0.407196102687779,0.368366505439696,0.56921387797443,0.315654865736025,-0.617798115962637,0.00990377007759225,0.181779690589486,0.926322728381682,-0.327474286838656,0.36248846382745,-0.219320231201925,-0.240298463932618,1.23238041467065],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
### Reason 3: Multiple regression exists
- Regressing out the confounder beforehand can remove the effect of your covariate of interest
- Ordinary least-squares regression yields estimates for each covariate controlling for all other variables in the model
- So what if we just fit a model with both the confounder and the independent variable?
---
class: img-caption
![](jane_618_f2.gif)
Answer: Looks great, let's do this instead
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
### Reason 4: Even if you really like two-step &lt;br&gt; regression, there's a better way
- Lindquist et al. (2019) suggest that there is a correct way to use modular preprocessing pipelines
- In our earlier model, let's say you regress out the confounder `\(z_i\)` out of the outcome `\(y_i\)`, but also out of the covariate of interest `\(x_i\)`
    - Now you are isolating the effect of `\(x_i\)` independent of `\(z_i\)`
---
class: img-caption
![](hbm24528-fig-0003-ml.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Key Takeaways
- Avoid "residual" or "two-step" regression
    - Just use multiple regression instead
- When dealing with modular pipelines, do one of the following
    - Regress out all confounders simultaneously
    - For each new step, regress the confounders on all confounders from previous steps
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
