<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Why Everyone Should Stop Regressing on Residuals</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Chen" />
    <script src="Residual-Regression_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="Residual-Regression_files/plotly-binding-4.9.1/plotly.js"></script>
    <script src="Residual-Regression_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="Residual-Regression_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="Residual-Regression_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="Residual-Regression_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="Residual-Regression_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="Residual-Regression_files/plotly-main-1.49.4/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="PennSIVE-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Why Everyone Should Stop Regressing on Residuals
### Andrew Chen

---




&lt;style type="text/css"&gt;
.remark-slide-content.img-caption {
  background-image: none;
  text-align: center;
  padding-top: 61.5%;
}
.remark-slide-content.img-caption &gt; p:first-of-type {
  padding: 0px;
  margin: 0px;
}
.remark-slide-content.img-caption &gt; p:first-of-type &gt; img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 95%;
  height: 75%;
  margin: 2.5% 2.5% 2.5% 2.5%;
  object-fit: contain;
}

.remark-slide-content.just-img {
  background-image: none;
  text-align: center;
  padding-top: 0px;
}
&lt;/style&gt;

### Reason 1: It can reintroduce unwanted effects
- Recent paper by Lindquist et al. showed that motion artifacts removed from one preprocessing step can be reintroduced by another preprocessing step&lt;sup&gt;1&lt;/sup&gt;
- Let's dive into why this happens
.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0001-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0003-mr.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](https://onlinelibrary.wiley.com/cms/asset/0f891eac-2a43-4632-990f-5db53f241434/hbm24528-fig-0006-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Reason 2: You are not properly controlling for confounders
- Suppose we have `\(n\)` observations indexed by `\(i\)` with
    - Dependent variable `\(y_i\)`
    - Covariate of interest `\(x_i\)`
    - Confounder `\(z_i\)` that is correlated with `\(x_i\)`

`$$y_i=\beta_0+\beta_1x_i+\beta_2z_i+\epsilon_i$$`
- How can we get an estimate of `\(\beta_1\)`?
- What if we first regress out the confounder, then regress the residuals on the covariate of interest?
---
class: img-caption
![](jane_618_f1.gif)
Answer: We get very poor estimates, even with larger samples
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
class: just-img


<div id="htmlwidget-55c7bcea3f9edd9adc1a" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-55c7bcea3f9edd9adc1a">{"x":{"visdat":{"165a87beeaf2e":["function () ","plotlyVisDat"]},"cur_data":"165a87beeaf2e","attrs":{"165a87beeaf2e":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"165a87beeaf2e.1":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Covariate"},"yaxis":{"title":"Confounder"},"zaxis":{"title":"Outcome"},"camera":{"eye":{"x":1.5,"y":-1.5,"z":1.5}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.759745990186339,-0.877345388597236,0.541864623202878,2.13263425151311,0.816782979125644,-0.619036941231964,0.0782455543329084,1.25292230828753,-0.348223154487068,0.243157932746428,1.41816320790447,-0.588218399964505,0.491618994573117,-0.723723421829141,0.131844639842717,-0.0650034347746999,0.873251369139441,-0.432826427703476,-0.718621251887341,1.73374543961351,-0.595929045421818,0.826925450540042,-1.56015225223008,0.00666869602013864,0.328443033548356,0.673105831252296,0.429973984961015,0.228402231005057,0.00431609915554165,0.602771683343863,-0.681169343048084,1.33863923070666,-0.782312205444167,-1.15478287148854,0.359335297238153,1.35037310892054,2.127756059825,1.40597740890612,-1.1666630939391,0.20692273344218,0.97788923052991,-0.679505167675217,-1.76650698238628,-1.13566701843435,-0.454644931372892,0.407802000480397,-2.16723568321402,-0.821264986747658,1.53149437780988,1.1284302316551,0.815360748549405,0.238534163485341,-1.20697522397941,0.0193775030967689,-0.0862677027024911,0.515645565318373,-0.856847009915555,-0.889672049097834,-0.415108400329401,0.124216526352637,-0.653164978419203,-0.288001771817691,1.91270163269276,1.56311168261847,0.902724266200372,0.572917729626911,-0.563578070076086,0.630745281345714,0.0870248594958976,-0.488734715451391,-1.10534353114939,0.933058501561153,1.70943853450814,-1.16455988427404,0.176871934735216,-0.641929592881154,-0.593964699526236,-1.09171431874178,-0.0679766239302494,0.334978438174942,0.884471647330506,0.255795784820096,-1.27040443209487,-1.2233041886346,0.909064105575442,-0.151143532874638,0.206870390924343,1.62989551108527,0.188373588466568,-2.94108331218374,-1.5906349682932,-0.0486560064358421,-1.88997387272464,-1.45607229431,-1.00743186679391,0.929909132361995,-0.651827515221585,1.50343892466283,-0.397379090350403,1.41154066395658,-0.0297223818511161,-2.06604061515815,0.829408137778997,0.436064144998115,0.218361935870475,0.0199157821034227,1.42195605988517,2.06648289866438,0.130670896423147,-0.16857943782833,0.0814956243570686,-0.521470158538235,0.516818536787887,-0.354951514408848,0.414899445204482,0.352725498074909,0.0347578053008355,0.509075875288263,-0.249636284741977,0.200972983633006,0.18332719202897,-0.387793468048183,0.5280572440768,-1.40495069514956,1.20772708487456,-1.79747571454056,0.321520880856048,1.13814349501599,-0.000685029245977478,0.688405763997627,1.43230292917083,0.455083268292226,-1.40414546625015,-2.07438935984597,-1.19072040994058,0.750376921272247,-0.107086576851961,1.22312759571491,0.991458225439207,-1.1084551363287,-0.0868438365822131,0.799827251501465,0.364922898447301,-1.01960295901388,-1.9121319093819,0.884709804197515,-1.30721631994124,0.748681250500977,0.484817711833645,-0.0617529215709448,1.01989503846439,-0.638787363754721,-0.774783265827762,-0.71052096910558,0.567118264853243,-0.526957742555555,-2.2774494918294,0.874408236862927,-1.65294928633127,1.47562547118005,-1.2482027312526,-0.706369394758444,0.649015227426108,-0.806073342752956,0.599469103368482,1.26075700547144,-0.458716721514671,-0.863128441519912,0.247424808003691,-0.673474161742271,-0.619792203988168,0.670038545725163,1.52883513476786,0.496468262814718,0.525528050387377,1.21061405557215,-0.29230875294031,0.0882318316524303,-0.949208150245202,0.540073804746162,1.9050209409464,0.198448558791104,1.72624670723693,-0.106044616551279,0.0975767306617944,1.7760900845782,1.00243845543569,-0.449784707218736,-1.95126882038269,-0.781335361940959,1.78262347640951,-2.04740763149333,0.908774963949473,1.0496809227662,-1.33251594970384,0.29293977179343,0.985437103433911,0.0395869314028811,-1.58207063599405,-1.18813298718453],"y":[-1.54178257815049,0.325474867215444,1.0985320070872,3.20557798316318,0.411968658025176,-0.148402952521995,-0.00140877346807183,0.434425238492099,0.867609747969396,0.148062689471933,1.79321497195194,-0.794249903538402,0.105781168802786,-0.478956396057121,-1.72406446503882,0.178705578351037,0.286190911216975,0.703394559440125,-0.486765770324378,1.59162813950625,0.568999471500046,1.63285857149632,-0.0862908544085286,-0.469369057833547,-0.076819623174652,-0.545256738409852,-0.53479923897585,0.211370184448945,1.98511625938982,0.495557327489748,-1.72318352270133,1.50928443509014,-1.2162174774157,-0.123825440368555,1.65189755770919,-1.19676918188795,0.0555004418310852,1.54881882621974,-0.20989579379328,-0.776325717636181,0.166848861516368,0.33805994692514,-1.95867260102042,0.0446549177982851,0.159505939341279,1.12557523819516,-0.404072604944892,0.245742497763005,0.967574436095903,0.418857242395379,0.776598866815199,0.241325846653827,-2.12832877816686,0.562417289669292,-1.3625626457771,0.877470321359131,-0.75268934963411,-0.575927533274252,-0.0784000988605105,1.00781517089037,-0.230586252846659,0.842117497804842,0.797149066190432,1.54299111879977,0.638522023661299,-0.763921537811661,-1.05291335087661,-0.263784334683646,-0.546705787755257,0.321063800994995,-0.939783850372331,0.751308827113378,0.0236997657893275,-0.806429812169952,1.33514249974252,0.630546113948213,0.610400122927933,-1.01878969019937,-0.0106710958755444,0.014140364728415,0.91476038270438,-1.70094390803891,0.697418027243629,0.346075102244274,1.92270235046339,0.356720252829513,0.464655592152266,0.620894546799758,-0.948754673397301,-2.87228966116377,-0.306154880920766,-0.495223796480582,-1.23321605024994,0.710777672781824,-0.760243074515001,0.248012481007769,0.77341584943299,1.20913758825079,-1.24042684930657,0.0351496409985001,-1.71959929382337,0.731605200881881,-0.620627769829452,-0.83825380069352,0.719754988096461,-0.223288867918461,-0.173470614605991,0.926946382611517,-1.4372056870122,0.826866580443361,0.61826676368561,0.676728608541282,2.18298492694429,-0.0894713875753071,0.33064461588744,0.732093301654495,1.19630769065774,0.582717700807285,2.35394053208059,-0.273918449829905,0.620732204902588,-1.51778239516232,0.346183643445973,0.653110232680882,0.83204060248866,-0.750924849103666,0.160794701630501,0.351261871447671,-0.172365233623729,0.250240662224321,2.02578160411646,-0.272864304612097,-1.18240766122491,-0.253413112405365,-0.643339575796738,-0.249496015613811,-1.04080113647162,1.50014381516643,0.737557917785654,-0.31407029450433,0.448328418795697,-0.25850339849039,0.186785669126745,-0.307265779693203,-2.16568452915493,-0.00708794568286447,0.768384578396147,0.376447945892235,-1.78841006468408,-0.466305726633409,1.26253478992331,0.771620653489315,-0.10256781857447,-0.897670827830441,-0.288402787057631,0.547749633557575,-0.0627122944175482,0.256570708618938,-1.86791366920094,1.79855073377135,-0.725509882962832,-0.690107888283859,0.287570140479897,0.883337031442075,1.00465450521543,1.0584175207787,-0.741206264495754,1.20975148038712,0.000676860705900589,-0.281202001581658,-0.451337575334032,-0.384666520154543,-0.20122736135484,-0.869528441263542,-0.317906717697245,0.812566266687343,0.148736394145832,0.874841472077878,-0.54004510283731,1.48365587236576,1.79601765631403,0.0536468429347834,1.50907706907622,-0.752781855643837,-1.05625968058011,1.14614930646674,-0.299462099296889,-0.989718954874203,-1.60958128365369,0.489842256485965,1.37329316994088,-2.24483323975109,-0.620282662197842,1.0156150131287,-0.476820103709998,0.388103043962426,0.971214367055844,1.03982145126237,0.663655488467313,-0.033416708497072],"z":[-2.23320882064607,-1.00844818777754,0.526138818392761,3.11460974146312,0.237987323195284,-1.15934674843806,-0.568353076204904,0.559004459935448,-0.25856820737266,-0.348284387257437,1.62582590308919,-1.58986663526233,-0.203958708447158,-1.46401469533067,-1.73669270044756,-0.542547322306854,0.189470773439201,-0.432741130594636,-1.46590973835849,1.70562268257354,-0.64098952455553,1.09970999261516,-1.77464899745732,-0.946029076079676,-0.446002435548697,-0.532644457820579,-0.695516500620674,-0.314298131992488,0.770463828171466,0.146691484773238,-2.30518582883488,1.37140774324747,-2.0211096008122,-1.51716464111025,0.785724175652849,-0.514616073887474,0.906140728348969,1.44621854177782,-1.58573004422296,-1.02072091174609,0.179177841622104,-0.861150477335344,-3.22976453119498,-1.38584729325553,-0.828736117232419,0.451225244262602,-2.42205462452153,-1.02500456509955,1.12720934692376,0.460962409025043,0.492232907944933,-0.286236815712873,-2.95685162431268,-0.214882467874047,-1.636320066746,0.353042297863963,-1.74881427449505,-1.64805853047075,-0.967594772243228,0.170283365259813,-1.24076468469639,-0.234257814619284,1.27475666640795,1.55213313818248,0.45673358009288,-0.755841488539615,-1.75368281747718,-0.365266160146843,-0.943915472591842,-0.739508462929767,-2.0537279898755,0.556918307261882,0.591057987397938,-2.00183161032108,0.436271281324123,-0.630107258063349,-0.610634026429102,-2.09949162906909,-0.677192226674346,-0.37775566077794,0.63732359821413,-1.63374250906346,-1.02322930620616,-1.23619918328352,1.36009769641689,-0.478235118841877,-0.152070634656664,0.953414217709231,-1.1544055822618,-4.69149990415355,-1.94989171726007,-1.00285468485179,-2.80837176889249,-1.14384505788001,-1.85951128172652,0.202406306548545,-0.537026988862306,1.27666473622925,-1.76860298057017,0.390544390658267,-1.84666399578243,-1.55624361280368,-0.475992565245609,-0.903671581797073,0.0345430239665656,-0.764499982880817,0.251800988885136,1.47326167408284,-1.53671317622263,-0.161337822979768,-0.132305151180415,-0.513457907808156,1.26772360180223,-0.933234854199199,-0.100257980045945,0.137234337000293,0.239607024360715,0.142116680456594,0.850874150326741,-0.673200649148119,-0.0592972449581995,-1.95604192705764,-0.0101702015443492,-1.14842714653836,0.805698558343963,-2.40601921736125,-0.284517915069706,0.420444933714273,-0.743274006819084,0.0349136755450736,1.79852035049081,-0.4945855482342,-2.43272601204283,-2.25160055338622,-1.90598081282641,-0.271522188849385,-1.4256602221368,1.28415116480664,0.588172477447112,-1.61790662439341,-0.369099615260852,-0.243212125702538,-0.235942825508458,-1.55094693990524,-3.47661032978607,-0.00780352185003452,-0.999321041891858,0.165451614664959,-1.53465346980559,-0.991779876553338,0.975562057061096,-0.529155519996074,-1.23628458189185,-1.7478730806655,-0.427037988353362,-0.607584499108876,-2.26025207318315,0.169546439027015,-3.08674289168284,1.6697845206557,-2.00373765276109,-1.5996729209399,0.0334709347239139,-0.568054240727907,0.500747703198446,1.00128334556481,-1.46208491301759,-0.379502695603243,-0.448467654713576,-1.29041213713704,-1.37192966833583,-0.422378404910856,0.307186618578822,-0.883280947724466,-0.476803889927197,0.794087402771353,-0.722639473966425,0.0520124898009258,-1.66461609996805,0.794471951168054,1.96858819527201,-0.445672041602169,1.64258782060892,-1.22331735334687,-1.29321688775311,1.42342875092117,-0.130055373513132,-1.62979138627535,-3.11473389563576,-0.826183996628786,1.58700282963498,-3.62670743268138,-0.420194211584148,0.823568332316146,-1.88867406019997,-0.145408851781191,0.747517206532538,0.133447045055384,-1.26502942607901,-1.47722360978741],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[-0.759745990186339,-0.877345388597236,0.541864623202878,2.13263425151311,0.816782979125644,-0.619036941231964,0.0782455543329084,1.25292230828753,-0.348223154487068,0.243157932746428,1.41816320790447,-0.588218399964505,0.491618994573117,-0.723723421829141,0.131844639842717,-0.0650034347746999,0.873251369139441,-0.432826427703476,-0.718621251887341,1.73374543961351,-0.595929045421818,0.826925450540042,-1.56015225223008,0.00666869602013864,0.328443033548356,0.673105831252296,0.429973984961015,0.228402231005057,0.00431609915554165,0.602771683343863,-0.681169343048084,1.33863923070666,-0.782312205444167,-1.15478287148854,0.359335297238153,1.35037310892054,2.127756059825,1.40597740890612,-1.1666630939391,0.20692273344218,0.97788923052991,-0.679505167675217,-1.76650698238628,-1.13566701843435,-0.454644931372892,0.407802000480397,-2.16723568321402,-0.821264986747658,1.53149437780988,1.1284302316551,0.815360748549405,0.238534163485341,-1.20697522397941,0.0193775030967689,-0.0862677027024911,0.515645565318373,-0.856847009915555,-0.889672049097834,-0.415108400329401,0.124216526352637,-0.653164978419203,-0.288001771817691,1.91270163269276,1.56311168261847,0.902724266200372,0.572917729626911,-0.563578070076086,0.630745281345714,0.0870248594958976,-0.488734715451391,-1.10534353114939,0.933058501561153,1.70943853450814,-1.16455988427404,0.176871934735216,-0.641929592881154,-0.593964699526236,-1.09171431874178,-0.0679766239302494,0.334978438174942,0.884471647330506,0.255795784820096,-1.27040443209487,-1.2233041886346,0.909064105575442,-0.151143532874638,0.206870390924343,1.62989551108527,0.188373588466568,-2.94108331218374,-1.5906349682932,-0.0486560064358421,-1.88997387272464,-1.45607229431,-1.00743186679391,0.929909132361995,-0.651827515221585,1.50343892466283,-0.397379090350403,1.41154066395658,-0.0297223818511161,-2.06604061515815,0.829408137778997,0.436064144998115,0.218361935870475,0.0199157821034227,1.42195605988517,2.06648289866438,0.130670896423147,-0.16857943782833,0.0814956243570686,-0.521470158538235,0.516818536787887,-0.354951514408848,0.414899445204482,0.352725498074909,0.0347578053008355,0.509075875288263,-0.249636284741977,0.200972983633006,0.18332719202897,-0.387793468048183,0.5280572440768,-1.40495069514956,1.20772708487456,-1.79747571454056,0.321520880856048,1.13814349501599,-0.000685029245977478,0.688405763997627,1.43230292917083,0.455083268292226,-1.40414546625015,-2.07438935984597,-1.19072040994058,0.750376921272247,-0.107086576851961,1.22312759571491,0.991458225439207,-1.1084551363287,-0.0868438365822131,0.799827251501465,0.364922898447301,-1.01960295901388,-1.9121319093819,0.884709804197515,-1.30721631994124,0.748681250500977,0.484817711833645,-0.0617529215709448,1.01989503846439,-0.638787363754721,-0.774783265827762,-0.71052096910558,0.567118264853243,-0.526957742555555,-2.2774494918294,0.874408236862927,-1.65294928633127,1.47562547118005,-1.2482027312526,-0.706369394758444,0.649015227426108,-0.806073342752956,0.599469103368482,1.26075700547144,-0.458716721514671,-0.863128441519912,0.247424808003691,-0.673474161742271,-0.619792203988168,0.670038545725163,1.52883513476786,0.496468262814718,0.525528050387377,1.21061405557215,-0.29230875294031,0.0882318316524303,-0.949208150245202,0.540073804746162,1.9050209409464,0.198448558791104,1.72624670723693,-0.106044616551279,0.0975767306617944,1.7760900845782,1.00243845543569,-0.449784707218736,-1.95126882038269,-0.781335361940959,1.78262347640951,-2.04740763149333,0.908774963949473,1.0496809227662,-1.33251594970384,0.29293977179343,0.985437103433911,0.0395869314028811,-1.58207063599405,-1.18813298718453],"y":[-1.54178257815049,0.325474867215444,1.0985320070872,3.20557798316318,0.411968658025176,-0.148402952521995,-0.00140877346807183,0.434425238492099,0.867609747969396,0.148062689471933,1.79321497195194,-0.794249903538402,0.105781168802786,-0.478956396057121,-1.72406446503882,0.178705578351037,0.286190911216975,0.703394559440125,-0.486765770324378,1.59162813950625,0.568999471500046,1.63285857149632,-0.0862908544085286,-0.469369057833547,-0.076819623174652,-0.545256738409852,-0.53479923897585,0.211370184448945,1.98511625938982,0.495557327489748,-1.72318352270133,1.50928443509014,-1.2162174774157,-0.123825440368555,1.65189755770919,-1.19676918188795,0.0555004418310852,1.54881882621974,-0.20989579379328,-0.776325717636181,0.166848861516368,0.33805994692514,-1.95867260102042,0.0446549177982851,0.159505939341279,1.12557523819516,-0.404072604944892,0.245742497763005,0.967574436095903,0.418857242395379,0.776598866815199,0.241325846653827,-2.12832877816686,0.562417289669292,-1.3625626457771,0.877470321359131,-0.75268934963411,-0.575927533274252,-0.0784000988605105,1.00781517089037,-0.230586252846659,0.842117497804842,0.797149066190432,1.54299111879977,0.638522023661299,-0.763921537811661,-1.05291335087661,-0.263784334683646,-0.546705787755257,0.321063800994995,-0.939783850372331,0.751308827113378,0.0236997657893275,-0.806429812169952,1.33514249974252,0.630546113948213,0.610400122927933,-1.01878969019937,-0.0106710958755444,0.014140364728415,0.91476038270438,-1.70094390803891,0.697418027243629,0.346075102244274,1.92270235046339,0.356720252829513,0.464655592152266,0.620894546799758,-0.948754673397301,-2.87228966116377,-0.306154880920766,-0.495223796480582,-1.23321605024994,0.710777672781824,-0.760243074515001,0.248012481007769,0.77341584943299,1.20913758825079,-1.24042684930657,0.0351496409985001,-1.71959929382337,0.731605200881881,-0.620627769829452,-0.83825380069352,0.719754988096461,-0.223288867918461,-0.173470614605991,0.926946382611517,-1.4372056870122,0.826866580443361,0.61826676368561,0.676728608541282,2.18298492694429,-0.0894713875753071,0.33064461588744,0.732093301654495,1.19630769065774,0.582717700807285,2.35394053208059,-0.273918449829905,0.620732204902588,-1.51778239516232,0.346183643445973,0.653110232680882,0.83204060248866,-0.750924849103666,0.160794701630501,0.351261871447671,-0.172365233623729,0.250240662224321,2.02578160411646,-0.272864304612097,-1.18240766122491,-0.253413112405365,-0.643339575796738,-0.249496015613811,-1.04080113647162,1.50014381516643,0.737557917785654,-0.31407029450433,0.448328418795697,-0.25850339849039,0.186785669126745,-0.307265779693203,-2.16568452915493,-0.00708794568286447,0.768384578396147,0.376447945892235,-1.78841006468408,-0.466305726633409,1.26253478992331,0.771620653489315,-0.10256781857447,-0.897670827830441,-0.288402787057631,0.547749633557575,-0.0627122944175482,0.256570708618938,-1.86791366920094,1.79855073377135,-0.725509882962832,-0.690107888283859,0.287570140479897,0.883337031442075,1.00465450521543,1.0584175207787,-0.741206264495754,1.20975148038712,0.000676860705900589,-0.281202001581658,-0.451337575334032,-0.384666520154543,-0.20122736135484,-0.869528441263542,-0.317906717697245,0.812566266687343,0.148736394145832,0.874841472077878,-0.54004510283731,1.48365587236576,1.79601765631403,0.0536468429347834,1.50907706907622,-0.752781855643837,-1.05625968058011,1.14614930646674,-0.299462099296889,-0.989718954874203,-1.60958128365369,0.489842256485965,1.37329316994088,-2.24483323975109,-0.620282662197842,1.0156150131287,-0.476820103709998,0.388103043962426,0.971214367055844,1.03982145126237,0.663655488467313,-0.033416708497072],"z":[-2.23320882064607,-1.00844818777754,0.526138818392761,3.11460974146312,0.237987323195284,-1.15934674843806,-0.568353076204904,0.559004459935448,-0.25856820737266,-0.348284387257437,1.62582590308919,-1.58986663526233,-0.203958708447158,-1.46401469533067,-1.73669270044756,-0.542547322306854,0.189470773439201,-0.432741130594636,-1.46590973835849,1.70562268257354,-0.64098952455553,1.09970999261516,-1.77464899745732,-0.946029076079676,-0.446002435548697,-0.532644457820579,-0.695516500620674,-0.314298131992488,0.770463828171466,0.146691484773238,-2.30518582883488,1.37140774324747,-2.0211096008122,-1.51716464111025,0.785724175652849,-0.514616073887474,0.906140728348969,1.44621854177782,-1.58573004422296,-1.02072091174609,0.179177841622104,-0.861150477335344,-3.22976453119498,-1.38584729325553,-0.828736117232419,0.451225244262602,-2.42205462452153,-1.02500456509955,1.12720934692376,0.460962409025043,0.492232907944933,-0.286236815712873,-2.95685162431268,-0.214882467874047,-1.636320066746,0.353042297863963,-1.74881427449505,-1.64805853047075,-0.967594772243228,0.170283365259813,-1.24076468469639,-0.234257814619284,1.27475666640795,1.55213313818248,0.45673358009288,-0.755841488539615,-1.75368281747718,-0.365266160146843,-0.943915472591842,-0.739508462929767,-2.0537279898755,0.556918307261882,0.591057987397938,-2.00183161032108,0.436271281324123,-0.630107258063349,-0.610634026429102,-2.09949162906909,-0.677192226674346,-0.37775566077794,0.63732359821413,-1.63374250906346,-1.02322930620616,-1.23619918328352,1.36009769641689,-0.478235118841877,-0.152070634656664,0.953414217709231,-1.1544055822618,-4.69149990415355,-1.94989171726007,-1.00285468485179,-2.80837176889249,-1.14384505788001,-1.85951128172652,0.202406306548545,-0.537026988862306,1.27666473622925,-1.76860298057017,0.390544390658267,-1.84666399578243,-1.55624361280368,-0.475992565245609,-0.903671581797073,0.0345430239665656,-0.764499982880817,0.251800988885136,1.47326167408284,-1.53671317622263,-0.161337822979768,-0.132305151180415,-0.513457907808156,1.26772360180223,-0.933234854199199,-0.100257980045945,0.137234337000293,0.239607024360715,0.142116680456594,0.850874150326741,-0.673200649148119,-0.0592972449581995,-1.95604192705764,-0.0101702015443492,-1.14842714653836,0.805698558343963,-2.40601921736125,-0.284517915069706,0.420444933714273,-0.743274006819084,0.0349136755450736,1.79852035049081,-0.4945855482342,-2.43272601204283,-2.25160055338622,-1.90598081282641,-0.271522188849385,-1.4256602221368,1.28415116480664,0.588172477447112,-1.61790662439341,-0.369099615260852,-0.243212125702538,-0.235942825508458,-1.55094693990524,-3.47661032978607,-0.00780352185003452,-0.999321041891858,0.165451614664959,-1.53465346980559,-0.991779876553338,0.975562057061096,-0.529155519996074,-1.23628458189185,-1.7478730806655,-0.427037988353362,-0.607584499108876,-2.26025207318315,0.169546439027015,-3.08674289168284,1.6697845206557,-2.00373765276109,-1.5996729209399,0.0334709347239139,-0.568054240727907,0.500747703198446,1.00128334556481,-1.46208491301759,-0.379502695603243,-0.448467654713576,-1.29041213713704,-1.37192966833583,-0.422378404910856,0.307186618578822,-0.883280947724466,-0.476803889927197,0.794087402771353,-0.722639473966425,0.0520124898009258,-1.66461609996805,0.794471951168054,1.96858819527201,-0.445672041602169,1.64258782060892,-1.22331735334687,-1.29321688775311,1.42342875092117,-0.130055373513132,-1.62979138627535,-3.11473389563576,-0.826183996628786,1.58700282963498,-3.62670743268138,-0.420194211584148,0.823568332316146,-1.88867406019997,-0.145408851781191,0.747517206532538,0.133447045055384,-1.26502942607901,-1.47722360978741],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
class: just-img
<div id="htmlwidget-0e245d882d0ca5bf6f66" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-0e245d882d0ca5bf6f66">{"x":{"visdat":{"165a820249852":["function () ","plotlyVisDat"]},"cur_data":"165a820249852","attrs":{"165a820249852":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"165a820249852.1":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Covariates"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.759745990186339,-0.877345388597236,0.541864623202878,2.13263425151311,0.816782979125644,-0.619036941231964,0.0782455543329084,1.25292230828753,-0.348223154487068,0.243157932746428,1.41816320790447,-0.588218399964505,0.491618994573117,-0.723723421829141,0.131844639842717,-0.0650034347746999,0.873251369139441,-0.432826427703476,-0.718621251887341,1.73374543961351,-0.595929045421818,0.826925450540042,-1.56015225223008,0.00666869602013864,0.328443033548356,0.673105831252296,0.429973984961015,0.228402231005057,0.00431609915554165,0.602771683343863,-0.681169343048084,1.33863923070666,-0.782312205444167,-1.15478287148854,0.359335297238153,1.35037310892054,2.127756059825,1.40597740890612,-1.1666630939391,0.20692273344218,0.97788923052991,-0.679505167675217,-1.76650698238628,-1.13566701843435,-0.454644931372892,0.407802000480397,-2.16723568321402,-0.821264986747658,1.53149437780988,1.1284302316551,0.815360748549405,0.238534163485341,-1.20697522397941,0.0193775030967689,-0.0862677027024911,0.515645565318373,-0.856847009915555,-0.889672049097834,-0.415108400329401,0.124216526352637,-0.653164978419203,-0.288001771817691,1.91270163269276,1.56311168261847,0.902724266200372,0.572917729626911,-0.563578070076086,0.630745281345714,0.0870248594958976,-0.488734715451391,-1.10534353114939,0.933058501561153,1.70943853450814,-1.16455988427404,0.176871934735216,-0.641929592881154,-0.593964699526236,-1.09171431874178,-0.0679766239302494,0.334978438174942,0.884471647330506,0.255795784820096,-1.27040443209487,-1.2233041886346,0.909064105575442,-0.151143532874638,0.206870390924343,1.62989551108527,0.188373588466568,-2.94108331218374,-1.5906349682932,-0.0486560064358421,-1.88997387272464,-1.45607229431,-1.00743186679391,0.929909132361995,-0.651827515221585,1.50343892466283,-0.397379090350403,1.41154066395658,-0.0297223818511161,-2.06604061515815,0.829408137778997,0.436064144998115,0.218361935870475,0.0199157821034227,1.42195605988517,2.06648289866438,0.130670896423147,-0.16857943782833,0.0814956243570686,-0.521470158538235,0.516818536787887,-0.354951514408848,0.414899445204482,0.352725498074909,0.0347578053008355,0.509075875288263,-0.249636284741977,0.200972983633006,0.18332719202897,-0.387793468048183,0.5280572440768,-1.40495069514956,1.20772708487456,-1.79747571454056,0.321520880856048,1.13814349501599,-0.000685029245977478,0.688405763997627,1.43230292917083,0.455083268292226,-1.40414546625015,-2.07438935984597,-1.19072040994058,0.750376921272247,-0.107086576851961,1.22312759571491,0.991458225439207,-1.1084551363287,-0.0868438365822131,0.799827251501465,0.364922898447301,-1.01960295901388,-1.9121319093819,0.884709804197515,-1.30721631994124,0.748681250500977,0.484817711833645,-0.0617529215709448,1.01989503846439,-0.638787363754721,-0.774783265827762,-0.71052096910558,0.567118264853243,-0.526957742555555,-2.2774494918294,0.874408236862927,-1.65294928633127,1.47562547118005,-1.2482027312526,-0.706369394758444,0.649015227426108,-0.806073342752956,0.599469103368482,1.26075700547144,-0.458716721514671,-0.863128441519912,0.247424808003691,-0.673474161742271,-0.619792203988168,0.670038545725163,1.52883513476786,0.496468262814718,0.525528050387377,1.21061405557215,-0.29230875294031,0.0882318316524303,-0.949208150245202,0.540073804746162,1.9050209409464,0.198448558791104,1.72624670723693,-0.106044616551279,0.0975767306617944,1.7760900845782,1.00243845543569,-0.449784707218736,-1.95126882038269,-0.781335361940959,1.78262347640951,-2.04740763149333,0.908774963949473,1.0496809227662,-1.33251594970384,0.29293977179343,0.985437103433911,0.0395869314028811,-1.58207063599405,-1.18813298718453],"y":[0.0538997786857191,-0.712488497307085,-0.00225053007792469,0.339373121558912,0.441714409307145,-0.358067715931789,0.0761787975426423,0.738784984310769,-0.540713736912374,0.136858677476379,0.356661772368854,-0.0998890759411163,0.326271231668681,-0.310250187375493,0.744792084708869,-0.0900802846026319,0.527320887919605,-0.539775887771389,-0.303817708620108,0.65142055533119,-0.604712156576574,0.00154181780253549,-1.03960316524844,0.197511979244411,0.278943754651147,0.691819382281006,0.517795990940779,0.103337021682219,-0.703334130647574,0.261283841011289,0.175359563963836,0.405012778111573,-0.0811671604373257,-0.742093824631343,-0.332746211218251,1.40458768767511,1.4899874929123,0.437666101273132,-0.718878155598761,0.45014320219028,0.644288282541357,-0.578610879415104,-0.498105494422051,-0.790435410343078,-0.35579555545165,-0.106001638232302,-1.34814240438802,-0.644022308067552,0.738466529376581,0.657343857133763,0.307136779469022,0.0994551347032283,-0.0442798200769253,-0.17158619406464,0.45967746020683,0.0603819515300022,-0.303154788058534,-0.390888905808113,-0.240963242699745,-0.261370136819179,-0.351849536894831,-0.489219697776683,1.06774684458224,0.549795070151841,0.418875614339102,0.701795435335627,0.0121203609668692,0.559049743233473,0.282093560450411,-0.438845034518106,-0.408560389588153,0.398790198157007,1.20881538466955,-0.498866012397094,-0.344427530656807,-0.659460117056512,-0.618504219420578,-0.370076196670704,-0.0227834807253085,0.250195398347335,0.304899016293247,0.823087683360248,-1.12389099169354,-0.962206541653454,-0.047145226316972,-0.215593927449736,-0.0045262306161784,0.93435330182447,0.500328050027228,-0.98560583785312,-0.980394006134238,0.168256556240578,-0.850302910098412,-1.25875279374581,-0.405796885083727,0.580967968245836,-0.718728908573272,0.630331189547204,0.197155109673633,0.996092220049493,0.630059356602324,-1.69336077134637,0.828843131100726,0.633229508086837,-0.0899376669502899,0.116633602676406,1.07981090851687,1.12784255813094,0.638879915058102,-0.400036899131732,-0.148563932044402,-0.592057443495901,-0.417071497489692,-0.194797462267074,0.190188951885042,-0.000403307522097176,-0.393045368361223,0.163765622460113,-1.01621936072178,0.261921762122057,-0.0781850476537669,0.305474090871964,0.263706697237365,-1.20184124063624,0.561482166743351,-0.962241305056137,0.187048375781077,0.688906666970942,0.0835571904344523,0.411099317476535,0.281358924581654,0.439412775885901,-0.528836649825,-1.33834399695038,-0.576926395177205,0.637557373663221,0.327227103404241,0.327503294498294,0.444707642638827,-0.639968316520082,-0.204144739250149,0.675472454388607,0.207908012018612,-0.580264622508823,-0.524204241850347,0.642784333940473,-1.17565786861039,0.407056191843202,1.01544620872917,0.148494597297599,0.272288434916862,-0.70894313353929,-0.483881818254462,-0.147612677878558,0.523529787635077,-0.548647378594115,-1.55034922493456,0.538982039606138,-0.451864589944741,0.39493060337109,-0.587060975063801,-0.220747140019858,0.369850308868671,-0.866970550003266,0.0724645751541385,0.515670056625127,-0.0286704078504379,-1.02649086581374,0.193840204225464,-0.347522914622313,-0.247616474061736,0.630840147806054,1.16479492923032,0.686969837243308,0.505225385623598,0.57063745801385,-0.238214813826286,-0.237844584605579,-0.445709684478374,-0.144594010765319,0.696435423685192,0.140151307084041,0.67641398010336,0.222440776820212,0.47615464745628,0.844262722492504,0.832305493756107,0.0686244841364707,-0.755328185469064,-0.705497377694667,0.765622072308848,-0.589901162471678,0.884273479436609,0.383597472927535,-0.737187586367266,0.0837673182362047,0.354892950688137,-0.33233633579184,-1.32968844765323,-0.798560092829085],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.759745990186339,-0.877345388597236,0.541864623202878,2.13263425151311,0.816782979125644,-0.619036941231964,0.0782455543329084,1.25292230828753,-0.348223154487068,0.243157932746428,1.41816320790447,-0.588218399964505,0.491618994573117,-0.723723421829141,0.131844639842717,-0.0650034347746999,0.873251369139441,-0.432826427703476,-0.718621251887341,1.73374543961351,-0.595929045421818,0.826925450540042,-1.56015225223008,0.00666869602013864,0.328443033548356,0.673105831252296,0.429973984961015,0.228402231005057,0.00431609915554165,0.602771683343863,-0.681169343048084,1.33863923070666,-0.782312205444167,-1.15478287148854,0.359335297238153,1.35037310892054,2.127756059825,1.40597740890612,-1.1666630939391,0.20692273344218,0.97788923052991,-0.679505167675217,-1.76650698238628,-1.13566701843435,-0.454644931372892,0.407802000480397,-2.16723568321402,-0.821264986747658,1.53149437780988,1.1284302316551,0.815360748549405,0.238534163485341,-1.20697522397941,0.0193775030967689,-0.0862677027024911,0.515645565318373,-0.856847009915555,-0.889672049097834,-0.415108400329401,0.124216526352637,-0.653164978419203,-0.288001771817691,1.91270163269276,1.56311168261847,0.902724266200372,0.572917729626911,-0.563578070076086,0.630745281345714,0.0870248594958976,-0.488734715451391,-1.10534353114939,0.933058501561153,1.70943853450814,-1.16455988427404,0.176871934735216,-0.641929592881154,-0.593964699526236,-1.09171431874178,-0.0679766239302494,0.334978438174942,0.884471647330506,0.255795784820096,-1.27040443209487,-1.2233041886346,0.909064105575442,-0.151143532874638,0.206870390924343,1.62989551108527,0.188373588466568,-2.94108331218374,-1.5906349682932,-0.0486560064358421,-1.88997387272464,-1.45607229431,-1.00743186679391,0.929909132361995,-0.651827515221585,1.50343892466283,-0.397379090350403,1.41154066395658,-0.0297223818511161,-2.06604061515815,0.829408137778997,0.436064144998115,0.218361935870475,0.0199157821034227,1.42195605988517,2.06648289866438,0.130670896423147,-0.16857943782833,0.0814956243570686,-0.521470158538235,0.516818536787887,-0.354951514408848,0.414899445204482,0.352725498074909,0.0347578053008355,0.509075875288263,-0.249636284741977,0.200972983633006,0.18332719202897,-0.387793468048183,0.5280572440768,-1.40495069514956,1.20772708487456,-1.79747571454056,0.321520880856048,1.13814349501599,-0.000685029245977478,0.688405763997627,1.43230292917083,0.455083268292226,-1.40414546625015,-2.07438935984597,-1.19072040994058,0.750376921272247,-0.107086576851961,1.22312759571491,0.991458225439207,-1.1084551363287,-0.0868438365822131,0.799827251501465,0.364922898447301,-1.01960295901388,-1.9121319093819,0.884709804197515,-1.30721631994124,0.748681250500977,0.484817711833645,-0.0617529215709448,1.01989503846439,-0.638787363754721,-0.774783265827762,-0.71052096910558,0.567118264853243,-0.526957742555555,-2.2774494918294,0.874408236862927,-1.65294928633127,1.47562547118005,-1.2482027312526,-0.706369394758444,0.649015227426108,-0.806073342752956,0.599469103368482,1.26075700547144,-0.458716721514671,-0.863128441519912,0.247424808003691,-0.673474161742271,-0.619792203988168,0.670038545725163,1.52883513476786,0.496468262814718,0.525528050387377,1.21061405557215,-0.29230875294031,0.0882318316524303,-0.949208150245202,0.540073804746162,1.9050209409464,0.198448558791104,1.72624670723693,-0.106044616551279,0.0975767306617944,1.7760900845782,1.00243845543569,-0.449784707218736,-1.95126882038269,-0.781335361940959,1.78262347640951,-2.04740763149333,0.908774963949473,1.0496809227662,-1.33251594970384,0.29293977179343,0.985437103433911,0.0395869314028811,-1.58207063599405,-1.18813298718453],"y":[0.0538997786857191,-0.712488497307085,-0.00225053007792469,0.339373121558912,0.441714409307145,-0.358067715931789,0.0761787975426423,0.738784984310769,-0.540713736912374,0.136858677476379,0.356661772368854,-0.0998890759411163,0.326271231668681,-0.310250187375493,0.744792084708869,-0.0900802846026319,0.527320887919605,-0.539775887771389,-0.303817708620108,0.65142055533119,-0.604712156576574,0.00154181780253549,-1.03960316524844,0.197511979244411,0.278943754651147,0.691819382281006,0.517795990940779,0.103337021682219,-0.703334130647574,0.261283841011289,0.175359563963836,0.405012778111573,-0.0811671604373257,-0.742093824631343,-0.332746211218251,1.40458768767511,1.4899874929123,0.437666101273132,-0.718878155598761,0.45014320219028,0.644288282541357,-0.578610879415104,-0.498105494422051,-0.790435410343078,-0.35579555545165,-0.106001638232302,-1.34814240438802,-0.644022308067552,0.738466529376581,0.657343857133763,0.307136779469022,0.0994551347032283,-0.0442798200769253,-0.17158619406464,0.45967746020683,0.0603819515300022,-0.303154788058534,-0.390888905808113,-0.240963242699745,-0.261370136819179,-0.351849536894831,-0.489219697776683,1.06774684458224,0.549795070151841,0.418875614339102,0.701795435335627,0.0121203609668692,0.559049743233473,0.282093560450411,-0.438845034518106,-0.408560389588153,0.398790198157007,1.20881538466955,-0.498866012397094,-0.344427530656807,-0.659460117056512,-0.618504219420578,-0.370076196670704,-0.0227834807253085,0.250195398347335,0.304899016293247,0.823087683360248,-1.12389099169354,-0.962206541653454,-0.047145226316972,-0.215593927449736,-0.0045262306161784,0.93435330182447,0.500328050027228,-0.98560583785312,-0.980394006134238,0.168256556240578,-0.850302910098412,-1.25875279374581,-0.405796885083727,0.580967968245836,-0.718728908573272,0.630331189547204,0.197155109673633,0.996092220049493,0.630059356602324,-1.69336077134637,0.828843131100726,0.633229508086837,-0.0899376669502899,0.116633602676406,1.07981090851687,1.12784255813094,0.638879915058102,-0.400036899131732,-0.148563932044402,-0.592057443495901,-0.417071497489692,-0.194797462267074,0.190188951885042,-0.000403307522097176,-0.393045368361223,0.163765622460113,-1.01621936072178,0.261921762122057,-0.0781850476537669,0.305474090871964,0.263706697237365,-1.20184124063624,0.561482166743351,-0.962241305056137,0.187048375781077,0.688906666970942,0.0835571904344523,0.411099317476535,0.281358924581654,0.439412775885901,-0.528836649825,-1.33834399695038,-0.576926395177205,0.637557373663221,0.327227103404241,0.327503294498294,0.444707642638827,-0.639968316520082,-0.204144739250149,0.675472454388607,0.207908012018612,-0.580264622508823,-0.524204241850347,0.642784333940473,-1.17565786861039,0.407056191843202,1.01544620872917,0.148494597297599,0.272288434916862,-0.70894313353929,-0.483881818254462,-0.147612677878558,0.523529787635077,-0.548647378594115,-1.55034922493456,0.538982039606138,-0.451864589944741,0.39493060337109,-0.587060975063801,-0.220747140019858,0.369850308868671,-0.866970550003266,0.0724645751541385,0.515670056625127,-0.0286704078504379,-1.02649086581374,0.193840204225464,-0.347522914622313,-0.247616474061736,0.630840147806054,1.16479492923032,0.686969837243308,0.505225385623598,0.57063745801385,-0.238214813826286,-0.237844584605579,-0.445709684478374,-0.144594010765319,0.696435423685192,0.140151307084041,0.67641398010336,0.222440776820212,0.47615464745628,0.844262722492504,0.832305493756107,0.0686244841364707,-0.755328185469064,-0.705497377694667,0.765622072308848,-0.589901162471678,0.884273479436609,0.383597472927535,-0.737187586367266,0.0837673182362047,0.354892950688137,-0.33233633579184,-1.32968844765323,-0.798560092829085],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
### Reason 3: Multiple regression exists
- Regressing out the confounder beforehand can remove the effect of your covariate of interest
- Ordinary least-squares regression yields estimates for each covariate controlling for all other variables in the model
- So what if we just fit a model with both the confounder and the independent variable?
---
class: img-caption
![](jane_618_f2.gif)
Answer: Looks great, let's do this instead
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
### Reason 4: Even if you really like two-step &lt;br&gt; regression, there's a better way
- Lindquist et al. (2019) suggest that there is a correct way to use modular preprocessing pipelines
- In our earlier model, let's say you regress out the confounder `\(z_i\)` out of the outcome `\(y_i\)`, but also out of the covariate of interest `\(x_i\)`
    - Now you are isolating the effect of `\(x_i\)` independent of `\(z_i\)`
---
class: img-caption
![](hbm24528-fig-0003-ml.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Key Takeaways
- Avoid "residual" or "two-step" regression
    - Just use multiple regression instead
- When dealing with modular pipelines, do one of the following
    - Regress out all confounders simultaneously
    - For each new step, regress the confounders on all confounders from previous steps
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
