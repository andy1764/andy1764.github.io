<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Why Everyone Should Stop Regressing on Residuals</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Chen" />
    <script src="Residual-Regression_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="Residual-Regression_files/plotly-binding-4.9.1/plotly.js"></script>
    <script src="Residual-Regression_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="Residual-Regression_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="Residual-Regression_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="Residual-Regression_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="Residual-Regression_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="Residual-Regression_files/plotly-main-1.49.4/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="PennSIVE-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Why Everyone Should Stop Regressing on Residuals
### Andrew Chen

---




&lt;style type="text/css"&gt;
.remark-slide-content.img-caption {
  background-image: none;
  text-align: center;
  padding-top: 61.5%;
}
.remark-slide-content.img-caption &gt; p:first-of-type {
  padding: 0px;
  margin: 0px;
}
.remark-slide-content.img-caption &gt; p:first-of-type &gt; img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 95%;
  height: 75%;
  margin: 2.5% 2.5% 2.5% 2.5%;
  object-fit: contain;
}

.remark-slide-content.just-img {
  background-image: none;
  text-align: center;
  padding-top: 0px;
}
&lt;/style&gt;

### Reason 1: It can reintroduce unwanted effects
- Recent paper by Lindquist et al. showed that motion artifacts removed from one preprocessing step can be reintroduced by another preprocessing step&lt;sup&gt;1&lt;/sup&gt;
- Let's dive into why this happens
.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]


---
class: img-caption
![](hbm24528-fig-0003-mr.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](https://onlinelibrary.wiley.com/cms/asset/0f891eac-2a43-4632-990f-5db53f241434/hbm24528-fig-0006-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Reason 2: You are not properly controlling for confounders
- Suppose we have `\(n\)` observations indexed by `\(i\)` with
    - Dependent variable `\(y_i\)`
    - Covariate of interest `\(x_i\)`
    - Confounder `\(z_i\)` that is correlated with `\(x_i\)`

`$$y_i=\beta_0+\beta_1x_i+\beta_2z_i+\epsilon_i$$`
- How can we get an estimate of `\(\beta_1\)`?
- What if we first regress out the confounder, then regress the residuals on the covariate of interest?
---
class: img-caption
![](jane_618_f1.gif)
Answer: We get very poor estimates, even with larger samples
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
class: just-img


<div id="htmlwidget-5c555ad78b756f1cb101" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-5c555ad78b756f1cb101">{"x":{"visdat":{"17e6e16f271cf":["function () ","plotlyVisDat"]},"cur_data":"17e6e16f271cf","attrs":{"17e6e16f271cf":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"17e6e16f271cf.1":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Covariate"},"yaxis":{"title":"Confounder"},"zaxis":{"title":"Outcome"},"camera":{"eye":{"x":1.5,"y":-1.5,"z":1.5}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.126822409847798,0.79402754141799,0.050585930312028,-1.69413142708421,0.129000110608911,-0.121844992090262,0.175643604082579,1.10118278737253,0.233136450763749,0.653378521303063,-0.933929789055885,0.036905773906508,0.8794813072281,0.628851638634703,-0.282416065236416,-2.85724833963973,-0.103070118039268,-1.01324932602115,-1.09151070335628,0.118360005270626,-1.61239366726818,0.222934755553604,0.776146149996666,-1.47379390600722,0.224580865985652,1.09514532166114,-0.64497241562236,0.0728724201020179,-0.116459886438995,0.539375597724082,0.80545462922515,-0.906974844276206,-0.369157018845521,-2.48001067657519,1.20385272560224,0.835600093161187,0.0544599697826999,1.87821343856625,-0.17809686305453,1.75740264827114,-1.59744525461531,1.26831197587339,0.253685589878097,-1.58661394725881,-0.0339029417484432,0.225291772057081,-1.09392428528377,0.0379186178531665,0.345894202338407,0.408223280140567,1.7322472010763,0.153784101840173,-0.189502076870226,-2.25839812811155,0.119106429614035,-0.380825982463079,-0.392729039599039,0.521268822444479,-0.097747594540997,-0.498292496420243,1.17722764732077,-2.22058475618652,-1.20788443169582,-0.292138107956529,0.815324054255673,-2.72123010315464,-1.10360157183909,2.56431899191128,0.798393917484029,-0.350699647444891,-1.75130092370874,-0.798415378435838,-0.00259460598413284,2.36955506935573,-1.24083948374853,-1.81637185916816,0.304025661003205,0.233422710884349,0.136796185354227,-0.113897402183851,-0.10096637702781,-0.692572188793229,0.121570136667108,0.264265379433185,1.44789297514938,0.950952219695277,1.37493840496206,0.840080982665476,0.792821250801867,1.0546809155799,-0.362078503329236,-0.461357448514958,-0.101156458849541,-1.11491249421978,0.231214700700054,0.294888644210755,0.769446717149762,0.0834915069887081,-0.576006928733511,0.613707606485091,0.421855770157114,-0.837575124656149,-0.952781435065681,0.762645847288178,0.284181344188381,-0.928198614876155,0.0333551803130333,0.689364372276178,-1.76003104154085,0.974934896487339,0.823995726997239,-0.401064227597281,-0.334175611251446,-0.510631638039967,0.235894845011825,-0.521549362397013,0.220176472543727,-0.98774080274675,-1.05781490556165,0.892700645226112,-0.543736991162245,0.590696673721166,-1.50324049696708,-0.550305911202697,-0.69237214143546,0.627533640562673,0.927812018074407,-0.182050043848502,0.359885470151127,0.188738829863649,0.931805071060575,0.196296025899642,-0.532491375944087,-0.753066372572708,0.8365565941061,-1.68404359698261,-1.52746035826346,-0.532959569744735,0.171158823035358,-0.596133686183507,-1.75590545906446,0.0805373987892105,-0.557011696280146,0.680178631904724,0.511497360588018,0.945213064633698,1.9151843695223,-0.0188183142580919,0.57285087055173,-0.530277109527705,0.128231489752996,-1.00778511368366,-1.06418281133515,-1.46072664457429,-1.17795066072177,0.410284633719367,1.18983871716687,-1.05263093926224,-1.1365827639209,0.28067526488929,0.758374926909219,0.213170653190349,-0.614030024840892,0.824304420660265,0.950014336621789,0.406468434122901,-0.127754280497825,0.82696476511321,1.38089676028546,0.770717523424868,-0.195707663683392,-0.133032329628412,0.566318370997143,0.345445266251031,-0.460709724475854,-0.62538983509976,-1.48895458661961,-1.81026968037624,-0.447171054924378,1.23530764087743,-0.69396106774618,1.39967884096938,0.354384029787354,1.20516609354482,0.527364863080357,0.010400402486646,-0.0743198124871236,-0.582159317208721,2.63453124400154,0.491465952133699,1.04685354606164,0.267814331311969,-0.0262861827093308,1.43120824051846,0.0246887463895645,0.287971316273911,1.88216062691662,0.224533325228663,0.161203279819586,0.153102254312326],"y":[-1.29410900687276,-0.00642012100664457,0.396940367787313,-1.44347559280528,0.528819033251609,0.100907027677043,-0.59469177389751,1.45917771957588,0.545903158830696,-0.17542474471743,-1.34611977900265,0.105233985857442,1.66518052883179,1.23992342830738,-0.110240092247876,-1.85919608115023,-0.440355818876774,-1.09884524999367,-0.849254291557615,-0.480872460071586,-1.89843377953251,0.66065357407255,1.53044301122586,-1.6331166571778,0.384914039880245,1.75172099286502,-0.468823770604853,-0.467331060576071,-1.13172757173533,0.350040432754203,0.430064529049502,-1.13958653572797,-0.0381172872283098,-2.15614017901604,-0.677510667144523,1.75851222586596,0.429017957817784,2.02756874051097,1.47843276446397,1.42191946873519,-1.050048880498,1.23060786085184,0.445367151796948,-1.33571789511604,-0.0619204305525491,-0.788368769459042,-1.53784001693719,-0.672602178868177,-0.311755935532419,0.990676951517226,1.19907765737268,0.257010112480933,-0.400464869136656,-1.43859771378403,-0.571449271488169,-0.546295834388169,-0.88737231151604,-0.471042799741728,-0.0975675941753092,-0.362946357199586,0.658782135352086,-1.75805368728283,-1.37848922969849,-0.25313724107042,0.376525917153211,-1.80567018739307,-0.51961402668703,1.69760894908129,0.813814833849784,-1.26150605327103,-0.937309932915183,-0.871064431736694,0.155249834976026,1.6673385779387,-1.44297674429689,-1.84977746164444,0.487314497144613,-0.61338256963827,-0.713459902920105,-1.04112396309253,0.0354853841097357,0.0904171943348381,-0.287168378295037,-0.610505472452329,1.87650768975765,-0.491097728147498,0.090993806202943,-0.324992251038159,1.19722507527588,0.331524222249964,0.46695745524781,0.045032753585355,0.230848969128428,-1.33948264687845,-0.296119289574779,0.649463471913296,0.244289317809905,-0.200190745264292,0.241714686610257,-0.766009676460655,0.665116453059167,-1.13747983225792,-1.01471198211359,0.0377561676540829,0.870758288332517,-0.599832833326502,-0.765529427950535,0.829389821759846,-1.51591414557751,0.215035762423586,1.71667020600692,0.126687018483325,0.617625110955367,-0.496315232124421,-0.104561213828778,-0.974068900287831,0.510848001428091,-1.24451754973411,-0.501696722081557,0.870922519093547,-0.822090132523394,1.05510372867964,-1.14397697774282,-1.52317955260581,0.475691514184864,1.3966839883744,0.494094854924352,0.519181727485303,-0.173473303499607,-0.423948074504934,0.81258877320356,-0.182418465393683,0.573919733896171,-0.832628364598359,1.62046426281427,-1.04118234327189,-1.78618567417905,0.342347457974451,0.707010910440507,-0.677794103060885,-2.18100301124851,-0.486608887632063,-1.29597530841681,1.43182386503829,0.785967335004855,0.203425382814153,1.45215873788358,0.589799994022326,2.16041432049346,-0.178877125737644,0.64295043280298,-1.229414636198,-0.655118974693863,-1.45499033859546,-0.95105137562667,0.277549815213395,1.0653878460224,-0.697881918180102,-0.0718403774333383,0.960768611744402,0.314229056027427,-0.643976275229636,0.447456735998912,-0.235388545014301,0.19264708750266,0.318660877365388,0.468103226367558,0.258134164255065,1.18980040803889,0.132317784496341,-0.384859897113191,0.0464619013032023,1.75316794352763,0.427005970560136,-0.850112820744247,-0.453439709002694,-1.72395618565906,-1.54766292067903,0.13001607591032,0.722470702103284,-0.496583300548482,1.45222213957594,0.329934171784399,0.70469666795977,1.93952748074575,-0.263591193225507,0.289899915801028,-0.176668975787411,1.42752649010705,-0.493986112653107,0.643639795747288,-0.22494177812731,-0.373227865710341,1.19729677564782,0.900593195126015,1.20572984640192,1.51231146664433,0.331957642564235,0.499089627279868,-0.101297577154106],"z":[-2.75316981148863,-1.2071926254963,-1.44524941111471,-3.95484273370689,-1.29804441908188,-1.7731743948735,-2.0518515386547,0.033734535079641,-1.21319009306813,-1.4239501761743,-3.35455251742522,-1.65901998794948,0.0227454654576817,-0.450375272924785,-2.03337713002325,-5.06002891433721,-2.13891597562547,-3.23698402299462,-3.11705331622397,-2.01227653814492,-4.21609703254473,-1.14000598904594,-0.143905406928479,-3.93335521401376,-1.33187138567812,0.234288600384067,-2.53817515014329,-2.03463886811608,-2.63224904050627,-1.13592659844945,-0.893654408991988,-3.19111078578717,-2.04360983403593,-5.00382341869811,-1.39007837886385,0.0573608035347584,-1.42008327046391,0.975529705569808,-0.848282688797636,0.467007662120186,-3.61176371436356,-0.00927393407658705,-1.26918090061171,-3.80415010944664,-1.82559418039494,-2.15267171796562,-3.60075283133892,-2.20279631249475,-1.73462103302005,-0.77928765762379,0.293409581130045,-1.47096186975947,-2.17149468198906,-4.34641490911115,-2.07515780909614,-2.40750309158012,-2.6545887655648,-1.72335960389232,-1.89523845188566,-2.36138501731813,-0.473310971913249,-4.54356473021279,-3.56897938276026,-2.14021056410311,-0.924222839798026,-4.92734802316764,-2.89476873875253,1.22483173891055,-0.629971693850576,-2.88706181028539,-3.64054541942099,-2.92715368690502,-1.65165915948992,1.06730773332185,-3.63718917941604,-4.32482234435306,-1.20457970908077,-2.02448972091199,-2.16218242208036,-2.56703277547771,-1.8043545148269,-2.18002631590512,-1.8744365889238,-2.00088588489765,0.568562645650682,-1.4366196757008,-0.732365271968743,-1.39795570764512,-0.365485391529821,-0.788174223303338,-1.68510255344124,-2.04994510623497,-1.66773306258902,-3.47659441855301,-1.80395103199655,-1.09747133849741,-1.04890259531248,-1.84020728657715,-1.99252238927052,-1.86512926876714,-0.997637263532849,-3.14105628962409,-3.13576321180973,-1.19823640932466,-0.950060077019616,-2.8281398335261,-2.2710397931305,-0.695389883959028,-4.05167945076709,-0.925538358546597,0.0199483333186654,-1.95058186616401,-1.5601031699915,-2.46338062889932,-1.66658427795611,-2.80545060366364,-1.24680068800397,-3.32109866652085,-2.85017595913449,-0.523981604760483,-2.71459680636419,-0.606457538103679,-3.61157005208117,-3.2099576444502,-1.91019425885966,-0.341565479528291,-0.763183008685114,-1.52252564123848,-1.62802930312818,-1.92316429103314,-0.53744212879935,-1.74880352743007,-1.72951796921779,-2.86850413580399,-0.0386032199399882,-3.66617597796239,-4.078070042494,-1.89194629802344,-1.14379900635114,-2.65026727225532,-4.51435374900332,-2.04276786197424,-3.05560872307211,-0.280116071924133,-0.850292532869233,-0.954470906570749,0.598622355399866,-1.35883064394928,0.154767813947385,-2.25492578446999,-1.21869047399506,-3.32455764470141,-2.96202907000456,-3.79951970800307,-3.24881924522816,-1.27703370553131,-0.179859225551761,-2.98387681999388,-2.60441401873221,-0.889507106140661,-1.00769503172859,-2.06008175521175,-1.87511912197363,-1.34627670683207,-0.95865482289713,-1.25092730174244,-1.52027355767543,-0.998948569226452,0.0409701980427997,-1.1263931042394,-2.16491511234185,-1.81911711961189,-0.134877399616905,-1.21780195401643,-2.67609360143831,-2.51369850065596,-4.00755536037931,-4.10907064052293,-1.98052630509408,-0.388072979697748,-2.59189887759051,0.237812866597479,-1.27949507868402,-0.421613886731035,-0.0316931791059691,-1.93575137330145,-1.60761174746451,-2.28969762488154,1.08492259409176,-1.76028193214783,-0.575172480517998,-1.72850703255498,-2.03817765367801,0.0814356915321492,-1.11082046072334,-0.712927005911163,0.617612645708421,-1.36897414232922,-1.29631278481463,-1.72225454577349],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[-0.126822409847798,0.79402754141799,0.050585930312028,-1.69413142708421,0.129000110608911,-0.121844992090262,0.175643604082579,1.10118278737253,0.233136450763749,0.653378521303063,-0.933929789055885,0.036905773906508,0.8794813072281,0.628851638634703,-0.282416065236416,-2.85724833963973,-0.103070118039268,-1.01324932602115,-1.09151070335628,0.118360005270626,-1.61239366726818,0.222934755553604,0.776146149996666,-1.47379390600722,0.224580865985652,1.09514532166114,-0.64497241562236,0.0728724201020179,-0.116459886438995,0.539375597724082,0.80545462922515,-0.906974844276206,-0.369157018845521,-2.48001067657519,1.20385272560224,0.835600093161187,0.0544599697826999,1.87821343856625,-0.17809686305453,1.75740264827114,-1.59744525461531,1.26831197587339,0.253685589878097,-1.58661394725881,-0.0339029417484432,0.225291772057081,-1.09392428528377,0.0379186178531665,0.345894202338407,0.408223280140567,1.7322472010763,0.153784101840173,-0.189502076870226,-2.25839812811155,0.119106429614035,-0.380825982463079,-0.392729039599039,0.521268822444479,-0.097747594540997,-0.498292496420243,1.17722764732077,-2.22058475618652,-1.20788443169582,-0.292138107956529,0.815324054255673,-2.72123010315464,-1.10360157183909,2.56431899191128,0.798393917484029,-0.350699647444891,-1.75130092370874,-0.798415378435838,-0.00259460598413284,2.36955506935573,-1.24083948374853,-1.81637185916816,0.304025661003205,0.233422710884349,0.136796185354227,-0.113897402183851,-0.10096637702781,-0.692572188793229,0.121570136667108,0.264265379433185,1.44789297514938,0.950952219695277,1.37493840496206,0.840080982665476,0.792821250801867,1.0546809155799,-0.362078503329236,-0.461357448514958,-0.101156458849541,-1.11491249421978,0.231214700700054,0.294888644210755,0.769446717149762,0.0834915069887081,-0.576006928733511,0.613707606485091,0.421855770157114,-0.837575124656149,-0.952781435065681,0.762645847288178,0.284181344188381,-0.928198614876155,0.0333551803130333,0.689364372276178,-1.76003104154085,0.974934896487339,0.823995726997239,-0.401064227597281,-0.334175611251446,-0.510631638039967,0.235894845011825,-0.521549362397013,0.220176472543727,-0.98774080274675,-1.05781490556165,0.892700645226112,-0.543736991162245,0.590696673721166,-1.50324049696708,-0.550305911202697,-0.69237214143546,0.627533640562673,0.927812018074407,-0.182050043848502,0.359885470151127,0.188738829863649,0.931805071060575,0.196296025899642,-0.532491375944087,-0.753066372572708,0.8365565941061,-1.68404359698261,-1.52746035826346,-0.532959569744735,0.171158823035358,-0.596133686183507,-1.75590545906446,0.0805373987892105,-0.557011696280146,0.680178631904724,0.511497360588018,0.945213064633698,1.9151843695223,-0.0188183142580919,0.57285087055173,-0.530277109527705,0.128231489752996,-1.00778511368366,-1.06418281133515,-1.46072664457429,-1.17795066072177,0.410284633719367,1.18983871716687,-1.05263093926224,-1.1365827639209,0.28067526488929,0.758374926909219,0.213170653190349,-0.614030024840892,0.824304420660265,0.950014336621789,0.406468434122901,-0.127754280497825,0.82696476511321,1.38089676028546,0.770717523424868,-0.195707663683392,-0.133032329628412,0.566318370997143,0.345445266251031,-0.460709724475854,-0.62538983509976,-1.48895458661961,-1.81026968037624,-0.447171054924378,1.23530764087743,-0.69396106774618,1.39967884096938,0.354384029787354,1.20516609354482,0.527364863080357,0.010400402486646,-0.0743198124871236,-0.582159317208721,2.63453124400154,0.491465952133699,1.04685354606164,0.267814331311969,-0.0262861827093308,1.43120824051846,0.0246887463895645,0.287971316273911,1.88216062691662,0.224533325228663,0.161203279819586,0.153102254312326],"y":[-1.29410900687276,-0.00642012100664457,0.396940367787313,-1.44347559280528,0.528819033251609,0.100907027677043,-0.59469177389751,1.45917771957588,0.545903158830696,-0.17542474471743,-1.34611977900265,0.105233985857442,1.66518052883179,1.23992342830738,-0.110240092247876,-1.85919608115023,-0.440355818876774,-1.09884524999367,-0.849254291557615,-0.480872460071586,-1.89843377953251,0.66065357407255,1.53044301122586,-1.6331166571778,0.384914039880245,1.75172099286502,-0.468823770604853,-0.467331060576071,-1.13172757173533,0.350040432754203,0.430064529049502,-1.13958653572797,-0.0381172872283098,-2.15614017901604,-0.677510667144523,1.75851222586596,0.429017957817784,2.02756874051097,1.47843276446397,1.42191946873519,-1.050048880498,1.23060786085184,0.445367151796948,-1.33571789511604,-0.0619204305525491,-0.788368769459042,-1.53784001693719,-0.672602178868177,-0.311755935532419,0.990676951517226,1.19907765737268,0.257010112480933,-0.400464869136656,-1.43859771378403,-0.571449271488169,-0.546295834388169,-0.88737231151604,-0.471042799741728,-0.0975675941753092,-0.362946357199586,0.658782135352086,-1.75805368728283,-1.37848922969849,-0.25313724107042,0.376525917153211,-1.80567018739307,-0.51961402668703,1.69760894908129,0.813814833849784,-1.26150605327103,-0.937309932915183,-0.871064431736694,0.155249834976026,1.6673385779387,-1.44297674429689,-1.84977746164444,0.487314497144613,-0.61338256963827,-0.713459902920105,-1.04112396309253,0.0354853841097357,0.0904171943348381,-0.287168378295037,-0.610505472452329,1.87650768975765,-0.491097728147498,0.090993806202943,-0.324992251038159,1.19722507527588,0.331524222249964,0.46695745524781,0.045032753585355,0.230848969128428,-1.33948264687845,-0.296119289574779,0.649463471913296,0.244289317809905,-0.200190745264292,0.241714686610257,-0.766009676460655,0.665116453059167,-1.13747983225792,-1.01471198211359,0.0377561676540829,0.870758288332517,-0.599832833326502,-0.765529427950535,0.829389821759846,-1.51591414557751,0.215035762423586,1.71667020600692,0.126687018483325,0.617625110955367,-0.496315232124421,-0.104561213828778,-0.974068900287831,0.510848001428091,-1.24451754973411,-0.501696722081557,0.870922519093547,-0.822090132523394,1.05510372867964,-1.14397697774282,-1.52317955260581,0.475691514184864,1.3966839883744,0.494094854924352,0.519181727485303,-0.173473303499607,-0.423948074504934,0.81258877320356,-0.182418465393683,0.573919733896171,-0.832628364598359,1.62046426281427,-1.04118234327189,-1.78618567417905,0.342347457974451,0.707010910440507,-0.677794103060885,-2.18100301124851,-0.486608887632063,-1.29597530841681,1.43182386503829,0.785967335004855,0.203425382814153,1.45215873788358,0.589799994022326,2.16041432049346,-0.178877125737644,0.64295043280298,-1.229414636198,-0.655118974693863,-1.45499033859546,-0.95105137562667,0.277549815213395,1.0653878460224,-0.697881918180102,-0.0718403774333383,0.960768611744402,0.314229056027427,-0.643976275229636,0.447456735998912,-0.235388545014301,0.19264708750266,0.318660877365388,0.468103226367558,0.258134164255065,1.18980040803889,0.132317784496341,-0.384859897113191,0.0464619013032023,1.75316794352763,0.427005970560136,-0.850112820744247,-0.453439709002694,-1.72395618565906,-1.54766292067903,0.13001607591032,0.722470702103284,-0.496583300548482,1.45222213957594,0.329934171784399,0.70469666795977,1.93952748074575,-0.263591193225507,0.289899915801028,-0.176668975787411,1.42752649010705,-0.493986112653107,0.643639795747288,-0.22494177812731,-0.373227865710341,1.19729677564782,0.900593195126015,1.20572984640192,1.51231146664433,0.331957642564235,0.499089627279868,-0.101297577154106],"z":[-2.75316981148863,-1.2071926254963,-1.44524941111471,-3.95484273370689,-1.29804441908188,-1.7731743948735,-2.0518515386547,0.033734535079641,-1.21319009306813,-1.4239501761743,-3.35455251742522,-1.65901998794948,0.0227454654576817,-0.450375272924785,-2.03337713002325,-5.06002891433721,-2.13891597562547,-3.23698402299462,-3.11705331622397,-2.01227653814492,-4.21609703254473,-1.14000598904594,-0.143905406928479,-3.93335521401376,-1.33187138567812,0.234288600384067,-2.53817515014329,-2.03463886811608,-2.63224904050627,-1.13592659844945,-0.893654408991988,-3.19111078578717,-2.04360983403593,-5.00382341869811,-1.39007837886385,0.0573608035347584,-1.42008327046391,0.975529705569808,-0.848282688797636,0.467007662120186,-3.61176371436356,-0.00927393407658705,-1.26918090061171,-3.80415010944664,-1.82559418039494,-2.15267171796562,-3.60075283133892,-2.20279631249475,-1.73462103302005,-0.77928765762379,0.293409581130045,-1.47096186975947,-2.17149468198906,-4.34641490911115,-2.07515780909614,-2.40750309158012,-2.6545887655648,-1.72335960389232,-1.89523845188566,-2.36138501731813,-0.473310971913249,-4.54356473021279,-3.56897938276026,-2.14021056410311,-0.924222839798026,-4.92734802316764,-2.89476873875253,1.22483173891055,-0.629971693850576,-2.88706181028539,-3.64054541942099,-2.92715368690502,-1.65165915948992,1.06730773332185,-3.63718917941604,-4.32482234435306,-1.20457970908077,-2.02448972091199,-2.16218242208036,-2.56703277547771,-1.8043545148269,-2.18002631590512,-1.8744365889238,-2.00088588489765,0.568562645650682,-1.4366196757008,-0.732365271968743,-1.39795570764512,-0.365485391529821,-0.788174223303338,-1.68510255344124,-2.04994510623497,-1.66773306258902,-3.47659441855301,-1.80395103199655,-1.09747133849741,-1.04890259531248,-1.84020728657715,-1.99252238927052,-1.86512926876714,-0.997637263532849,-3.14105628962409,-3.13576321180973,-1.19823640932466,-0.950060077019616,-2.8281398335261,-2.2710397931305,-0.695389883959028,-4.05167945076709,-0.925538358546597,0.0199483333186654,-1.95058186616401,-1.5601031699915,-2.46338062889932,-1.66658427795611,-2.80545060366364,-1.24680068800397,-3.32109866652085,-2.85017595913449,-0.523981604760483,-2.71459680636419,-0.606457538103679,-3.61157005208117,-3.2099576444502,-1.91019425885966,-0.341565479528291,-0.763183008685114,-1.52252564123848,-1.62802930312818,-1.92316429103314,-0.53744212879935,-1.74880352743007,-1.72951796921779,-2.86850413580399,-0.0386032199399882,-3.66617597796239,-4.078070042494,-1.89194629802344,-1.14379900635114,-2.65026727225532,-4.51435374900332,-2.04276786197424,-3.05560872307211,-0.280116071924133,-0.850292532869233,-0.954470906570749,0.598622355399866,-1.35883064394928,0.154767813947385,-2.25492578446999,-1.21869047399506,-3.32455764470141,-2.96202907000456,-3.79951970800307,-3.24881924522816,-1.27703370553131,-0.179859225551761,-2.98387681999388,-2.60441401873221,-0.889507106140661,-1.00769503172859,-2.06008175521175,-1.87511912197363,-1.34627670683207,-0.95865482289713,-1.25092730174244,-1.52027355767543,-0.998948569226452,0.0409701980427997,-1.1263931042394,-2.16491511234185,-1.81911711961189,-0.134877399616905,-1.21780195401643,-2.67609360143831,-2.51369850065596,-4.00755536037931,-4.10907064052293,-1.98052630509408,-0.388072979697748,-2.59189887759051,0.237812866597479,-1.27949507868402,-0.421613886731035,-0.0316931791059691,-1.93575137330145,-1.60761174746451,-2.28969762488154,1.08492259409176,-1.76028193214783,-0.575172480517998,-1.72850703255498,-2.03817765367801,0.0814356915321492,-1.11082046072334,-0.712927005911163,0.617612645708421,-1.36897414232922,-1.29631278481463,-1.72225454577349],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
class: just-img
<div id="htmlwidget-b47f29e9eaf1c53d18de" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-b47f29e9eaf1c53d18de">{"x":{"visdat":{"17e6e1e14c000":["function () ","plotlyVisDat"]},"cur_data":"17e6e1e14c000","attrs":{"17e6e1e14c000":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"17e6e1e14c000.1":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Covariate"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.126822409847798,0.79402754141799,0.050585930312028,-1.69413142708421,0.129000110608911,-0.121844992090262,0.175643604082579,1.10118278737253,0.233136450763749,0.653378521303063,-0.933929789055885,0.036905773906508,0.8794813072281,0.628851638634703,-0.282416065236416,-2.85724833963973,-0.103070118039268,-1.01324932602115,-1.09151070335628,0.118360005270626,-1.61239366726818,0.222934755553604,0.776146149996666,-1.47379390600722,0.224580865985652,1.09514532166114,-0.64497241562236,0.0728724201020179,-0.116459886438995,0.539375597724082,0.80545462922515,-0.906974844276206,-0.369157018845521,-2.48001067657519,1.20385272560224,0.835600093161187,0.0544599697826999,1.87821343856625,-0.17809686305453,1.75740264827114,-1.59744525461531,1.26831197587339,0.253685589878097,-1.58661394725881,-0.0339029417484432,0.225291772057081,-1.09392428528377,0.0379186178531665,0.345894202338407,0.408223280140567,1.7322472010763,0.153784101840173,-0.189502076870226,-2.25839812811155,0.119106429614035,-0.380825982463079,-0.392729039599039,0.521268822444479,-0.097747594540997,-0.498292496420243,1.17722764732077,-2.22058475618652,-1.20788443169582,-0.292138107956529,0.815324054255673,-2.72123010315464,-1.10360157183909,2.56431899191128,0.798393917484029,-0.350699647444891,-1.75130092370874,-0.798415378435838,-0.00259460598413284,2.36955506935573,-1.24083948374853,-1.81637185916816,0.304025661003205,0.233422710884349,0.136796185354227,-0.113897402183851,-0.10096637702781,-0.692572188793229,0.121570136667108,0.264265379433185,1.44789297514938,0.950952219695277,1.37493840496206,0.840080982665476,0.792821250801867,1.0546809155799,-0.362078503329236,-0.461357448514958,-0.101156458849541,-1.11491249421978,0.231214700700054,0.294888644210755,0.769446717149762,0.0834915069887081,-0.576006928733511,0.613707606485091,0.421855770157114,-0.837575124656149,-0.952781435065681,0.762645847288178,0.284181344188381,-0.928198614876155,0.0333551803130333,0.689364372276178,-1.76003104154085,0.974934896487339,0.823995726997239,-0.401064227597281,-0.334175611251446,-0.510631638039967,0.235894845011825,-0.521549362397013,0.220176472543727,-0.98774080274675,-1.05781490556165,0.892700645226112,-0.543736991162245,0.590696673721166,-1.50324049696708,-0.550305911202697,-0.69237214143546,0.627533640562673,0.927812018074407,-0.182050043848502,0.359885470151127,0.188738829863649,0.931805071060575,0.196296025899642,-0.532491375944087,-0.753066372572708,0.8365565941061,-1.68404359698261,-1.52746035826346,-0.532959569744735,0.171158823035358,-0.596133686183507,-1.75590545906446,0.0805373987892105,-0.557011696280146,0.680178631904724,0.511497360588018,0.945213064633698,1.9151843695223,-0.0188183142580919,0.57285087055173,-0.530277109527705,0.128231489752996,-1.00778511368366,-1.06418281133515,-1.46072664457429,-1.17795066072177,0.410284633719367,1.18983871716687,-1.05263093926224,-1.1365827639209,0.28067526488929,0.758374926909219,0.213170653190349,-0.614030024840892,0.824304420660265,0.950014336621789,0.406468434122901,-0.127754280497825,0.82696476511321,1.38089676028546,0.770717523424868,-0.195707663683392,-0.133032329628412,0.566318370997143,0.345445266251031,-0.460709724475854,-0.62538983509976,-1.48895458661961,-1.81026968037624,-0.447171054924378,1.23530764087743,-0.69396106774618,1.39967884096938,0.354384029787354,1.20516609354482,0.527364863080357,0.010400402486646,-0.0743198124871236,-0.582159317208721,2.63453124400154,0.491465952133699,1.04685354606164,0.267814331311969,-0.0262861827093308,1.43120824051846,0.0246887463895645,0.287971316273911,1.88216062691662,0.224533325228663,0.161203279819586,0.153102254312326],"y":[0.615971192932295,0.548577505121043,-0.194857614818887,-0.398557379506996,-0.21288601112355,-0.151876571624239,0.440975781067793,-0.0467718562634181,-0.149436723948173,0.543569190167565,0.0797538120982632,-0.0431434961856797,-0.31586592005224,-0.256173626191459,-0.147528904022593,-0.982879137914695,0.160540773500192,-0.112492841614048,-0.30527958323126,0.337944312096753,-0.0897855677517445,-0.22002568478671,-0.313701491708516,-0.139464819424049,-0.0664115652834305,-0.212751044163548,-0.203050341240877,0.298615694867538,0.533441052151183,0.173227054065087,0.315235470508421,-0.0155740417039133,-0.248125696933434,-0.5546265089167,1.20651437025078,-0.398187711160918,-0.209882121167548,0.182874962110349,-0.95291410671909,0.433182870172001,-0.548410469448696,0.196599371370807,-0.0794639798162539,-0.382876505979545,-0.000286614228314497,0.582817340158528,0.0737635762534018,0.387646494575343,0.403710378735966,-0.272800170370123,0.538787702140208,-0.0452486889637263,0.0779819072194975,-0.796241146014672,0.388548519653194,0.024687998326491,0.20494378855544,0.61454547050501,-0.0252678493645744,-0.158916113779701,0.449014094933312,-0.593138259523144,-0.0941167282370817,-0.075323674035082,0.351746625466807,-0.917261897701482,-0.496007813443862,0.845590144280815,0.0981098387162567,0.441230308726692,-0.718445031752809,-0.088053597907585,-0.0984485143309872,0.725992485402673,-0.0815288423788371,-0.259473342596592,-0.0674194469317706,0.491755666472139,0.479451835563566,0.485138263897345,-0.101088620402697,-0.545585572987042,0.233088586061695,0.511754730517222,-0.0348247195416761,0.926412615154814,0.901353022535201,0.756959745604019,-0.117786133769068,0.544178755576943,-0.522436550865656,-0.35864129986051,-0.209242067855759,-0.0506038831412159,0.314788916767949,-0.163470733918137,0.39274872072629,0.158341891687051,-0.547645266879078,0.842345639507448,-0.0832485886255166,0.03184092401386,-0.116684265795582,0.502184375483873,-0.293324124836829,-0.328871178762,0.435833402287112,0.0131774382036069,-0.404634401064669,0.552765315630482,-0.38317548711844,-0.361584303288443,-0.586211653249375,-0.0938112241160163,0.21214876895291,0.162705821267181,-0.139126018831847,-0.014091779599233,-0.473863979145478,0.132548579453552,0.0631424145051165,-0.180691634229185,-0.430532436360652,0.446190377417664,-0.758471331473892,-0.343772239009608,0.365482009095571,-0.425292462272994,0.337045063915072,0.355734870646595,0.192175559400917,0.227478409873175,-0.700867121126394,-0.0775613555363301,-0.321188711330767,-0.613931792905937,-0.0923964490103604,-0.573153965250979,-0.281900725711206,-0.053319400675113,-0.034005704965485,0.314640271816538,0.315870607466218,-0.326350277895706,-0.0873203182146485,0.53837964185621,0.526910185044828,-0.35007648785949,-0.804331784173634,-0.283080861664584,-0.276529553895586,-0.0364734968638942,-0.393491315238013,-0.228807301056936,-0.309501932200053,0.122944875464071,0.233021504298405,-0.361760527541661,-0.766677554915844,-0.345546868440103,0.346327402986329,0.494495091008912,-0.688020282553892,0.69637249090263,0.547700064905345,0.0975424163628627,-0.359043114397541,0.425356264869296,0.297971968234406,0.455549560529715,0.0650096987737833,-0.129603920679687,-0.583729957268384,-0.00507994609064269,0.136755799752845,-0.197848686810313,-0.0998503238754281,-0.422246922549039,-0.395699784112939,0.454455422194633,-0.22199360457668,0.166021259008088,0.0548501058735656,0.443183954085522,-0.71403928687146,0.142233480186377,-0.223106851763252,-0.320619336822924,1.04407265416767,0.606369272783104,0.366124723113911,0.301053204324432,0.177173155227527,0.329045114478771,-0.491465253355242,-0.475883544106812,0.470533931751405,-0.0371642043331382,-0.173905816107845,0.152389426195624],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.126822409847798,0.79402754141799,0.050585930312028,-1.69413142708421,0.129000110608911,-0.121844992090262,0.175643604082579,1.10118278737253,0.233136450763749,0.653378521303063,-0.933929789055885,0.036905773906508,0.8794813072281,0.628851638634703,-0.282416065236416,-2.85724833963973,-0.103070118039268,-1.01324932602115,-1.09151070335628,0.118360005270626,-1.61239366726818,0.222934755553604,0.776146149996666,-1.47379390600722,0.224580865985652,1.09514532166114,-0.64497241562236,0.0728724201020179,-0.116459886438995,0.539375597724082,0.80545462922515,-0.906974844276206,-0.369157018845521,-2.48001067657519,1.20385272560224,0.835600093161187,0.0544599697826999,1.87821343856625,-0.17809686305453,1.75740264827114,-1.59744525461531,1.26831197587339,0.253685589878097,-1.58661394725881,-0.0339029417484432,0.225291772057081,-1.09392428528377,0.0379186178531665,0.345894202338407,0.408223280140567,1.7322472010763,0.153784101840173,-0.189502076870226,-2.25839812811155,0.119106429614035,-0.380825982463079,-0.392729039599039,0.521268822444479,-0.097747594540997,-0.498292496420243,1.17722764732077,-2.22058475618652,-1.20788443169582,-0.292138107956529,0.815324054255673,-2.72123010315464,-1.10360157183909,2.56431899191128,0.798393917484029,-0.350699647444891,-1.75130092370874,-0.798415378435838,-0.00259460598413284,2.36955506935573,-1.24083948374853,-1.81637185916816,0.304025661003205,0.233422710884349,0.136796185354227,-0.113897402183851,-0.10096637702781,-0.692572188793229,0.121570136667108,0.264265379433185,1.44789297514938,0.950952219695277,1.37493840496206,0.840080982665476,0.792821250801867,1.0546809155799,-0.362078503329236,-0.461357448514958,-0.101156458849541,-1.11491249421978,0.231214700700054,0.294888644210755,0.769446717149762,0.0834915069887081,-0.576006928733511,0.613707606485091,0.421855770157114,-0.837575124656149,-0.952781435065681,0.762645847288178,0.284181344188381,-0.928198614876155,0.0333551803130333,0.689364372276178,-1.76003104154085,0.974934896487339,0.823995726997239,-0.401064227597281,-0.334175611251446,-0.510631638039967,0.235894845011825,-0.521549362397013,0.220176472543727,-0.98774080274675,-1.05781490556165,0.892700645226112,-0.543736991162245,0.590696673721166,-1.50324049696708,-0.550305911202697,-0.69237214143546,0.627533640562673,0.927812018074407,-0.182050043848502,0.359885470151127,0.188738829863649,0.931805071060575,0.196296025899642,-0.532491375944087,-0.753066372572708,0.8365565941061,-1.68404359698261,-1.52746035826346,-0.532959569744735,0.171158823035358,-0.596133686183507,-1.75590545906446,0.0805373987892105,-0.557011696280146,0.680178631904724,0.511497360588018,0.945213064633698,1.9151843695223,-0.0188183142580919,0.57285087055173,-0.530277109527705,0.128231489752996,-1.00778511368366,-1.06418281133515,-1.46072664457429,-1.17795066072177,0.410284633719367,1.18983871716687,-1.05263093926224,-1.1365827639209,0.28067526488929,0.758374926909219,0.213170653190349,-0.614030024840892,0.824304420660265,0.950014336621789,0.406468434122901,-0.127754280497825,0.82696476511321,1.38089676028546,0.770717523424868,-0.195707663683392,-0.133032329628412,0.566318370997143,0.345445266251031,-0.460709724475854,-0.62538983509976,-1.48895458661961,-1.81026968037624,-0.447171054924378,1.23530764087743,-0.69396106774618,1.39967884096938,0.354384029787354,1.20516609354482,0.527364863080357,0.010400402486646,-0.0743198124871236,-0.582159317208721,2.63453124400154,0.491465952133699,1.04685354606164,0.267814331311969,-0.0262861827093308,1.43120824051846,0.0246887463895645,0.287971316273911,1.88216062691662,0.224533325228663,0.161203279819586,0.153102254312326],"y":[0.615971192932295,0.548577505121043,-0.194857614818887,-0.398557379506996,-0.21288601112355,-0.151876571624239,0.440975781067793,-0.0467718562634181,-0.149436723948173,0.543569190167565,0.0797538120982632,-0.0431434961856797,-0.31586592005224,-0.256173626191459,-0.147528904022593,-0.982879137914695,0.160540773500192,-0.112492841614048,-0.30527958323126,0.337944312096753,-0.0897855677517445,-0.22002568478671,-0.313701491708516,-0.139464819424049,-0.0664115652834305,-0.212751044163548,-0.203050341240877,0.298615694867538,0.533441052151183,0.173227054065087,0.315235470508421,-0.0155740417039133,-0.248125696933434,-0.5546265089167,1.20651437025078,-0.398187711160918,-0.209882121167548,0.182874962110349,-0.95291410671909,0.433182870172001,-0.548410469448696,0.196599371370807,-0.0794639798162539,-0.382876505979545,-0.000286614228314497,0.582817340158528,0.0737635762534018,0.387646494575343,0.403710378735966,-0.272800170370123,0.538787702140208,-0.0452486889637263,0.0779819072194975,-0.796241146014672,0.388548519653194,0.024687998326491,0.20494378855544,0.61454547050501,-0.0252678493645744,-0.158916113779701,0.449014094933312,-0.593138259523144,-0.0941167282370817,-0.075323674035082,0.351746625466807,-0.917261897701482,-0.496007813443862,0.845590144280815,0.0981098387162567,0.441230308726692,-0.718445031752809,-0.088053597907585,-0.0984485143309872,0.725992485402673,-0.0815288423788371,-0.259473342596592,-0.0674194469317706,0.491755666472139,0.479451835563566,0.485138263897345,-0.101088620402697,-0.545585572987042,0.233088586061695,0.511754730517222,-0.0348247195416761,0.926412615154814,0.901353022535201,0.756959745604019,-0.117786133769068,0.544178755576943,-0.522436550865656,-0.35864129986051,-0.209242067855759,-0.0506038831412159,0.314788916767949,-0.163470733918137,0.39274872072629,0.158341891687051,-0.547645266879078,0.842345639507448,-0.0832485886255166,0.03184092401386,-0.116684265795582,0.502184375483873,-0.293324124836829,-0.328871178762,0.435833402287112,0.0131774382036069,-0.404634401064669,0.552765315630482,-0.38317548711844,-0.361584303288443,-0.586211653249375,-0.0938112241160163,0.21214876895291,0.162705821267181,-0.139126018831847,-0.014091779599233,-0.473863979145478,0.132548579453552,0.0631424145051165,-0.180691634229185,-0.430532436360652,0.446190377417664,-0.758471331473892,-0.343772239009608,0.365482009095571,-0.425292462272994,0.337045063915072,0.355734870646595,0.192175559400917,0.227478409873175,-0.700867121126394,-0.0775613555363301,-0.321188711330767,-0.613931792905937,-0.0923964490103604,-0.573153965250979,-0.281900725711206,-0.053319400675113,-0.034005704965485,0.314640271816538,0.315870607466218,-0.326350277895706,-0.0873203182146485,0.53837964185621,0.526910185044828,-0.35007648785949,-0.804331784173634,-0.283080861664584,-0.276529553895586,-0.0364734968638942,-0.393491315238013,-0.228807301056936,-0.309501932200053,0.122944875464071,0.233021504298405,-0.361760527541661,-0.766677554915844,-0.345546868440103,0.346327402986329,0.494495091008912,-0.688020282553892,0.69637249090263,0.547700064905345,0.0975424163628627,-0.359043114397541,0.425356264869296,0.297971968234406,0.455549560529715,0.0650096987737833,-0.129603920679687,-0.583729957268384,-0.00507994609064269,0.136755799752845,-0.197848686810313,-0.0998503238754281,-0.422246922549039,-0.395699784112939,0.454455422194633,-0.22199360457668,0.166021259008088,0.0548501058735656,0.443183954085522,-0.71403928687146,0.142233480186377,-0.223106851763252,-0.320619336822924,1.04407265416767,0.606369272783104,0.366124723113911,0.301053204324432,0.177173155227527,0.329045114478771,-0.491465253355242,-0.475883544106812,0.470533931751405,-0.0371642043331382,-0.173905816107845,0.152389426195624],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
### Reason 3: Multiple regression exists
- Regressing out the confounder beforehand can remove the effect of your covariate of interest
- Ordinary least-squares regression yields estimates for each covariate controlling for all other variables in the model
- So what if we just fit a model with both the confounder and the independent variable?
---
class: img-caption
![](jane_618_f2.gif)
Answer: Looks great, let's do this instead
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
### Reason 4: Even if you really like two-step &lt;br&gt; regression, there's a better way
- Lindquist et al. (2019) suggest that there is a correct way to use modular preprocessing pipelines
- In our earlier model, let's say you regress out the confounder `\(z_i\)` out of the outcome `\(y_i\)`, but also out of the covariate of interest `\(x_i\)`
    - Now you are isolating the effect of `\(x_i\)` independent of `\(z_i\)`
---
class: img-caption
![](hbm24528-fig-0003-ml.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Key Takeaways
- Avoid "residual" or "two-step" regression
    - Just use multiple regression instead
- When dealing with modular pipelines, do one of the following
    - Regress out all confounders simultaneously
    - For each new step, regress the confounders on all confounders from previous steps
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
