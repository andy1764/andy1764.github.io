<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Why Everyone Should Stop Regressing on Residuals</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Chen" />
    <script src="Residual-Regression_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="Residual-Regression_files/plotly-binding-4.9.1/plotly.js"></script>
    <script src="Residual-Regression_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="Residual-Regression_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="Residual-Regression_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="Residual-Regression_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="Residual-Regression_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="Residual-Regression_files/plotly-main-1.49.4/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="PennSIVE-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Why Everyone Should Stop Regressing on Residuals
### Andrew Chen

---




&lt;style type="text/css"&gt;
.remark-slide-content.img-caption {
  background-image: none;
  text-align: center;
  padding-top: 61.5%;
}
.remark-slide-content.img-caption &gt; p:first-of-type {
  padding: 0px;
  margin: 0px;
}
.remark-slide-content.img-caption &gt; p:first-of-type &gt; img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 95%;
  height: 75%;
  margin: 2.5% 2.5% 2.5% 2.5%;
  object-fit: contain;
}

.remark-slide-content.just-img {
  background-image: none;
  text-align: center;
  padding-top: 0px;
}
&lt;/style&gt;

### Reason 1: It can reintroduce unwanted effects
- Recent paper by Lindquist et al. showed that motion artifacts removed from one preprocessing step can be reintroduced by another preprocessing step&lt;sup&gt;1&lt;/sup&gt;
- Let's dive into why this happens
.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0001-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0003-mr.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](https://onlinelibrary.wiley.com/cms/asset/0f891eac-2a43-4632-990f-5db53f241434/hbm24528-fig-0006-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Reason 2: You are not properly controlling for confounders
- Suppose we have `\(n\)` observations indexed by `\(i\)` with
    - Dependent variable `\(y_i\)`
    - Covariate of interest `\(x_i\)`
    - Confounder `\(z_i\)` that is correlated with `\(x_i\)`

`$$y_i=\beta_0+\beta_1x_i+\beta_2z_i+\epsilon_i$$`
- How can we get an estimate of `\(\beta_1\)`?
- What if we first regress out the confounder, then regress the residuals on the covariate of interest?
---
class: img-caption
![](jane_618_f1.gif)
Answer: We get very poor estimates, even with larger samples
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
class: just-img


<div id="htmlwidget-385f25907a7da81d4066" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-385f25907a7da81d4066">{"x":{"visdat":{"166547ca50cb":["function () ","plotlyVisDat"]},"cur_data":"166547ca50cb","attrs":{"166547ca50cb":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"166547ca50cb.1":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Covariate"},"yaxis":{"title":"Confounder"},"zaxis":{"title":"Outcome"},"camera":{"eye":{"x":1.5,"y":-1.5,"z":1.5}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.245161241959509,-0.810042706966922,-0.496672960582009,-0.290288781659072,-0.416014572802324,0.0859720375140756,0.0921258783843474,0.122887056263795,-1.41119526755817,1.21478596860656,0.157366681837586,0.298116763650492,-1.32923667349338,0.790169968463366,0.563023696562998,-0.795939299665589,-0.282612509948314,2.17547413553851,-0.284129265895805,0.9108937904041,-0.693396684056606,1.13465179510382,1.8459840576919,-0.549798490531451,0.639592811747285,-0.137023609788182,-2.11098001395678,0.00836303814382944,0.802319429075681,-1.26080977475963,-0.13153877358352,0.264420902941628,-0.144958769452775,1.40454532185512,1.77668957460508,-0.4491015186371,-1.03568935590814,1.39570437664854,1.3749714463219,-0.891599241841874,-0.633217424279408,-1.1315590546863,1.5969248101504,-0.309654697287888,-0.963678714893855,0.631958810404798,-0.406115827387461,0.183658987547114,1.90621250580121,-0.557486296974365,-0.228085081339571,0.586522966907534,0.78315693508935,-0.216142716707643,-0.176634488888188,-1.64806416302593,-1.61616784906664,1.77552692099951,0.521691637174122,-0.807375837068626,-1.21890918673952,-0.980849329100978,0.751578022513336,-1.60533410476373,1.62988681146652,0.298004458533601,1.6806534662361,0.234586649307705,-1.5012523493129,0.664009308308454,-1.13938870461448,-0.681190759634477,0.748422041097908,1.94238340373079,1.79299871885027,0.0239659712134909,-0.095989118638959,2.20210373310182,-0.668824886192503,0.414302286626269,-1.37605532838715,-1.22733036057881,-1.59770949836012,1.0699500633578,0.299433140554774,1.15277189109355,1.22101809676208,0.425471866746646,2.10615548852574,0.854942152640602,0.305879370727465,-1.00899899395785,0.619953308481931,0.939846803440841,-1.00368124509308,1.14008653417574,0.690446300828155,0.946524475994108,-0.870235766190593,-0.231128533506698,0.671204017902717,-0.598473702249974,1.18925436656721,2.17457707715504,-0.218166810933357,-0.152776163496661,0.419318941153033,-1.50316280556803,1.14834821105518,-1.4400977614422,-0.367249053486178,0.17844870459755,-1.43073566580724,-0.0211662746051213,-0.00769374033873965,-1.63023057673108,2.7300802704144,-0.482091217191152,-1.81214983487174,-0.196887213014989,-1.09715909080523,0.0929693188986826,-0.61918130145074,0.79180272900851,-2.54758811120863,0.864972927107392,0.989924711908617,1.00391832310997,0.759678413871795,0.710865756856507,0.180443900424624,0.726417994867126,-1.60016849545482,1.12918215285328,1.47939288917984,1.8379409726514,-0.946675889426327,0.161564474106839,0.556663043247537,0.143742780712765,-1.05995652572643,-0.0588143929620697,0.103521960342288,0.869325600153945,-0.626112558635561,0.270093258780405,0.508691731504305,0.831186345611338,-0.129163788980892,-0.0700549812021291,-1.92913833374983,-0.69648006765076,-0.0588177034060642,1.16857761731987,-0.0405991158086064,0.14188740277871,0.841509825531885,1.09638549243224,-0.696917812711084,0.547731381698303,0.766975340707562,-0.269358215599338,-0.972512672558092,0.865008709374792,0.00420886094731066,0.681689602838956,-0.597074830698138,-1.07346438954551,-0.328921536724472,0.436624743560598,0.494702459247002,-0.66654994059971,-0.553798528026596,-0.682247549251819,-0.85628394995556,-1.57256194934819,-0.51277728810822,1.77028194464225,-0.572223983801853,0.560116707070087,1.41995053650877,0.866915154321265,1.60507595889961,-0.175646334663282,-2.23595557682942,0.636419384854192,0.132909702652273,2.76293077671523,-0.562660151440724,0.56182105604113,0.834456516818865,1.28746972256531,-0.540617812142931,0.23683171692123,-0.642129461954855,1.43573456288046,0.926659956356879,0.545517420418645,1.5305230609095,0.428161540241519],"y":[-0.235518070340648,-2.45240114824329,-0.644977102668746,-0.752751994425032,-1.30776731856761,0.0601378296228902,-0.799270043933544,1.15367722139551,-1.15414669499537,0.847149491130221,-0.483562151875585,-0.00579166371028117,-1.28381867645574,-0.47020137312235,0.89518291501062,0.242798961623441,-0.246152472682681,-0.368553656666437,0.244266588082482,0.831498360200626,-0.980065146646265,0.891502178347759,-0.464449870169526,-1.70452873644919,0.429450549296421,-2.22793442034749,-1.29436884538855,0.328648311753084,1.21664637440336,-0.744855416320498,0.661252536715995,-0.815074868255698,-0.663631956574116,0.565381680025143,0.865809708866239,-1.52707913267423,-0.264262171601064,0.495048686987777,-0.177576500277566,-0.076731585023236,-1.30908876966406,0.237003828374522,1.7232587133783,-0.89974941918172,-0.176046521516956,1.43096176800729,-0.726594014862142,-1.13075786614039,-0.611805466268342,-0.683429687160743,-0.936648152847723,0.66817244620447,0.760571194983721,-0.592808675159742,-0.415141912182319,-1.30071381610594,-1.03556340312276,1.52260161059274,0.071143998520118,-0.710016303285978,-0.449724652862997,0.8356700891989,0.229584417966709,-0.935867648250804,1.65316673934698,1.02697223384404,1.71580382147259,1.44148127358026,-0.666368988540678,0.888837795476519,0.281529551915423,0.0921869930157002,2.01613858082902,1.33308058244359,1.25243653402571,0.187006412411344,-0.970792117389861,1.03436090683104,2.70844174467451,0.243277948747478,-0.687212781442045,0.791164655171137,-1.47081778648488,1.11406048537057,-0.138825818879375,1.09112966560324,1.82110986127213,1.30272983356553,0.82699975112784,0.51282806535089,-0.955546057616568,0.905261272703474,0.488350034548716,-0.292077708302782,0.467359312573874,2.33286097074737,0.551302291623219,1.12839558350128,0.546836140190226,-0.173376249606874,0.506606480659064,2.40959779292393e-05,1.42946242817853,1.70310386403805,-0.426687186459605,-0.0283586416890512,1.50264800285024,-1.66440103251857,1.82503186411959,-1.33996154122608,-1.56362649529485,-0.345446752825915,-3.05647235822099,0.453926599711493,-0.968402676713218,-1.51537847386661,0.571167957070676,0.374215693456776,0.0790097698875623,-2.18895250511234,-0.222181177090204,0.71844726533925,0.0150946317514682,0.779297547926592,-0.938414784640164,1.93749422988598,0.433934033736125,0.726051676539831,1.17254445961667,-0.405484184988862,-0.501561725698746,0.597637114644797,-2.17997584508201,-0.544848427045872,0.302939416384703,0.975585073389433,-0.428193781576418,-1.96577209028799,-0.285043061980494,0.649195282837274,-2.16403928794774,-0.053929287267917,-0.1991786618799,-0.574521546695145,-0.530206158291824,1.23282559845109,2.71457025026966,-1.15500526781127,-0.525453402182902,0.54586479241777,0.996407246649767,0.840059267746597,-1.49616047809717,1.16478324524806,-1.46500196762785,1.68696270588163,0.237076213522748,1.01989599413667,0.261933572461807,0.445371165620171,-0.358343474063163,-0.371057114285668,-0.466732122524142,0.82896965862136,-0.895540253913167,1.36136274343507,0.164503669270383,-0.0701868457336373,0.679593167424365,1.33917779836163,0.776718626335842,-0.39183936904355,0.432890890990184,-1.47748802755464,-0.103350403179884,-1.01406320789962,1.03714684537001,1.93647830964937,-0.635907390912604,0.0571062896238765,0.404432205353845,0.860969114287641,1.20650864583141,0.166318514556264,-2.46371886272226,-0.28234417353481,-0.162081923112627,1.77741926878764,0.751262921763743,0.753356395626086,-0.486506517792009,1.15556233897119,1.00844978225862,0.243144910967923,-0.925111474302481,-0.02668230956378,0.139117387937264,-0.581952277773593,-0.907383104003195,0.161210623565221],"z":[1.10971997117378,-1.18074094760658,0.303814706765046,0.372841207781702,-0.103677572918376,1.20524665803645,0.607968835156137,1.99656474540209,-0.692769622746904,2.54632457285632,0.874632922013975,1.30759732099872,-0.726168993923811,1.32694776777929,2.12371437914211,0.715771514411071,0.732834263198878,2.36781408625103,1.07506587657125,2.32264425646388,-0.0684535304514349,2.52127753245668,2.07004368230624,-0.475059307845872,1.85130010377117,-0.552500870054397,-1.28077445050116,1.33887769596841,2.5162458134759,-0.300995882715515,1.47376938523331,0.717511975320726,0.53695624282175,2.48191865235676,2.9527192494705,-0.280356704877358,0.193003681784135,2.426496895586,1.94114621327161,0.425138172234998,-0.256644584719852,0.476781092622327,3.42709821751067,0.256386869511849,0.305162085553007,2.54701415592904,0.310072861465853,0.440000536025278,2.00905467871358,0.234328562145999,0.287656487109469,1.98125654021898,2.18357944209172,0.536703776733405,0.68872627029122,-0.961174834351736,-0.753242125492006,3.41165972315515,1.51795469602654,0.0407952527923519,-0.0650739366811868,1.00134428310912,1.78978345937661,-0.675871476069601,3.40110723661003,2.03045343570493,3.48048985243666,2.27621729706215,-0.41436518545693,2.18996272369006,0.502468344151232,0.690667114407431,3.03816218638943,3.39579454136264,3.23477442805376,1.25065041957796,0.356222885820401,3.36849499899358,2.53070155197798,1.5632759158022,-0.341317925839859,0.797653757255201,-1.04499934835092,2.63177713515043,1.21539487621335,2.67370084072833,3.23245932166452,2.31271094125909,3.15617841879808,2.06040890363462,0.648203070218203,1.03035334616251,1.87878209116203,1.55640811763722,0.727544398277134,3.53403300448675,1.97219376575654,2.55541379268735,0.876590012840318,0.819816402861075,1.92743710003382,0.684055026650143,2.93607150736259,3.81734640987573,0.651571952865501,0.976175387410577,2.44834661184287,-1.11432493562004,3.18433580366291,-0.843071760827222,-0.248643133106145,0.986071117280719,-2.03807586577919,1.40590197861503,0.419702259104204,-1.09895658437781,3.41384351028013,1.02745688442651,-0.110228294448349,-0.567118051648555,0.179431563513769,1.67096136000713,0.680109082251084,2.20273994489515,-1.33723227605358,3.06469676093594,2.09967087299189,2.31394875079543,2.4555257624825,1.31673685134793,0.878187273348689,2.02980832769892,-1.5431312873352,1.51200335910576,2.35060236493575,3.07243798326916,0.140560981338653,-0.159975580286233,1.2931037379275,1.6580263955256,-1.15382731853135,1.02404917487958,1.03601005996425,1.30933258846173,0.293546649191405,2.15501295110262,3.35925313828235,0.876296505500621,0.644737717225919,1.43603661889152,0.450057990070528,1.20347519110766,0.0144850239883079,2.73632235483813,0.0490489926350552,2.38316482710281,1.85797997837882,2.58436679163881,0.798480782866081,1.79814153416351,1.38901205769165,0.654679020121071,0.0954983944830103,2.28875460863788,0.479037775964475,2.53310639343239,0.800169938041146,0.302413886345174,1.3484398925305,2.34603153038614,1.99296451094857,0.362097234290293,1.01833440511509,-0.408845152723946,0.431225703845764,-0.707667859032894,1.47002844112383,3.6977019290447,0.257277788740455,1.53502584872635,2.38003767034441,2.31248873906681,3.07107897435229,1.09644027696566,-2.1868023566456,1.35082239896414,1.08254919671833,4.28121478289258,1.23499169026669,2.02359396720763,1.34653475035937,2.81309219411612,1.43045213012156,1.43895339056298,0.00590109566043928,2.08930632836225,1.84901389204648,1.07746535089211,1.53916772087499,1.51553026570529],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[0.245161241959509,-0.810042706966922,-0.496672960582009,-0.290288781659072,-0.416014572802324,0.0859720375140756,0.0921258783843474,0.122887056263795,-1.41119526755817,1.21478596860656,0.157366681837586,0.298116763650492,-1.32923667349338,0.790169968463366,0.563023696562998,-0.795939299665589,-0.282612509948314,2.17547413553851,-0.284129265895805,0.9108937904041,-0.693396684056606,1.13465179510382,1.8459840576919,-0.549798490531451,0.639592811747285,-0.137023609788182,-2.11098001395678,0.00836303814382944,0.802319429075681,-1.26080977475963,-0.13153877358352,0.264420902941628,-0.144958769452775,1.40454532185512,1.77668957460508,-0.4491015186371,-1.03568935590814,1.39570437664854,1.3749714463219,-0.891599241841874,-0.633217424279408,-1.1315590546863,1.5969248101504,-0.309654697287888,-0.963678714893855,0.631958810404798,-0.406115827387461,0.183658987547114,1.90621250580121,-0.557486296974365,-0.228085081339571,0.586522966907534,0.78315693508935,-0.216142716707643,-0.176634488888188,-1.64806416302593,-1.61616784906664,1.77552692099951,0.521691637174122,-0.807375837068626,-1.21890918673952,-0.980849329100978,0.751578022513336,-1.60533410476373,1.62988681146652,0.298004458533601,1.6806534662361,0.234586649307705,-1.5012523493129,0.664009308308454,-1.13938870461448,-0.681190759634477,0.748422041097908,1.94238340373079,1.79299871885027,0.0239659712134909,-0.095989118638959,2.20210373310182,-0.668824886192503,0.414302286626269,-1.37605532838715,-1.22733036057881,-1.59770949836012,1.0699500633578,0.299433140554774,1.15277189109355,1.22101809676208,0.425471866746646,2.10615548852574,0.854942152640602,0.305879370727465,-1.00899899395785,0.619953308481931,0.939846803440841,-1.00368124509308,1.14008653417574,0.690446300828155,0.946524475994108,-0.870235766190593,-0.231128533506698,0.671204017902717,-0.598473702249974,1.18925436656721,2.17457707715504,-0.218166810933357,-0.152776163496661,0.419318941153033,-1.50316280556803,1.14834821105518,-1.4400977614422,-0.367249053486178,0.17844870459755,-1.43073566580724,-0.0211662746051213,-0.00769374033873965,-1.63023057673108,2.7300802704144,-0.482091217191152,-1.81214983487174,-0.196887213014989,-1.09715909080523,0.0929693188986826,-0.61918130145074,0.79180272900851,-2.54758811120863,0.864972927107392,0.989924711908617,1.00391832310997,0.759678413871795,0.710865756856507,0.180443900424624,0.726417994867126,-1.60016849545482,1.12918215285328,1.47939288917984,1.8379409726514,-0.946675889426327,0.161564474106839,0.556663043247537,0.143742780712765,-1.05995652572643,-0.0588143929620697,0.103521960342288,0.869325600153945,-0.626112558635561,0.270093258780405,0.508691731504305,0.831186345611338,-0.129163788980892,-0.0700549812021291,-1.92913833374983,-0.69648006765076,-0.0588177034060642,1.16857761731987,-0.0405991158086064,0.14188740277871,0.841509825531885,1.09638549243224,-0.696917812711084,0.547731381698303,0.766975340707562,-0.269358215599338,-0.972512672558092,0.865008709374792,0.00420886094731066,0.681689602838956,-0.597074830698138,-1.07346438954551,-0.328921536724472,0.436624743560598,0.494702459247002,-0.66654994059971,-0.553798528026596,-0.682247549251819,-0.85628394995556,-1.57256194934819,-0.51277728810822,1.77028194464225,-0.572223983801853,0.560116707070087,1.41995053650877,0.866915154321265,1.60507595889961,-0.175646334663282,-2.23595557682942,0.636419384854192,0.132909702652273,2.76293077671523,-0.562660151440724,0.56182105604113,0.834456516818865,1.28746972256531,-0.540617812142931,0.23683171692123,-0.642129461954855,1.43573456288046,0.926659956356879,0.545517420418645,1.5305230609095,0.428161540241519],"y":[-0.235518070340648,-2.45240114824329,-0.644977102668746,-0.752751994425032,-1.30776731856761,0.0601378296228902,-0.799270043933544,1.15367722139551,-1.15414669499537,0.847149491130221,-0.483562151875585,-0.00579166371028117,-1.28381867645574,-0.47020137312235,0.89518291501062,0.242798961623441,-0.246152472682681,-0.368553656666437,0.244266588082482,0.831498360200626,-0.980065146646265,0.891502178347759,-0.464449870169526,-1.70452873644919,0.429450549296421,-2.22793442034749,-1.29436884538855,0.328648311753084,1.21664637440336,-0.744855416320498,0.661252536715995,-0.815074868255698,-0.663631956574116,0.565381680025143,0.865809708866239,-1.52707913267423,-0.264262171601064,0.495048686987777,-0.177576500277566,-0.076731585023236,-1.30908876966406,0.237003828374522,1.7232587133783,-0.89974941918172,-0.176046521516956,1.43096176800729,-0.726594014862142,-1.13075786614039,-0.611805466268342,-0.683429687160743,-0.936648152847723,0.66817244620447,0.760571194983721,-0.592808675159742,-0.415141912182319,-1.30071381610594,-1.03556340312276,1.52260161059274,0.071143998520118,-0.710016303285978,-0.449724652862997,0.8356700891989,0.229584417966709,-0.935867648250804,1.65316673934698,1.02697223384404,1.71580382147259,1.44148127358026,-0.666368988540678,0.888837795476519,0.281529551915423,0.0921869930157002,2.01613858082902,1.33308058244359,1.25243653402571,0.187006412411344,-0.970792117389861,1.03436090683104,2.70844174467451,0.243277948747478,-0.687212781442045,0.791164655171137,-1.47081778648488,1.11406048537057,-0.138825818879375,1.09112966560324,1.82110986127213,1.30272983356553,0.82699975112784,0.51282806535089,-0.955546057616568,0.905261272703474,0.488350034548716,-0.292077708302782,0.467359312573874,2.33286097074737,0.551302291623219,1.12839558350128,0.546836140190226,-0.173376249606874,0.506606480659064,2.40959779292393e-05,1.42946242817853,1.70310386403805,-0.426687186459605,-0.0283586416890512,1.50264800285024,-1.66440103251857,1.82503186411959,-1.33996154122608,-1.56362649529485,-0.345446752825915,-3.05647235822099,0.453926599711493,-0.968402676713218,-1.51537847386661,0.571167957070676,0.374215693456776,0.0790097698875623,-2.18895250511234,-0.222181177090204,0.71844726533925,0.0150946317514682,0.779297547926592,-0.938414784640164,1.93749422988598,0.433934033736125,0.726051676539831,1.17254445961667,-0.405484184988862,-0.501561725698746,0.597637114644797,-2.17997584508201,-0.544848427045872,0.302939416384703,0.975585073389433,-0.428193781576418,-1.96577209028799,-0.285043061980494,0.649195282837274,-2.16403928794774,-0.053929287267917,-0.1991786618799,-0.574521546695145,-0.530206158291824,1.23282559845109,2.71457025026966,-1.15500526781127,-0.525453402182902,0.54586479241777,0.996407246649767,0.840059267746597,-1.49616047809717,1.16478324524806,-1.46500196762785,1.68696270588163,0.237076213522748,1.01989599413667,0.261933572461807,0.445371165620171,-0.358343474063163,-0.371057114285668,-0.466732122524142,0.82896965862136,-0.895540253913167,1.36136274343507,0.164503669270383,-0.0701868457336373,0.679593167424365,1.33917779836163,0.776718626335842,-0.39183936904355,0.432890890990184,-1.47748802755464,-0.103350403179884,-1.01406320789962,1.03714684537001,1.93647830964937,-0.635907390912604,0.0571062896238765,0.404432205353845,0.860969114287641,1.20650864583141,0.166318514556264,-2.46371886272226,-0.28234417353481,-0.162081923112627,1.77741926878764,0.751262921763743,0.753356395626086,-0.486506517792009,1.15556233897119,1.00844978225862,0.243144910967923,-0.925111474302481,-0.02668230956378,0.139117387937264,-0.581952277773593,-0.907383104003195,0.161210623565221],"z":[1.10971997117378,-1.18074094760658,0.303814706765046,0.372841207781702,-0.103677572918376,1.20524665803645,0.607968835156137,1.99656474540209,-0.692769622746904,2.54632457285632,0.874632922013975,1.30759732099872,-0.726168993923811,1.32694776777929,2.12371437914211,0.715771514411071,0.732834263198878,2.36781408625103,1.07506587657125,2.32264425646388,-0.0684535304514349,2.52127753245668,2.07004368230624,-0.475059307845872,1.85130010377117,-0.552500870054397,-1.28077445050116,1.33887769596841,2.5162458134759,-0.300995882715515,1.47376938523331,0.717511975320726,0.53695624282175,2.48191865235676,2.9527192494705,-0.280356704877358,0.193003681784135,2.426496895586,1.94114621327161,0.425138172234998,-0.256644584719852,0.476781092622327,3.42709821751067,0.256386869511849,0.305162085553007,2.54701415592904,0.310072861465853,0.440000536025278,2.00905467871358,0.234328562145999,0.287656487109469,1.98125654021898,2.18357944209172,0.536703776733405,0.68872627029122,-0.961174834351736,-0.753242125492006,3.41165972315515,1.51795469602654,0.0407952527923519,-0.0650739366811868,1.00134428310912,1.78978345937661,-0.675871476069601,3.40110723661003,2.03045343570493,3.48048985243666,2.27621729706215,-0.41436518545693,2.18996272369006,0.502468344151232,0.690667114407431,3.03816218638943,3.39579454136264,3.23477442805376,1.25065041957796,0.356222885820401,3.36849499899358,2.53070155197798,1.5632759158022,-0.341317925839859,0.797653757255201,-1.04499934835092,2.63177713515043,1.21539487621335,2.67370084072833,3.23245932166452,2.31271094125909,3.15617841879808,2.06040890363462,0.648203070218203,1.03035334616251,1.87878209116203,1.55640811763722,0.727544398277134,3.53403300448675,1.97219376575654,2.55541379268735,0.876590012840318,0.819816402861075,1.92743710003382,0.684055026650143,2.93607150736259,3.81734640987573,0.651571952865501,0.976175387410577,2.44834661184287,-1.11432493562004,3.18433580366291,-0.843071760827222,-0.248643133106145,0.986071117280719,-2.03807586577919,1.40590197861503,0.419702259104204,-1.09895658437781,3.41384351028013,1.02745688442651,-0.110228294448349,-0.567118051648555,0.179431563513769,1.67096136000713,0.680109082251084,2.20273994489515,-1.33723227605358,3.06469676093594,2.09967087299189,2.31394875079543,2.4555257624825,1.31673685134793,0.878187273348689,2.02980832769892,-1.5431312873352,1.51200335910576,2.35060236493575,3.07243798326916,0.140560981338653,-0.159975580286233,1.2931037379275,1.6580263955256,-1.15382731853135,1.02404917487958,1.03601005996425,1.30933258846173,0.293546649191405,2.15501295110262,3.35925313828235,0.876296505500621,0.644737717225919,1.43603661889152,0.450057990070528,1.20347519110766,0.0144850239883079,2.73632235483813,0.0490489926350552,2.38316482710281,1.85797997837882,2.58436679163881,0.798480782866081,1.79814153416351,1.38901205769165,0.654679020121071,0.0954983944830103,2.28875460863788,0.479037775964475,2.53310639343239,0.800169938041146,0.302413886345174,1.3484398925305,2.34603153038614,1.99296451094857,0.362097234290293,1.01833440511509,-0.408845152723946,0.431225703845764,-0.707667859032894,1.47002844112383,3.6977019290447,0.257277788740455,1.53502584872635,2.38003767034441,2.31248873906681,3.07107897435229,1.09644027696566,-2.1868023566456,1.35082239896414,1.08254919671833,4.28121478289258,1.23499169026669,2.02359396720763,1.34653475035937,2.81309219411612,1.43045213012156,1.43895339056298,0.00590109566043928,2.08930632836225,1.84901389204648,1.07746535089211,1.53916772087499,1.51553026570529],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
class: just-img
<div id="htmlwidget-9d966e4e33c4af8ba8d7" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-9d966e4e33c4af8ba8d7">{"x":{"visdat":{"16654667c6109":["function () ","plotlyVisDat"]},"cur_data":"16654667c6109","attrs":{"16654667c6109":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"16654667c6109.1":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Covariates"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[0.245161241959509,-0.810042706966922,-0.496672960582009,-0.290288781659072,-0.416014572802324,0.0859720375140756,0.0921258783843474,0.122887056263795,-1.41119526755817,1.21478596860656,0.157366681837586,0.298116763650492,-1.32923667349338,0.790169968463366,0.563023696562998,-0.795939299665589,-0.282612509948314,2.17547413553851,-0.284129265895805,0.9108937904041,-0.693396684056606,1.13465179510382,1.8459840576919,-0.549798490531451,0.639592811747285,-0.137023609788182,-2.11098001395678,0.00836303814382944,0.802319429075681,-1.26080977475963,-0.13153877358352,0.264420902941628,-0.144958769452775,1.40454532185512,1.77668957460508,-0.4491015186371,-1.03568935590814,1.39570437664854,1.3749714463219,-0.891599241841874,-0.633217424279408,-1.1315590546863,1.5969248101504,-0.309654697287888,-0.963678714893855,0.631958810404798,-0.406115827387461,0.183658987547114,1.90621250580121,-0.557486296974365,-0.228085081339571,0.586522966907534,0.78315693508935,-0.216142716707643,-0.176634488888188,-1.64806416302593,-1.61616784906664,1.77552692099951,0.521691637174122,-0.807375837068626,-1.21890918673952,-0.980849329100978,0.751578022513336,-1.60533410476373,1.62988681146652,0.298004458533601,1.6806534662361,0.234586649307705,-1.5012523493129,0.664009308308454,-1.13938870461448,-0.681190759634477,0.748422041097908,1.94238340373079,1.79299871885027,0.0239659712134909,-0.095989118638959,2.20210373310182,-0.668824886192503,0.414302286626269,-1.37605532838715,-1.22733036057881,-1.59770949836012,1.0699500633578,0.299433140554774,1.15277189109355,1.22101809676208,0.425471866746646,2.10615548852574,0.854942152640602,0.305879370727465,-1.00899899395785,0.619953308481931,0.939846803440841,-1.00368124509308,1.14008653417574,0.690446300828155,0.946524475994108,-0.870235766190593,-0.231128533506698,0.671204017902717,-0.598473702249974,1.18925436656721,2.17457707715504,-0.218166810933357,-0.152776163496661,0.419318941153033,-1.50316280556803,1.14834821105518,-1.4400977614422,-0.367249053486178,0.17844870459755,-1.43073566580724,-0.0211662746051213,-0.00769374033873965,-1.63023057673108,2.7300802704144,-0.482091217191152,-1.81214983487174,-0.196887213014989,-1.09715909080523,0.0929693188986826,-0.61918130145074,0.79180272900851,-2.54758811120863,0.864972927107392,0.989924711908617,1.00391832310997,0.759678413871795,0.710865756856507,0.180443900424624,0.726417994867126,-1.60016849545482,1.12918215285328,1.47939288917984,1.8379409726514,-0.946675889426327,0.161564474106839,0.556663043247537,0.143742780712765,-1.05995652572643,-0.0588143929620697,0.103521960342288,0.869325600153945,-0.626112558635561,0.270093258780405,0.508691731504305,0.831186345611338,-0.129163788980892,-0.0700549812021291,-1.92913833374983,-0.69648006765076,-0.0588177034060642,1.16857761731987,-0.0405991158086064,0.14188740277871,0.841509825531885,1.09638549243224,-0.696917812711084,0.547731381698303,0.766975340707562,-0.269358215599338,-0.972512672558092,0.865008709374792,0.00420886094731066,0.681689602838956,-0.597074830698138,-1.07346438954551,-0.328921536724472,0.436624743560598,0.494702459247002,-0.66654994059971,-0.553798528026596,-0.682247549251819,-0.85628394995556,-1.57256194934819,-0.51277728810822,1.77028194464225,-0.572223983801853,0.560116707070087,1.41995053650877,0.866915154321265,1.60507595889961,-0.175646334663282,-2.23595557682942,0.636419384854192,0.132909702652273,2.76293077671523,-0.562660151440724,0.56182105604113,0.834456516818865,1.28746972256531,-0.540617812142931,0.23683171692123,-0.642129461954855,1.43573456288046,0.926659956356879,0.545517420418645,1.5305230609095,0.428161540241519],"y":[0.198145658585591,0.277552220709875,-0.17004430403327,0.0141945028452178,0.130991978288711,-0.0223864083242179,0.299050333706881,-0.400071535193041,-0.622321867370636,0.477369128112254,0.228219911128996,0.1504434620623,-0.517100751472447,0.666251967060929,0.00341078239791149,-0.707127906349703,-0.167371779884967,1.59845598388121,-0.349402449764234,0.270420008145622,-0.184100479198394,0.404908675532562,1.40319947441653,0.183751683786099,0.228868496448752,0.66583539467622,-1.06042798479971,-0.175795434085825,0.0522949552646222,-0.668084099000474,-0.396460582530579,0.42548896988379,0.0830394346916911,0.714175472418001,0.863815868076102,0.188759101799916,-0.687842934100577,0.733940302930694,0.967631853391893,-0.656180287760782,-0.0205623906845052,-0.939923279797371,0.421574319417812,0.0548817027015812,-0.669987835059429,-0.146041740352068,-0.0765369533658583,0.485445427934205,1.4997348972606,-0.198424298105787,0.125596390665453,0.10362912843515,0.207176956335393,0.00707625873872065,-0.0308285777528834,-0.734045539226264,-0.80956095063085,0.620640030288102,0.278555938448834,-0.363536281314395,-0.747659531201449,-1.05533958014811,0.381010501846681,-0.838765938782806,0.470512274366329,-0.230734100362488,0.482935299266456,-0.428084043068053,-0.8653560823757,0.076442115456262,-0.96183441779795,-0.571226789104233,-0.280452862338122,0.807374492128225,0.732563574865369,-0.112606276055601,0.230662987354407,1.09940890660921,-1.52799165931871,0.139864453598939,-0.770026625078456,-1.21145340614029,-0.636027414886943,0.27749149331516,0.200455697576234,0.343928446623055,0.122331687057895,-0.243263890857569,1.10876322308939,0.348845999354931,0.506344999950185,-1.10072410347239,0.193386416797567,0.705296554787272,-0.935412009937147,-0.123161060799495,0.219501575677066,0.185803805046839,-0.871327822131594,-0.158188061875927,0.222525124433152,-0.479315930472118,0.244618418526958,0.833368222745314,-0.0556408955753799,-0.156854173863393,-0.32134249909723,-0.498410811926866,0.0700155135658555,-0.573986302840107,0.259542125203813,0.192011531760126,0.0659747314907233,-0.242694741571403,0.291588027568699,-0.642348884731412,1.63991474935949,-0.535928176881998,-1.35803563070201,0.609546203322048,-0.74640000509554,-0.26041027498968,-0.499372409975856,0.206318823371502,-1.49740382759535,-0.169846785909299,0.472446381425511,0.374447933436545,0.0387202385201899,0.58685780811132,0.251015964968836,0.227583804856012,-0.376063160777987,0.931105914648054,0.863412269828558,0.866183773055188,-0.565041303690104,0.77810685106947,0.434472076374553,-0.19931426194447,-0.00379551151959088,-0.0816451416865663,0.085588600566701,0.76015596952467,-0.303003509165721,-0.326233639715929,-0.70599149932151,0.947662082757829,0.0431068208454495,-0.310842836780398,-1.77845530623747,-0.8579007425667,0.450548517367754,0.327813637201704,0.451803764661213,-0.583558320192478,0.441198225599916,0.330743817968371,-0.644873704937972,0.158690648162077,0.608739180444085,-0.112002864066215,-0.568906065594855,0.239233564517148,0.273032974513515,-0.0855475343008529,-0.539031127535746,-0.785900957432873,-0.541396370544265,-0.248906496215809,-0.000699720744197767,-0.382368237032686,-0.607774957694084,0.00725732702756457,-0.62163700575057,-0.786970581698991,-0.802035844027277,0.46424440985512,-0.226276823583403,0.31063352525029,0.784350892429815,0.228759995791317,0.617965437022913,-0.244700874161413,-0.716410452148972,0.48930560195873,0.0924709977622171,1.21779277538127,-0.731460169664004,0.0549041653313516,0.703269292499075,0.414440706275825,-0.810934742520497,0.0156841469145232,-0.168491811473749,0.954484753323337,0.536950984179449,0.536232248741156,1.34582303018465,0.179849494909657],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.245161241959509,-0.810042706966922,-0.496672960582009,-0.290288781659072,-0.416014572802324,0.0859720375140756,0.0921258783843474,0.122887056263795,-1.41119526755817,1.21478596860656,0.157366681837586,0.298116763650492,-1.32923667349338,0.790169968463366,0.563023696562998,-0.795939299665589,-0.282612509948314,2.17547413553851,-0.284129265895805,0.9108937904041,-0.693396684056606,1.13465179510382,1.8459840576919,-0.549798490531451,0.639592811747285,-0.137023609788182,-2.11098001395678,0.00836303814382944,0.802319429075681,-1.26080977475963,-0.13153877358352,0.264420902941628,-0.144958769452775,1.40454532185512,1.77668957460508,-0.4491015186371,-1.03568935590814,1.39570437664854,1.3749714463219,-0.891599241841874,-0.633217424279408,-1.1315590546863,1.5969248101504,-0.309654697287888,-0.963678714893855,0.631958810404798,-0.406115827387461,0.183658987547114,1.90621250580121,-0.557486296974365,-0.228085081339571,0.586522966907534,0.78315693508935,-0.216142716707643,-0.176634488888188,-1.64806416302593,-1.61616784906664,1.77552692099951,0.521691637174122,-0.807375837068626,-1.21890918673952,-0.980849329100978,0.751578022513336,-1.60533410476373,1.62988681146652,0.298004458533601,1.6806534662361,0.234586649307705,-1.5012523493129,0.664009308308454,-1.13938870461448,-0.681190759634477,0.748422041097908,1.94238340373079,1.79299871885027,0.0239659712134909,-0.095989118638959,2.20210373310182,-0.668824886192503,0.414302286626269,-1.37605532838715,-1.22733036057881,-1.59770949836012,1.0699500633578,0.299433140554774,1.15277189109355,1.22101809676208,0.425471866746646,2.10615548852574,0.854942152640602,0.305879370727465,-1.00899899395785,0.619953308481931,0.939846803440841,-1.00368124509308,1.14008653417574,0.690446300828155,0.946524475994108,-0.870235766190593,-0.231128533506698,0.671204017902717,-0.598473702249974,1.18925436656721,2.17457707715504,-0.218166810933357,-0.152776163496661,0.419318941153033,-1.50316280556803,1.14834821105518,-1.4400977614422,-0.367249053486178,0.17844870459755,-1.43073566580724,-0.0211662746051213,-0.00769374033873965,-1.63023057673108,2.7300802704144,-0.482091217191152,-1.81214983487174,-0.196887213014989,-1.09715909080523,0.0929693188986826,-0.61918130145074,0.79180272900851,-2.54758811120863,0.864972927107392,0.989924711908617,1.00391832310997,0.759678413871795,0.710865756856507,0.180443900424624,0.726417994867126,-1.60016849545482,1.12918215285328,1.47939288917984,1.8379409726514,-0.946675889426327,0.161564474106839,0.556663043247537,0.143742780712765,-1.05995652572643,-0.0588143929620697,0.103521960342288,0.869325600153945,-0.626112558635561,0.270093258780405,0.508691731504305,0.831186345611338,-0.129163788980892,-0.0700549812021291,-1.92913833374983,-0.69648006765076,-0.0588177034060642,1.16857761731987,-0.0405991158086064,0.14188740277871,0.841509825531885,1.09638549243224,-0.696917812711084,0.547731381698303,0.766975340707562,-0.269358215599338,-0.972512672558092,0.865008709374792,0.00420886094731066,0.681689602838956,-0.597074830698138,-1.07346438954551,-0.328921536724472,0.436624743560598,0.494702459247002,-0.66654994059971,-0.553798528026596,-0.682247549251819,-0.85628394995556,-1.57256194934819,-0.51277728810822,1.77028194464225,-0.572223983801853,0.560116707070087,1.41995053650877,0.866915154321265,1.60507595889961,-0.175646334663282,-2.23595557682942,0.636419384854192,0.132909702652273,2.76293077671523,-0.562660151440724,0.56182105604113,0.834456516818865,1.28746972256531,-0.540617812142931,0.23683171692123,-0.642129461954855,1.43573456288046,0.926659956356879,0.545517420418645,1.5305230609095,0.428161540241519],"y":[0.198145658585591,0.277552220709875,-0.17004430403327,0.0141945028452178,0.130991978288711,-0.0223864083242179,0.299050333706881,-0.400071535193041,-0.622321867370636,0.477369128112254,0.228219911128996,0.1504434620623,-0.517100751472447,0.666251967060929,0.00341078239791149,-0.707127906349703,-0.167371779884967,1.59845598388121,-0.349402449764234,0.270420008145622,-0.184100479198394,0.404908675532562,1.40319947441653,0.183751683786099,0.228868496448752,0.66583539467622,-1.06042798479971,-0.175795434085825,0.0522949552646222,-0.668084099000474,-0.396460582530579,0.42548896988379,0.0830394346916911,0.714175472418001,0.863815868076102,0.188759101799916,-0.687842934100577,0.733940302930694,0.967631853391893,-0.656180287760782,-0.0205623906845052,-0.939923279797371,0.421574319417812,0.0548817027015812,-0.669987835059429,-0.146041740352068,-0.0765369533658583,0.485445427934205,1.4997348972606,-0.198424298105787,0.125596390665453,0.10362912843515,0.207176956335393,0.00707625873872065,-0.0308285777528834,-0.734045539226264,-0.80956095063085,0.620640030288102,0.278555938448834,-0.363536281314395,-0.747659531201449,-1.05533958014811,0.381010501846681,-0.838765938782806,0.470512274366329,-0.230734100362488,0.482935299266456,-0.428084043068053,-0.8653560823757,0.076442115456262,-0.96183441779795,-0.571226789104233,-0.280452862338122,0.807374492128225,0.732563574865369,-0.112606276055601,0.230662987354407,1.09940890660921,-1.52799165931871,0.139864453598939,-0.770026625078456,-1.21145340614029,-0.636027414886943,0.27749149331516,0.200455697576234,0.343928446623055,0.122331687057895,-0.243263890857569,1.10876322308939,0.348845999354931,0.506344999950185,-1.10072410347239,0.193386416797567,0.705296554787272,-0.935412009937147,-0.123161060799495,0.219501575677066,0.185803805046839,-0.871327822131594,-0.158188061875927,0.222525124433152,-0.479315930472118,0.244618418526958,0.833368222745314,-0.0556408955753799,-0.156854173863393,-0.32134249909723,-0.498410811926866,0.0700155135658555,-0.573986302840107,0.259542125203813,0.192011531760126,0.0659747314907233,-0.242694741571403,0.291588027568699,-0.642348884731412,1.63991474935949,-0.535928176881998,-1.35803563070201,0.609546203322048,-0.74640000509554,-0.26041027498968,-0.499372409975856,0.206318823371502,-1.49740382759535,-0.169846785909299,0.472446381425511,0.374447933436545,0.0387202385201899,0.58685780811132,0.251015964968836,0.227583804856012,-0.376063160777987,0.931105914648054,0.863412269828558,0.866183773055188,-0.565041303690104,0.77810685106947,0.434472076374553,-0.19931426194447,-0.00379551151959088,-0.0816451416865663,0.085588600566701,0.76015596952467,-0.303003509165721,-0.326233639715929,-0.70599149932151,0.947662082757829,0.0431068208454495,-0.310842836780398,-1.77845530623747,-0.8579007425667,0.450548517367754,0.327813637201704,0.451803764661213,-0.583558320192478,0.441198225599916,0.330743817968371,-0.644873704937972,0.158690648162077,0.608739180444085,-0.112002864066215,-0.568906065594855,0.239233564517148,0.273032974513515,-0.0855475343008529,-0.539031127535746,-0.785900957432873,-0.541396370544265,-0.248906496215809,-0.000699720744197767,-0.382368237032686,-0.607774957694084,0.00725732702756457,-0.62163700575057,-0.786970581698991,-0.802035844027277,0.46424440985512,-0.226276823583403,0.31063352525029,0.784350892429815,0.228759995791317,0.617965437022913,-0.244700874161413,-0.716410452148972,0.48930560195873,0.0924709977622171,1.21779277538127,-0.731460169664004,0.0549041653313516,0.703269292499075,0.414440706275825,-0.810934742520497,0.0156841469145232,-0.168491811473749,0.954484753323337,0.536950984179449,0.536232248741156,1.34582303018465,0.179849494909657],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
### Reason 3: Multiple regression exists
- Regressing out the confounder beforehand can remove the effect of your covariate of interest
- Ordinary least-squares regression yields estimates for each covariate controlling for all other variables in the model
- So what if we just fit a model with both the confounder and the independent variable?
---
class: img-caption
![](jane_618_f2.gif)
Answer: Looks great, let's do this instead
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
### Reason 4: Even if you really like two-step &lt;br&gt; regression, there's a better way
- Lindquist et al. (2019) suggest that there is a correct way to use modular preprocessing pipelines
- In our earlier model, let's say you regress out the confounder `\(z_i\)` out of the outcome `\(y_i\)`, but also out of the covariate of interest `\(x_i\)`
    - Now you are isolating the effect of `\(x_i\)` independent of `\(z_i\)`
---
class: img-caption
![](hbm24528-fig-0003-ml.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Key Takeaways
- Avoid "residual" or "two-step" regression
    - Just use multiple regression instead
- When dealing with modular pipelines, do one of the following
    - Regress out all confounders simultaneously
    - For each new step, regress the confounders on all confounders from previous steps
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
