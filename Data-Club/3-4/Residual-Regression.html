<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Why Everyone Should Stop Regressing on Residuals</title>
    <meta charset="utf-8" />
    <meta name="author" content="Andrew Chen" />
    <script src="Residual-Regression_files/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="Residual-Regression_files/plotly-binding-4.9.1/plotly.js"></script>
    <script src="Residual-Regression_files/typedarray-0.1/typedarray.min.js"></script>
    <script src="Residual-Regression_files/jquery-1.11.3/jquery.min.js"></script>
    <link href="Residual-Regression_files/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="Residual-Regression_files/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link href="Residual-Regression_files/plotly-htmlwidgets-css-1.49.4/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="Residual-Regression_files/plotly-main-1.49.4/plotly-latest.min.js"></script>
    <link rel="stylesheet" href="PennSIVE-theme.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

# Why Everyone Should Stop Regressing on Residuals
### Andrew Chen

---




&lt;style type="text/css"&gt;
.remark-slide-content.img-caption {
  background-image: none;
  text-align: center;
  padding-top: 61.5%;
}
.remark-slide-content.img-caption &gt; p:first-of-type {
  padding: 0px;
  margin: 0px;
}
.remark-slide-content.img-caption &gt; p:first-of-type &gt; img {
  position: absolute;
  top: 0px;
  left: 0px;
  width: 95%;
  height: 75%;
  margin: 2.5% 2.5% 2.5% 2.5%;
  object-fit: contain;
}

.remark-slide-content.just-img {
  background-image: none;
  text-align: center;
  padding-top: 0px;
}
&lt;/style&gt;

### Reason 1: It can reintroduce unwanted effects
- Recent paper by Lindquist et al. showed that motion artifacts removed from one preprocessing step can be reintroduced by another preprocessing step&lt;sup&gt;1&lt;/sup&gt;
- Let's dive into why this happens
.footnote[
&lt;sup&gt;1&lt;/sup&gt; [Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0001-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](hbm24528-fig-0003-mr.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
class: img-caption
![](https://onlinelibrary.wiley.com/cms/asset/0f891eac-2a43-4632-990f-5db53f241434/hbm24528-fig-0006-m.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Reason 2: You are not properly controlling for confounders
- Suppose we have `\(n\)` observations indexed by `\(i\)` with
    - Dependent variable `\(y_i\)`
    - Covariate of interest `\(x_i\)`
    - Confounder `\(z_i\)` that is correlated with `\(x_i\)`

`$$y_i=\beta_0+\beta_1x_i+\beta_2z_i+\epsilon_i$$`
- How can we get an estimate of `\(\beta_1\)`?
- What if we first regress out the confounder, then regress the residuals on the covariate of interest?
---
class: img-caption
![](jane_618_f1.gif)
Answer: We get very poor estimates, even with larger samples
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
class: just-img


<div id="htmlwidget-958af00d64fc60235a98" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-958af00d64fc60235a98">{"x":{"visdat":{"1671e16fb2b9b":["function () ","plotlyVisDat"]},"cur_data":"1671e16fb2b9b","attrs":{"1671e16fb2b9b":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d"},"1671e16fb2b9b.1":{"x":{},"y":{},"z":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter3d","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"scene":{"xaxis":{"title":"Covariate"},"yaxis":{"title":"Confounder"},"zaxis":{"title":"Outcome"},"camera":{"eye":{"x":1.5,"y":-1.5,"z":1.5}}},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.282706435924042,-0.989905958545667,0.126332295231102,-0.0439865179492621,0.613573301375285,0.772546937926567,0.404933977935141,-0.26047715973453,-0.241718195796561,-0.154764562548029,1.72000224034958,0.1687460264977,-1.99417913708834,2.10923788217206,0.793123324160926,0.748539390021518,0.91939607809767,-1.08411244692864,-0.52104208877702,-0.97079601222378,0.659661576226051,-0.618555500100488,-1.38722527897953,-0.481486401603664,-0.701542779014234,0.494100050259395,-0.385032703323868,0.728752463437646,-0.95283909605305,-0.83107503541255,-2.27625341097421,0.136552371452572,-0.411033993121315,0.690358682259533,-0.47735218964677,1.56567479542373,2.25602644310682,-1.84259208717837,-0.388094045482264,-0.163470125115565,-1.58330315048353,2.17276367627875,0.920333235058868,1.49703940972565,1.99796079329351,1.64304335816965,1.07269892603867,0.484849886249964,0.215642465415438,0.229547670334693,0.120586674804604,-0.90045554543729,-0.00278387740985842,-0.083219166671481,0.150892579584813,0.0543471749909521,0.67757678508404,-0.962668773713611,-0.0416178836621031,-0.195754089015166,1.2002400883762,0.641695464301415,-0.111575768558591,0.472671382215179,0.805859276668295,0.126171011037116,-0.647321107612405,-0.909000213712239,0.138176772483927,0.291962603865023,1.24699822887246,0.521610517398754,-0.299493059689326,-0.479040910367962,-0.431361992300117,-1.53971977425668,0.918926552950096,0.0276513951722482,-0.519359507771314,0.349818012118216,-0.284197121077959,-0.0161096134817162,-1.05440009464499,0.351018695612584,0.317350539808789,0.037171381692051,1.34498216343164,-0.147812685661594,0.501451899567603,-1.94268726597052,0.304474837735088,0.949501433146191,-0.294402987329566,2.69150275703525,-0.433693288328064,0.801674299259555,-1.1792120056706,-0.311724860400697,-0.466495096434508,-0.0771692975658047,-0.463502611981029,-1.36819418919539,-0.0338291660914598,0.135726139968183,0.381519143571937,0.248645388456964,0.337965287706855,0.962002489321037,1.38155032982764,0.314103705128498,-1.57143295536483,-0.1484894867629,1.53791257714615,-2.99541763984507,-0.88562204672817,0.0884086506105778,-0.467190375389997,-0.656027522993324,0.122693385624736,-0.154578124941751,-1.23709390959606,-0.60760036283672,-0.840759740067271,-0.0146574800228469,0.546276421401282,-0.354342132633884,-0.334034928664152,-0.429386022744351,-0.927475432072284,-0.0337236372480541,0.622745525059592,1.36193189428565,-2.67095440865002,1.12524210195061,1.5300160635851,0.710480142029934,1.51737208409636,0.482857885460717,-2.10763911607056,-0.729167024405984,-0.527536149753938,-0.337474483393729,-0.667960681957032,1.10877838380206,1.33400437298996,-1.83488162417154,-0.534410410199578,0.672659635544956,-1.80898348591937,0.847350208266534,-0.258270454653911,1.10106277185931,-0.705732455969561,0.81986164939179,-0.00681465128853309,-1.22964056248674,-0.97508684681489,0.542355515209885,-1.37400791885759,0.854269327333779,0.466441252267595,0.228503251840353,-0.171117371098266,-1.68362592598207,0.991142540960915,-0.920106620189626,-1.21283076822599,1.72180913069004,-0.309575676134545,-0.00894893641686356,-0.0756084265020482,0.731583306099788,-0.168664109863237,1.90657741225299,1.14279426303128,-1.17650826506036,-2.04562140841024,0.459299795235651,0.189712660084609,1.79674125113901,-0.0555518179358971,0.333972793529478,1.31364255418668,0.699785663108447,-0.962344007015275,-1.19283039689088,-1.24325350129758,0.0218441402810769,1.60738306049114,0.375866820054364,0.703111252458003,1.58770405491929,1.05346166810802,-0.648123993643822,-0.141494005340406,-0.216607933187856,0.0598537305142393,-0.228866189941551,-0.152380364419876,-1.05192319340803],"y":[0.438196571805565,-0.457941320514031,-0.335577775399676,-0.052436226655734,-0.416640399897486,0.4511749238428,1.90780343685753,-0.625521419548448,-0.648323648479108,-0.32505808534984,0.672840910875781,-0.674028125392728,-0.802239940792353,1.35969230528895,0.860654983816084,1.24828518816902,0.953080014201644,-0.935193535769945,-0.70215047806312,-0.88005735560699,0.0488102572544414,-0.210327339164271,-1.80470026601825,0.0292260024955414,-0.394122100569616,0.562650696526805,0.371044962527633,1.16951179139772,-1.27570010168808,-1.13320748332412,-1.80988280330007,0.117344406209253,-0.789395289946675,0.0458322034221038,-0.211445705923892,0.984874782668581,1.38339455722408,-1.88416378080799,-0.693326675799336,-0.634500649233758,-0.843042738847609,1.21362522465023,1.02446878273468,1.7237599017708,1.96704852534686,0.683206247311966,0.835812955843644,0.398371471115601,0.428280422623251,0.600806732212357,-0.0301696767917184,-1.42722106858458,-0.265987029103612,0.798850617051365,0.197840565300716,0.373195351742203,0.208019823355496,-1.65566880851484,1.03984352238247,-0.559294929120092,0.360515162439828,0.230718800016962,0.686396434828499,0.555023985736764,1.08840061814475,0.930179869394872,-0.268528600863926,-0.862549563439105,-0.100077856611728,-0.323039197321836,0.490962558718686,0.500474917715339,-0.595757219448595,0.350492452115569,-0.0435833068324499,-1.50748617928155,0.815907323074298,-0.345710650766951,-0.718904804685577,-0.155164032464647,-0.316587516553619,-0.178461796701099,-0.520684394778411,0.681043059491253,0.0297507084654008,0.699265588841657,0.543160047795648,0.146329338276701,0.395526589494249,-2.21082212970909,0.770269715030611,0.869100694072453,0.0117409377674627,2.72453410318498,-0.461621495068692,0.501650780456745,-2.90307517701359,-0.275822908063452,-0.321845296418233,-0.579277078255049,-1.69443419615903,-1.2960285052825,-1.24763547618882,-0.11592235546034,0.464360362309029,0.469405114956564,0.63101959079004,1.78262903237684,0.836434234169961,0.14603501681755,-1.03229461004969,-0.0937087324905596,1.32595840789209,-2.84432909947215,-1.05660525262989,0.0971491731072381,0.379638411530176,0.257349684085774,0.100761080028662,-0.422927827769216,-1.84655552528488,-0.972891188057471,-1.27128519179179,-0.015196921184954,0.246635400725224,0.194379808325215,-0.0445163452521927,-1.32111684668939,-0.9510657910148,-0.560790454216747,-0.343826219238089,2.30869565132695,-2.01520164677116,0.186275949656534,2.14085908674684,0.602270144596951,1.37580541342225,0.0654313659818365,-3.30047952011714,-1.91789801257567,-0.788030366717372,0.000504126719744202,-0.736009214586245,1.04017343011177,0.833454726791221,-1.24658090685019,-0.861021794628406,1.1285316500162,-0.998589225666122,1.32319238471478,-0.32896787966092,0.42747712940134,-0.0492169586432136,-0.00869902104748899,-0.813812704477014,-0.858810665238317,-1.40391430597732,-0.741040140367373,-0.504824174097421,-0.479715817740938,0.323195453566344,0.744753086596251,-0.715647015269477,-2.15467858769085,1.12661099721572,-1.22746899163974,-1.54134992518736,1.01056668248384,-1.29680286162978,-1.4320579623711,0.257995231544807,0.45974811149275,0.358647213968039,1.97963492033594,1.31530960974496,-0.832315437500114,-1.19620465972181,0.427353619134546,1.64559904728611,0.617692990189337,-0.642061657371722,-0.694398295153125,0.606054565316972,0.291498788492919,0.115422684319174,-1.33015025656799,-1.55268881601142,-0.426454012902242,0.513018377525604,-0.325763233985336,-0.0780711716308701,1.8041918811649,0.803586438958143,-1.32384195669836,-0.795942290473606,0.817900666439534,0.287971170366448,-0.35066627946063,-0.879424448928241,-1.22752386622745],"z":[1.63783776890605,0.515501578447199,1.38252283767099,1.46149875256549,1.66684770482345,2.38559997702754,3.14791086414386,0.908795668290904,0.90596538279602,1.19311882026048,3.20398487964674,1.17529720456247,-0.428498680727496,3.9572458050117,2.68663948937289,2.92677187852236,2.83972793839851,0.115480485899979,0.67275987700089,0.233397316307449,2.02492495722533,0.948776686303656,-0.705353207709458,1.2124123944133,0.762029258080293,2.26872019653933,1.51920325523162,2.85777965217374,-0.0309827646298013,0.153996910673322,-1.33130067620301,1.70672241815227,0.688694175641395,2.04432829376613,1.04683614688952,3.31437937845361,4.07658937402062,-1.07973443380146,0.772000168891868,0.970415131744462,-0.169447448742808,3.89946690443927,2.89035608624447,3.78355419183651,4.30450119683724,3.15736939762612,2.86495299110661,2.14724962394488,1.97974069541607,2.11024275557192,1.59228657239801,-0.100378956026324,1.34085503922956,2.02993668905491,1.77310787520886,1.8282744425022,2.14891229969666,-0.303841633770927,2.22775262089324,1.00046036109431,2.62152334936021,2.13968465881185,1.93136914017792,2.24838143135535,2.85497660015812,2.26844029009138,0.887899877855556,0.288909829783047,1.55566391489953,1.50724105836922,2.74556722510279,2.24445447836885,0.902319478392443,1.43901075301231,1.19653296439619,-0.604049493687773,2.74337838700606,1.3063531948727,0.662209655069164,1.66525245954649,1.10844542744688,1.39279468666102,0.42643553119261,2.25143790236167,1.77196554758092,2.04450055316258,2.85069422164809,1.52795633061956,2.15687961613228,-1.37846190318674,2.28131586072498,2.80201616284204,1.33113123909552,5.32022047594315,0.902274325411259,2.4413222295904,-1.32860635408995,1.11771123586408,0.977156398792069,1.06948221071439,0.0184389080909499,-0.335961212345535,0.631969424192794,1.54285732294448,2.12111032790566,2.03163002617846,2.20728408873681,3.4502367389775,3.08158386858731,1.85109177915122,-0.293614622001176,1.35945592031157,3.53370436331576,-2.55882804373307,0.169435564238346,1.65888515039146,1.46770829908711,1.2499201865537,1.68541279974637,1.12474050689131,-0.629559930627672,0.422650588163054,0.0505632214876433,1.50809659294353,2.08403294927754,1.41702104677292,1.26400878204755,0.30364266518537,0.214015817628029,1.11283480976363,1.72423818786404,4.09843395571781,-1.75131456500584,2.44705730991399,4.09860727902135,2.44791987442781,3.55421892205202,1.91279714979878,-2.2566883715424,-0.323950852098173,0.608098112259071,1.2931154241172,0.546215746208694,3.03326094352867,3.04621604363582,-0.628029097926223,0.552192130409399,2.7898285736818,-0.436306224320854,3.04837448887591,1.11792783976861,2.59897260467145,1.00053008356005,2.09680851363,0.954555524753105,0.0670788143814505,-0.13630613316556,1.38991543617875,0.213812208720478,1.79118213050398,2.08174036787274,2.21027411069461,0.908259603331568,-1.15781848578206,3.01142215051263,0.0256917455084351,-0.398931811600357,3.4416577430107,0.404529697353959,0.520289844637411,1.65666543731892,2.36292666610376,1.66198284666235,4.24934330660124,3.24966738473236,0.122818081996658,-0.740283573903443,2.14965206384813,2.81371286894849,3.21909864271883,1.04066524107365,1.27669682265243,2.87278265744154,2.22289378990994,0.936149747901717,-0.23709178363222,-0.42816494832731,1.24576776295417,3.01327568040071,1.56406718403731,1.96652273036798,3.90332182904792,2.8289283487353,0.148618508549459,0.872789266719179,1.94989958706516,1.77247210440547,1.12332194520746,0.806731304445306,-0.0666182679558514],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"frame":null},{"x":[-0.282706435924042,-0.989905958545667,0.126332295231102,-0.0439865179492621,0.613573301375285,0.772546937926567,0.404933977935141,-0.26047715973453,-0.241718195796561,-0.154764562548029,1.72000224034958,0.1687460264977,-1.99417913708834,2.10923788217206,0.793123324160926,0.748539390021518,0.91939607809767,-1.08411244692864,-0.52104208877702,-0.97079601222378,0.659661576226051,-0.618555500100488,-1.38722527897953,-0.481486401603664,-0.701542779014234,0.494100050259395,-0.385032703323868,0.728752463437646,-0.95283909605305,-0.83107503541255,-2.27625341097421,0.136552371452572,-0.411033993121315,0.690358682259533,-0.47735218964677,1.56567479542373,2.25602644310682,-1.84259208717837,-0.388094045482264,-0.163470125115565,-1.58330315048353,2.17276367627875,0.920333235058868,1.49703940972565,1.99796079329351,1.64304335816965,1.07269892603867,0.484849886249964,0.215642465415438,0.229547670334693,0.120586674804604,-0.90045554543729,-0.00278387740985842,-0.083219166671481,0.150892579584813,0.0543471749909521,0.67757678508404,-0.962668773713611,-0.0416178836621031,-0.195754089015166,1.2002400883762,0.641695464301415,-0.111575768558591,0.472671382215179,0.805859276668295,0.126171011037116,-0.647321107612405,-0.909000213712239,0.138176772483927,0.291962603865023,1.24699822887246,0.521610517398754,-0.299493059689326,-0.479040910367962,-0.431361992300117,-1.53971977425668,0.918926552950096,0.0276513951722482,-0.519359507771314,0.349818012118216,-0.284197121077959,-0.0161096134817162,-1.05440009464499,0.351018695612584,0.317350539808789,0.037171381692051,1.34498216343164,-0.147812685661594,0.501451899567603,-1.94268726597052,0.304474837735088,0.949501433146191,-0.294402987329566,2.69150275703525,-0.433693288328064,0.801674299259555,-1.1792120056706,-0.311724860400697,-0.466495096434508,-0.0771692975658047,-0.463502611981029,-1.36819418919539,-0.0338291660914598,0.135726139968183,0.381519143571937,0.248645388456964,0.337965287706855,0.962002489321037,1.38155032982764,0.314103705128498,-1.57143295536483,-0.1484894867629,1.53791257714615,-2.99541763984507,-0.88562204672817,0.0884086506105778,-0.467190375389997,-0.656027522993324,0.122693385624736,-0.154578124941751,-1.23709390959606,-0.60760036283672,-0.840759740067271,-0.0146574800228469,0.546276421401282,-0.354342132633884,-0.334034928664152,-0.429386022744351,-0.927475432072284,-0.0337236372480541,0.622745525059592,1.36193189428565,-2.67095440865002,1.12524210195061,1.5300160635851,0.710480142029934,1.51737208409636,0.482857885460717,-2.10763911607056,-0.729167024405984,-0.527536149753938,-0.337474483393729,-0.667960681957032,1.10877838380206,1.33400437298996,-1.83488162417154,-0.534410410199578,0.672659635544956,-1.80898348591937,0.847350208266534,-0.258270454653911,1.10106277185931,-0.705732455969561,0.81986164939179,-0.00681465128853309,-1.22964056248674,-0.97508684681489,0.542355515209885,-1.37400791885759,0.854269327333779,0.466441252267595,0.228503251840353,-0.171117371098266,-1.68362592598207,0.991142540960915,-0.920106620189626,-1.21283076822599,1.72180913069004,-0.309575676134545,-0.00894893641686356,-0.0756084265020482,0.731583306099788,-0.168664109863237,1.90657741225299,1.14279426303128,-1.17650826506036,-2.04562140841024,0.459299795235651,0.189712660084609,1.79674125113901,-0.0555518179358971,0.333972793529478,1.31364255418668,0.699785663108447,-0.962344007015275,-1.19283039689088,-1.24325350129758,0.0218441402810769,1.60738306049114,0.375866820054364,0.703111252458003,1.58770405491929,1.05346166810802,-0.648123993643822,-0.141494005340406,-0.216607933187856,0.0598537305142393,-0.228866189941551,-0.152380364419876,-1.05192319340803],"y":[0.438196571805565,-0.457941320514031,-0.335577775399676,-0.052436226655734,-0.416640399897486,0.4511749238428,1.90780343685753,-0.625521419548448,-0.648323648479108,-0.32505808534984,0.672840910875781,-0.674028125392728,-0.802239940792353,1.35969230528895,0.860654983816084,1.24828518816902,0.953080014201644,-0.935193535769945,-0.70215047806312,-0.88005735560699,0.0488102572544414,-0.210327339164271,-1.80470026601825,0.0292260024955414,-0.394122100569616,0.562650696526805,0.371044962527633,1.16951179139772,-1.27570010168808,-1.13320748332412,-1.80988280330007,0.117344406209253,-0.789395289946675,0.0458322034221038,-0.211445705923892,0.984874782668581,1.38339455722408,-1.88416378080799,-0.693326675799336,-0.634500649233758,-0.843042738847609,1.21362522465023,1.02446878273468,1.7237599017708,1.96704852534686,0.683206247311966,0.835812955843644,0.398371471115601,0.428280422623251,0.600806732212357,-0.0301696767917184,-1.42722106858458,-0.265987029103612,0.798850617051365,0.197840565300716,0.373195351742203,0.208019823355496,-1.65566880851484,1.03984352238247,-0.559294929120092,0.360515162439828,0.230718800016962,0.686396434828499,0.555023985736764,1.08840061814475,0.930179869394872,-0.268528600863926,-0.862549563439105,-0.100077856611728,-0.323039197321836,0.490962558718686,0.500474917715339,-0.595757219448595,0.350492452115569,-0.0435833068324499,-1.50748617928155,0.815907323074298,-0.345710650766951,-0.718904804685577,-0.155164032464647,-0.316587516553619,-0.178461796701099,-0.520684394778411,0.681043059491253,0.0297507084654008,0.699265588841657,0.543160047795648,0.146329338276701,0.395526589494249,-2.21082212970909,0.770269715030611,0.869100694072453,0.0117409377674627,2.72453410318498,-0.461621495068692,0.501650780456745,-2.90307517701359,-0.275822908063452,-0.321845296418233,-0.579277078255049,-1.69443419615903,-1.2960285052825,-1.24763547618882,-0.11592235546034,0.464360362309029,0.469405114956564,0.63101959079004,1.78262903237684,0.836434234169961,0.14603501681755,-1.03229461004969,-0.0937087324905596,1.32595840789209,-2.84432909947215,-1.05660525262989,0.0971491731072381,0.379638411530176,0.257349684085774,0.100761080028662,-0.422927827769216,-1.84655552528488,-0.972891188057471,-1.27128519179179,-0.015196921184954,0.246635400725224,0.194379808325215,-0.0445163452521927,-1.32111684668939,-0.9510657910148,-0.560790454216747,-0.343826219238089,2.30869565132695,-2.01520164677116,0.186275949656534,2.14085908674684,0.602270144596951,1.37580541342225,0.0654313659818365,-3.30047952011714,-1.91789801257567,-0.788030366717372,0.000504126719744202,-0.736009214586245,1.04017343011177,0.833454726791221,-1.24658090685019,-0.861021794628406,1.1285316500162,-0.998589225666122,1.32319238471478,-0.32896787966092,0.42747712940134,-0.0492169586432136,-0.00869902104748899,-0.813812704477014,-0.858810665238317,-1.40391430597732,-0.741040140367373,-0.504824174097421,-0.479715817740938,0.323195453566344,0.744753086596251,-0.715647015269477,-2.15467858769085,1.12661099721572,-1.22746899163974,-1.54134992518736,1.01056668248384,-1.29680286162978,-1.4320579623711,0.257995231544807,0.45974811149275,0.358647213968039,1.97963492033594,1.31530960974496,-0.832315437500114,-1.19620465972181,0.427353619134546,1.64559904728611,0.617692990189337,-0.642061657371722,-0.694398295153125,0.606054565316972,0.291498788492919,0.115422684319174,-1.33015025656799,-1.55268881601142,-0.426454012902242,0.513018377525604,-0.325763233985336,-0.0780711716308701,1.8041918811649,0.803586438958143,-1.32384195669836,-0.795942290473606,0.817900666439534,0.287971170366448,-0.35066627946063,-0.879424448928241,-1.22752386622745],"z":[1.63783776890605,0.515501578447199,1.38252283767099,1.46149875256549,1.66684770482345,2.38559997702754,3.14791086414386,0.908795668290904,0.90596538279602,1.19311882026048,3.20398487964674,1.17529720456247,-0.428498680727496,3.9572458050117,2.68663948937289,2.92677187852236,2.83972793839851,0.115480485899979,0.67275987700089,0.233397316307449,2.02492495722533,0.948776686303656,-0.705353207709458,1.2124123944133,0.762029258080293,2.26872019653933,1.51920325523162,2.85777965217374,-0.0309827646298013,0.153996910673322,-1.33130067620301,1.70672241815227,0.688694175641395,2.04432829376613,1.04683614688952,3.31437937845361,4.07658937402062,-1.07973443380146,0.772000168891868,0.970415131744462,-0.169447448742808,3.89946690443927,2.89035608624447,3.78355419183651,4.30450119683724,3.15736939762612,2.86495299110661,2.14724962394488,1.97974069541607,2.11024275557192,1.59228657239801,-0.100378956026324,1.34085503922956,2.02993668905491,1.77310787520886,1.8282744425022,2.14891229969666,-0.303841633770927,2.22775262089324,1.00046036109431,2.62152334936021,2.13968465881185,1.93136914017792,2.24838143135535,2.85497660015812,2.26844029009138,0.887899877855556,0.288909829783047,1.55566391489953,1.50724105836922,2.74556722510279,2.24445447836885,0.902319478392443,1.43901075301231,1.19653296439619,-0.604049493687773,2.74337838700606,1.3063531948727,0.662209655069164,1.66525245954649,1.10844542744688,1.39279468666102,0.42643553119261,2.25143790236167,1.77196554758092,2.04450055316258,2.85069422164809,1.52795633061956,2.15687961613228,-1.37846190318674,2.28131586072498,2.80201616284204,1.33113123909552,5.32022047594315,0.902274325411259,2.4413222295904,-1.32860635408995,1.11771123586408,0.977156398792069,1.06948221071439,0.0184389080909499,-0.335961212345535,0.631969424192794,1.54285732294448,2.12111032790566,2.03163002617846,2.20728408873681,3.4502367389775,3.08158386858731,1.85109177915122,-0.293614622001176,1.35945592031157,3.53370436331576,-2.55882804373307,0.169435564238346,1.65888515039146,1.46770829908711,1.2499201865537,1.68541279974637,1.12474050689131,-0.629559930627672,0.422650588163054,0.0505632214876433,1.50809659294353,2.08403294927754,1.41702104677292,1.26400878204755,0.30364266518537,0.214015817628029,1.11283480976363,1.72423818786404,4.09843395571781,-1.75131456500584,2.44705730991399,4.09860727902135,2.44791987442781,3.55421892205202,1.91279714979878,-2.2566883715424,-0.323950852098173,0.608098112259071,1.2931154241172,0.546215746208694,3.03326094352867,3.04621604363582,-0.628029097926223,0.552192130409399,2.7898285736818,-0.436306224320854,3.04837448887591,1.11792783976861,2.59897260467145,1.00053008356005,2.09680851363,0.954555524753105,0.0670788143814505,-0.13630613316556,1.38991543617875,0.213812208720478,1.79118213050398,2.08174036787274,2.21027411069461,0.908259603331568,-1.15781848578206,3.01142215051263,0.0256917455084351,-0.398931811600357,3.4416577430107,0.404529697353959,0.520289844637411,1.65666543731892,2.36292666610376,1.66198284666235,4.24934330660124,3.24966738473236,0.122818081996658,-0.740283573903443,2.14965206384813,2.81371286894849,3.21909864271883,1.04066524107365,1.27669682265243,2.87278265744154,2.22289378990994,0.936149747901717,-0.23709178363222,-0.42816494832731,1.24576776295417,3.01327568040071,1.56406718403731,1.96652273036798,3.90332182904792,2.8289283487353,0.148618508549459,0.872789266719179,1.94989958706516,1.77247210440547,1.12332194520746,0.806731304445306,-0.0666182679558514],"mode":"markers","type":"scatter3d","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
class: just-img
<div id="htmlwidget-a98d07d1eaa03035fcf6" style="width:100%;height:100%;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-a98d07d1eaa03035fcf6">{"x":{"visdat":{"1671e30ed06e0":["function () ","plotlyVisDat"]},"cur_data":"1671e30ed06e0","attrs":{"1671e30ed06e0":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1671e30ed06e0.1":{"x":{},"y":{},"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"Covariates"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Residuals"},"showlegend":false,"hovermode":"closest"},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[-0.282706435924042,-0.989905958545667,0.126332295231102,-0.0439865179492621,0.613573301375285,0.772546937926567,0.404933977935141,-0.26047715973453,-0.241718195796561,-0.154764562548029,1.72000224034958,0.1687460264977,-1.99417913708834,2.10923788217206,0.793123324160926,0.748539390021518,0.91939607809767,-1.08411244692864,-0.52104208877702,-0.97079601222378,0.659661576226051,-0.618555500100488,-1.38722527897953,-0.481486401603664,-0.701542779014234,0.494100050259395,-0.385032703323868,0.728752463437646,-0.95283909605305,-0.83107503541255,-2.27625341097421,0.136552371452572,-0.411033993121315,0.690358682259533,-0.47735218964677,1.56567479542373,2.25602644310682,-1.84259208717837,-0.388094045482264,-0.163470125115565,-1.58330315048353,2.17276367627875,0.920333235058868,1.49703940972565,1.99796079329351,1.64304335816965,1.07269892603867,0.484849886249964,0.215642465415438,0.229547670334693,0.120586674804604,-0.90045554543729,-0.00278387740985842,-0.083219166671481,0.150892579584813,0.0543471749909521,0.67757678508404,-0.962668773713611,-0.0416178836621031,-0.195754089015166,1.2002400883762,0.641695464301415,-0.111575768558591,0.472671382215179,0.805859276668295,0.126171011037116,-0.647321107612405,-0.909000213712239,0.138176772483927,0.291962603865023,1.24699822887246,0.521610517398754,-0.299493059689326,-0.479040910367962,-0.431361992300117,-1.53971977425668,0.918926552950096,0.0276513951722482,-0.519359507771314,0.349818012118216,-0.284197121077959,-0.0161096134817162,-1.05440009464499,0.351018695612584,0.317350539808789,0.037171381692051,1.34498216343164,-0.147812685661594,0.501451899567603,-1.94268726597052,0.304474837735088,0.949501433146191,-0.294402987329566,2.69150275703525,-0.433693288328064,0.801674299259555,-1.1792120056706,-0.311724860400697,-0.466495096434508,-0.0771692975658047,-0.463502611981029,-1.36819418919539,-0.0338291660914598,0.135726139968183,0.381519143571937,0.248645388456964,0.337965287706855,0.962002489321037,1.38155032982764,0.314103705128498,-1.57143295536483,-0.1484894867629,1.53791257714615,-2.99541763984507,-0.88562204672817,0.0884086506105778,-0.467190375389997,-0.656027522993324,0.122693385624736,-0.154578124941751,-1.23709390959606,-0.60760036283672,-0.840759740067271,-0.0146574800228469,0.546276421401282,-0.354342132633884,-0.334034928664152,-0.429386022744351,-0.927475432072284,-0.0337236372480541,0.622745525059592,1.36193189428565,-2.67095440865002,1.12524210195061,1.5300160635851,0.710480142029934,1.51737208409636,0.482857885460717,-2.10763911607056,-0.729167024405984,-0.527536149753938,-0.337474483393729,-0.667960681957032,1.10877838380206,1.33400437298996,-1.83488162417154,-0.534410410199578,0.672659635544956,-1.80898348591937,0.847350208266534,-0.258270454653911,1.10106277185931,-0.705732455969561,0.81986164939179,-0.00681465128853309,-1.22964056248674,-0.97508684681489,0.542355515209885,-1.37400791885759,0.854269327333779,0.466441252267595,0.228503251840353,-0.171117371098266,-1.68362592598207,0.991142540960915,-0.920106620189626,-1.21283076822599,1.72180913069004,-0.309575676134545,-0.00894893641686356,-0.0756084265020482,0.731583306099788,-0.168664109863237,1.90657741225299,1.14279426303128,-1.17650826506036,-2.04562140841024,0.459299795235651,0.189712660084609,1.79674125113901,-0.0555518179358971,0.333972793529478,1.31364255418668,0.699785663108447,-0.962344007015275,-1.19283039689088,-1.24325350129758,0.0218441402810769,1.60738306049114,0.375866820054364,0.703111252458003,1.58770405491929,1.05346166810802,-0.648123993643822,-0.141494005340406,-0.216607933187856,0.0598537305142393,-0.228866189941551,-0.152380364419876,-1.05192319340803],"y":[-0.506982248915135,-0.495147967743415,0.217007482476901,-0.0623663461551145,0.603926867555966,0.224354291039432,-0.856873703254758,0.110238927891356,0.136267610376917,0.014289529870164,0.762194180204396,0.438131544616231,-1.00339684101025,0.646161912392035,0.0071474523225746,-0.243312884778199,0.0432608897999927,-0.291148881362098,-0.0288135573906622,-0.243013529893613,0.372920234690688,-0.375258186427335,-0.0115170475301887,-0.414806094164713,-0.329391200046764,-0.0336115106560074,-0.540628310457077,-0.212607886699909,-0.00666004765288303,-0.00202194875091865,-0.630905390688735,-0.0320205270477325,0.097539562158268,0.396092657159571,-0.275783297963585,0.47767221964818,0.735507425871367,-0.285327621695826,0.059259149622071,0.183222688351379,-0.692704752065047,0.773248500889497,0.00353794997276316,0.0116988921084787,0.224734831961224,0.702460116082525,0.216901533484115,0.0528330692730605,-0.152529240892816,-0.240380011916622,0.0402404720957292,0.115711800177352,0.0872642101333158,-0.571334475512354,-0.0675126576968647,-0.23427869982173,0.295408689300538,0.201377261260772,-0.678524100789237,0.118086017927019,0.575018514338872,0.257452758622034,-0.527577708029495,-0.0442977544502931,-0.112754976490001,-0.499043866188325,-0.362474285963185,-0.209659236788389,0.0920950388691328,0.325856621938863,0.533965493467009,0.0208137103503735,0.0660925567024068,-0.594809134532852,-0.338536570982362,-0.286373569358886,0.120519905932836,0.153662214289675,-0.0181591603791381,0.271401775976083,-0.0811043883100383,0.0284301307038531,-0.504805095076336,-0.200733604368616,0.144082980380181,-0.430733759955854,0.573030278703388,-0.247470538287785,0.0660636019106259,-0.170629593944448,-0.28378272883756,0.111835061902313,-0.273957793425458,0.281764848585173,-0.103717516483943,0.216193265601831,0.755355590868085,-0.123431103357563,-0.205739063075917,0.212397684775926,0.572720071735735,-0.28591045140375,0.620772976305206,0.0993415691912423,-0.0568231190755587,-0.152688163082442,-0.181576691401393,-0.396124538230294,0.432746108389723,0.0760374095110036,-0.577350880785689,-0.112173849661926,0.265314782194853,-0.549216337775823,-0.0835326473548332,-0.054298294146522,-0.602999311674203,-0.666016305979691,-0.0323419481721167,0.0697771671202977,0.117249102978228,0.0637321417768234,0.069298338071597,-0.0628993335335791,0.181656673220169,-0.419219481219784,-0.269879880796055,0.385445744882729,-0.172525298293286,0.232353233790702,0.569162232140293,-0.413728009573105,-0.791063545759022,0.621073191439351,-0.201137292430813,0.0954449822510309,0.222741949742711,0.239756411617501,0.330236649867078,0.513150694692789,0.0152160239799489,-0.29775207018422,-0.112505377728886,0.126566683866659,0.401149209004409,-0.64056023036895,0.0516894883386748,-0.228693658885192,-0.762700707950482,-0.216514356656827,-0.055953134859391,0.467719332717633,-0.527409386695742,0.51758871164592,0.394304091228355,-0.436222278334745,0.0502871069024706,0.737561554955511,-0.737501437698707,0.808090833999056,0.0824681208012306,-0.322530111278013,0.2237676628707,-0.0210425932760535,-0.00466926453037069,-0.0110278182837372,-0.0383972368401649,0.572434389565705,0.45556049954959,0.742502272688802,-0.260088073301028,0.19083057822588,-0.382157874512908,0.153647342426669,-0.00524485933993227,-0.414015913632519,-0.816571916541455,0.0185551090177632,-0.859220452416928,0.847104281262474,0.263042164448046,0.565312066786196,0.515518124887253,0.263737491381114,-0.8001610267126,-0.143855835366019,-0.0532796410917867,0.195267235312472,0.773759652725412,0.386130344203256,0.47510174307471,0.0296701687537169,0.221663430961531,0.233870543291138,0.28992067120163,-0.675481710199689,-0.182219568368193,-0.0230970901973601,0.329519438588132,-0.103268381345845],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[-0.282706435924042,-0.989905958545667,0.126332295231102,-0.0439865179492621,0.613573301375285,0.772546937926567,0.404933977935141,-0.26047715973453,-0.241718195796561,-0.154764562548029,1.72000224034958,0.1687460264977,-1.99417913708834,2.10923788217206,0.793123324160926,0.748539390021518,0.91939607809767,-1.08411244692864,-0.52104208877702,-0.97079601222378,0.659661576226051,-0.618555500100488,-1.38722527897953,-0.481486401603664,-0.701542779014234,0.494100050259395,-0.385032703323868,0.728752463437646,-0.95283909605305,-0.83107503541255,-2.27625341097421,0.136552371452572,-0.411033993121315,0.690358682259533,-0.47735218964677,1.56567479542373,2.25602644310682,-1.84259208717837,-0.388094045482264,-0.163470125115565,-1.58330315048353,2.17276367627875,0.920333235058868,1.49703940972565,1.99796079329351,1.64304335816965,1.07269892603867,0.484849886249964,0.215642465415438,0.229547670334693,0.120586674804604,-0.90045554543729,-0.00278387740985842,-0.083219166671481,0.150892579584813,0.0543471749909521,0.67757678508404,-0.962668773713611,-0.0416178836621031,-0.195754089015166,1.2002400883762,0.641695464301415,-0.111575768558591,0.472671382215179,0.805859276668295,0.126171011037116,-0.647321107612405,-0.909000213712239,0.138176772483927,0.291962603865023,1.24699822887246,0.521610517398754,-0.299493059689326,-0.479040910367962,-0.431361992300117,-1.53971977425668,0.918926552950096,0.0276513951722482,-0.519359507771314,0.349818012118216,-0.284197121077959,-0.0161096134817162,-1.05440009464499,0.351018695612584,0.317350539808789,0.037171381692051,1.34498216343164,-0.147812685661594,0.501451899567603,-1.94268726597052,0.304474837735088,0.949501433146191,-0.294402987329566,2.69150275703525,-0.433693288328064,0.801674299259555,-1.1792120056706,-0.311724860400697,-0.466495096434508,-0.0771692975658047,-0.463502611981029,-1.36819418919539,-0.0338291660914598,0.135726139968183,0.381519143571937,0.248645388456964,0.337965287706855,0.962002489321037,1.38155032982764,0.314103705128498,-1.57143295536483,-0.1484894867629,1.53791257714615,-2.99541763984507,-0.88562204672817,0.0884086506105778,-0.467190375389997,-0.656027522993324,0.122693385624736,-0.154578124941751,-1.23709390959606,-0.60760036283672,-0.840759740067271,-0.0146574800228469,0.546276421401282,-0.354342132633884,-0.334034928664152,-0.429386022744351,-0.927475432072284,-0.0337236372480541,0.622745525059592,1.36193189428565,-2.67095440865002,1.12524210195061,1.5300160635851,0.710480142029934,1.51737208409636,0.482857885460717,-2.10763911607056,-0.729167024405984,-0.527536149753938,-0.337474483393729,-0.667960681957032,1.10877838380206,1.33400437298996,-1.83488162417154,-0.534410410199578,0.672659635544956,-1.80898348591937,0.847350208266534,-0.258270454653911,1.10106277185931,-0.705732455969561,0.81986164939179,-0.00681465128853309,-1.22964056248674,-0.97508684681489,0.542355515209885,-1.37400791885759,0.854269327333779,0.466441252267595,0.228503251840353,-0.171117371098266,-1.68362592598207,0.991142540960915,-0.920106620189626,-1.21283076822599,1.72180913069004,-0.309575676134545,-0.00894893641686356,-0.0756084265020482,0.731583306099788,-0.168664109863237,1.90657741225299,1.14279426303128,-1.17650826506036,-2.04562140841024,0.459299795235651,0.189712660084609,1.79674125113901,-0.0555518179358971,0.333972793529478,1.31364255418668,0.699785663108447,-0.962344007015275,-1.19283039689088,-1.24325350129758,0.0218441402810769,1.60738306049114,0.375866820054364,0.703111252458003,1.58770405491929,1.05346166810802,-0.648123993643822,-0.141494005340406,-0.216607933187856,0.0598537305142393,-0.228866189941551,-0.152380364419876,-1.05192319340803],"y":[-0.506982248915135,-0.495147967743415,0.217007482476901,-0.0623663461551145,0.603926867555966,0.224354291039432,-0.856873703254758,0.110238927891356,0.136267610376917,0.014289529870164,0.762194180204396,0.438131544616231,-1.00339684101025,0.646161912392035,0.0071474523225746,-0.243312884778199,0.0432608897999927,-0.291148881362098,-0.0288135573906622,-0.243013529893613,0.372920234690688,-0.375258186427335,-0.0115170475301887,-0.414806094164713,-0.329391200046764,-0.0336115106560074,-0.540628310457077,-0.212607886699909,-0.00666004765288303,-0.00202194875091865,-0.630905390688735,-0.0320205270477325,0.097539562158268,0.396092657159571,-0.275783297963585,0.47767221964818,0.735507425871367,-0.285327621695826,0.059259149622071,0.183222688351379,-0.692704752065047,0.773248500889497,0.00353794997276316,0.0116988921084787,0.224734831961224,0.702460116082525,0.216901533484115,0.0528330692730605,-0.152529240892816,-0.240380011916622,0.0402404720957292,0.115711800177352,0.0872642101333158,-0.571334475512354,-0.0675126576968647,-0.23427869982173,0.295408689300538,0.201377261260772,-0.678524100789237,0.118086017927019,0.575018514338872,0.257452758622034,-0.527577708029495,-0.0442977544502931,-0.112754976490001,-0.499043866188325,-0.362474285963185,-0.209659236788389,0.0920950388691328,0.325856621938863,0.533965493467009,0.0208137103503735,0.0660925567024068,-0.594809134532852,-0.338536570982362,-0.286373569358886,0.120519905932836,0.153662214289675,-0.0181591603791381,0.271401775976083,-0.0811043883100383,0.0284301307038531,-0.504805095076336,-0.200733604368616,0.144082980380181,-0.430733759955854,0.573030278703388,-0.247470538287785,0.0660636019106259,-0.170629593944448,-0.28378272883756,0.111835061902313,-0.273957793425458,0.281764848585173,-0.103717516483943,0.216193265601831,0.755355590868085,-0.123431103357563,-0.205739063075917,0.212397684775926,0.572720071735735,-0.28591045140375,0.620772976305206,0.0993415691912423,-0.0568231190755587,-0.152688163082442,-0.181576691401393,-0.396124538230294,0.432746108389723,0.0760374095110036,-0.577350880785689,-0.112173849661926,0.265314782194853,-0.549216337775823,-0.0835326473548332,-0.054298294146522,-0.602999311674203,-0.666016305979691,-0.0323419481721167,0.0697771671202977,0.117249102978228,0.0637321417768234,0.069298338071597,-0.0628993335335791,0.181656673220169,-0.419219481219784,-0.269879880796055,0.385445744882729,-0.172525298293286,0.232353233790702,0.569162232140293,-0.413728009573105,-0.791063545759022,0.621073191439351,-0.201137292430813,0.0954449822510309,0.222741949742711,0.239756411617501,0.330236649867078,0.513150694692789,0.0152160239799489,-0.29775207018422,-0.112505377728886,0.126566683866659,0.401149209004409,-0.64056023036895,0.0516894883386748,-0.228693658885192,-0.762700707950482,-0.216514356656827,-0.055953134859391,0.467719332717633,-0.527409386695742,0.51758871164592,0.394304091228355,-0.436222278334745,0.0502871069024706,0.737561554955511,-0.737501437698707,0.808090833999056,0.0824681208012306,-0.322530111278013,0.2237676628707,-0.0210425932760535,-0.00466926453037069,-0.0110278182837372,-0.0383972368401649,0.572434389565705,0.45556049954959,0.742502272688802,-0.260088073301028,0.19083057822588,-0.382157874512908,0.153647342426669,-0.00524485933993227,-0.414015913632519,-0.816571916541455,0.0185551090177632,-0.859220452416928,0.847104281262474,0.263042164448046,0.565312066786196,0.515518124887253,0.263737491381114,-0.8001610267126,-0.143855835366019,-0.0532796410917867,0.195267235312472,0.773759652725412,0.386130344203256,0.47510174307471,0.0296701687537169,0.221663430961531,0.233870543291138,0.28992067120163,-0.675481710199689,-0.182219568368193,-0.0230970901973601,0.329519438588132,-0.103268381345845],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
---
### Reason 3: Multiple regression exists
- Regressing out the confounder beforehand can remove the effect of your covariate of interest
- Ordinary least-squares regression yields estimates for each covariate controlling for all other variables in the model
- So what if we just fit a model with both the confounder and the independent variable?
---
class: img-caption
![](jane_618_f2.gif)
Answer: Looks great, let's do this instead
.footnote[
[Freckleton, 2002](https://besjournals.onlinelibrary.wiley.com/doi/10.1046/j.1365-2656.2002.00618.x)
]
---
### Reason 4: Even if you really like two-step &lt;br&gt; regression, there's a better way
- Lindquist et al. (2019) suggest that there is a correct way to use modular preprocessing pipelines
- In our earlier model, let's say you regress out the confounder `\(z_i\)` out of the outcome `\(y_i\)`, but also out of the covariate of interest `\(x_i\)`
    - Now you are isolating the effect of `\(x_i\)` independent of `\(z_i\)`
---
class: img-caption
![](hbm24528-fig-0003-ml.jpg)
.footnote[
[Lindquist et al., 2019](https://onlinelibrary.wiley.com/doi/full/10.1002/hbm.24528)
]
---
### Key Takeaways
- Avoid "residual" or "two-step" regression
    - Just use multiple regression instead
- When dealing with modular pipelines, do one of the following
    - Regress out all confounders simultaneously
    - For each new step, regress the confounders on all confounders from previous steps
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/remark/0.14.0/remark.min.js"></script>
<script src="macros.js"></script>
<script>var slideshow = remark.create({
"countIncrementalSlides": false,
"slideNumberFormat": "%current%"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
